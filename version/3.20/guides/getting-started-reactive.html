<!DOCTYPE html>
<html lang="en">







<head>
  <title>Getting Started With Reactive - 3.20 - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://analytics.ossupstream.org/ https://search.quarkus.io https://smetrics.redhat.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      js.bizographics.com
      https://www.redhat.com
      https://static.redhat.com
      https://app.requestly.io/
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://giscus.app
      https://analytics.ossupstream.org/
      https://app.mailjet.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net https://www.youtube.com https://player.restream.io https://app.mailjet.com http://xy0p2.mjt.lu https://mj.quarkus.io https://giscus.app; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/version/3.20/guides/getting-started-reactive" />
  <meta property="og:title" content="Getting Started With Reactive - 3.20" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/getting-started-reactive">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="en" href="https://quarkus.io/version/3.20/guides/getting-started-reactive" />
  
  <link rel="alternate" hreflang="pt-br" href="https://pt.quarkus.io/version/3.20/guides/getting-started-reactive" />
  
  <link rel="alternate" hreflang="es" href="https://es.quarkus.io/version/3.20/guides/getting-started-reactive" />
  
  <link rel="alternate" hreflang="zh" href="https://cn.quarkus.io/version/3.20/guides/getting-started-reactive" />
  
  <link rel="alternate" hreflang="ja" href="https://ja.quarkus.io/version/3.20/guides/getting-started-reactive" />
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />  
  <script src="/assets/javascript/tracking.js"></script>
  
  <script src="/assets/javascript/colormode.js" type="text/javascript"></script>

</head>

<body class="guides">

  
  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
        <div class="logo-wrapper">
           <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/about/">Why<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">WHAT IS QUARKUS?</a></li>
          <li><a href="/developer-joy" class="">DEVELOPER JOY</a></li>
          <li><a href="/performance" class="">PERFORMANCE</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">STANDARDS</a></li>
          <li><a href="/versatility" class="">VERSATILITY</a></li>
          <li><a href="/container-first" class="">CONTAINER FIRST</a></li>          
        </ul>
      </li>
      <li class="dropdown">
        <span href="/learn/">Learn<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">GET STARTED</a></li>
          <li><a href="/guides" class="active">DOCUMENTATION</a></li>
          <li><a href="/userstories/" class="">USER STORIES</a></li>  
          <li><a href="/qtips" class="">"Q" TIP VIDEOS</a></li>          
          <li><a href="/books" class="">BOOKS</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="https://quarkus.io/extensions/">Extensions<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <!-- Note that quarkus.io is hardcoded here, because it is the only url which supports extensions -->
          <li><a href="https://quarkus.io/extensions/" class="">BROWSE EXTENSIONS</a></li>
          <li><a href="/faq/#what-is-a-quarkus-extension" class="">USE EXTENSIONS</a></li>
          <li><a href="/guides/writing-extensions" class="">CREATE EXTENSIONS</a></li>
          <li><a href="https://hub.quarkiverse.io" class="">SHARE EXTENSIONS</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/community/">Community<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">SUPPORT</a></li>
          <li><a href="/blog" class="">BLOG</a></li>
          <li><a href="/discussion" class="">DISCUSSION</a></li>
          <li><a href="/working-groups" class="">WORKING GROUPS</a></li>
          <li><a href="/insights" class="">PODCAST</a></li>
          <li><a href="/events" class="">EVENTS</a></li>
          <li><a href="/newsletter" class="">NEWSLETTER</a></li>
          <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" class="">ROADMAP</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary white">START CODING</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/version/3.20/guides/getting-started-reactive" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://pt.quarkus.io/version/3.20/guides/getting-started-reactive">PORTUGUÊS (BR)</a></li>
          <li><a href="https://es.quarkus.io/version/3.20/guides/getting-started-reactive">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/version/3.20/guides/getting-started-reactive">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/version/3.20/guides/getting-started-reactive">日本語</a></li>
          </ul>
      </li>
      <li>
        <span href="#" class="modeswitcher" id='theme-toggle'><i class="fas fa-sun"></i><i class="fas fa-moon"></i><i class="fas fa-cog"></i></span>
      </li>
    </ul>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    







<section class="full-width-version-bg flexfilterbar guides">
  <div class="guideflexcontainer">
    <div class="docslink">
      <a class="returnlink" href="/version/3.20/guides/"> Back to Guides</a>
    </div>
    <div class="flexlabel">
      <label>By Version</label>
    </div>
    <div class="guidepulldown version">
    <select id="guide-version-dropdown">
      
        
        
        <option value="main" >Main - SNAPSHOT</option>
        
        
        
        <option value="latest" >3.23.4 - Latest</option>
        
        
        
        <option value="3.20" selected>3.20</option>
        
        
        
        <option value="3.15" >3.15</option>
        
        
        
        <option value="3.8" >3.8</option>
        
        
        
        <option value="3.2" >3.2</option>
        
        
        
        <option value="2.16" >2.16</option>
        
        
        
        <option value="2.13" >2.13</option>
        </select>
    </div>
  </div>
</section>

<div class="guide">
  <div class="grid-wrapper">
    <div class="grid__item width-8-12 width-12-12-m">
      
      <h1 class="text-caps">Getting Started With Reactive </h1>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><em>Reactive</em> is a set of principles to build robust, efficient, and concurrent applications and systems.
These principles let you handle more load than traditional approaches while using the resources (CPU and memory) more efficiently while also reacting to failures gracefully.</p>
</div>
<div class="paragraph">
<p>Quarkus is a <em>Reactive</em> framework.
Since the beginning, <em>Reactive</em> has been an essential tenet of the Quarkus architecture.
It includes many reactive features and offers a broad ecosystem.</p>
</div>
<div class="paragraph">
<p>This guide is not an in-depth article about what <em>Reactive</em> is and how Quarkus enables reactive architectures.
If you want to read more about these topics, refer to the <a href="quarkus-reactive-architecture">Reactive Architecture guide</a>, which provides an overview of the Quarkus reactive ecosystem.</p>
</div>
<div class="paragraph">
<p>In this guide, we will get you started with some reactive features of Quarkus.
We are going to implement a simple CRUD application.
Yet, unlike in the <a href="hibernate-orm-panache">Hibernate with Panache guide</a>, it uses the reactive features of Quarkus.</p>
</div>
<div class="paragraph">
<p>This guide will help you with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bootstrapping a reactive CRUD application with Quarkus</p>
</li>
<li>
<p>Using Hibernate Reactive with Panache to interact with a database in a reactive fashion</p>
</li>
<li>
<p>Using Quarkus REST (formerly RESTEasy Reactive) to implement HTTP API while enforcing the reactive principle</p>
</li>
<li>
<p>Packaging and Running the application</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To complete this guide, you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Roughly 15 minutes</p>
</li>
<li>
<p>An IDE</p>
</li>
<li>
<p>JDK 17+ installed with <code>JAVA_HOME</code> configured appropriately</p>
</li>
<li>
<p>Apache Maven 3.9.9</p>
</li>
<li>
<p>Optionally the <a href="cli-tooling">Quarkus CLI</a> if you want to use it</p>
</li>
<li>
<p>Optionally Mandrel or GraalVM installed and <a href="building-native-image#configuring-graalvm">configured appropriately</a> if you want to build a native executable (or Docker if you use a native container build)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Verify that Maven is using the Java version you expect.
If you have multiple JDKs installed, make sure Maven is using the expected one.
You can verify which JDK Maven uses by running <code>mvn --version</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="imperative-vs-reactive-a-question-of-threads"><a class="anchor" href="#imperative-vs-reactive-a-question-of-threads"></a>Imperative vs. Reactive: a question of threads</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As mentioned above, in this guide, we are going to implement a reactive CRUD application.
But you may wonder what the differences and benefits are in comparison to the traditional and imperative model.</p>
</div>
<div class="paragraph">
<p>To better understand the contrast, we need to explain the difference between the reactive and imperative execution models.
It&#8217;s essential to comprehend that <em>Reactive</em> is not just a different execution model, but that distinction is necessary to understand this guide.</p>
</div>
<div class="paragraph">
<p>In the traditional and imperative approach, frameworks assign a thread to handle the request.
So, the whole processing of the request runs on this worker thread.
This model does not scale very well.
Indeed, to handle multiple concurrent requests, you need multiple threads; and so your application concurrency is constrained by the number of threads.
In addition, these threads are blocked as soon as your code interacts with remote services.
So, it leads to inefficient usage of the resources, as you may need more threads, and each thread, as they are mapped to OS threads, has a cost in terms of memory and CPU.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./images/blocking-threads.png" alt="Imperative Execution Model and Worker Threads" width="50%">
</div>
</div>
<div class="paragraph">
<p>On the other side, the reactive model relies on non-blocking I/Os and a different execution model.
Non-blocking I/O provides an efficient way to deal with concurrent I/O.
A minimal amount of threads called I/O threads, can handle many concurrent I/O.
With such a model, request processing is not delegated to a worker thread but uses these I/O threads directly.It saves memory and CPU as there is no need to create worker threads to handle the requests.
It also improves the concurrency as it removes the constraint on the number of threads.
Finally, it also improves response time as it reduces the number of thread switches.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./images/reactive-thread.png" alt="Reactive Execution Model and I/O Threads" width="50%">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="from-sequential-to-continuation-style"><a class="anchor" href="#from-sequential-to-continuation-style"></a>From sequential to continuation style</h2>
<div class="sectionbody">
<div class="paragraph">
<p>So, with the reactive execution model, the requests are processed using I/O threads.
But that&#8217;s not all.
An I/O thread can handle multiple concurrent requests.
How? Here is the trick and one of the most significant differences between reactive and imperative.</p>
</div>
<div class="paragraph">
<p>When processing a request requires interacting with a remote service, like an HTTP API or a database, it does not block the execution while waiting for the response.
Instead, it schedules the I/O operation and attaches a continuation, i.e., the request processing remaining code.
This continuation can be passed as a callback (a function invoked with the I/O outcome), or use more advanced constructs such as reactive programming or co-routines.
Regardless of how the continuation is expressed, the essential aspect is the release of the I/O thread and, as a consequence, the fact that this thread can be used to process another request.
When the scheduled I/O completes, the I/O thread executes the continuation, and the processing of the pending request continues.</p>
</div>
<div class="paragraph">
<p>So, unlike the imperative model, where I/O blocks the execution, reactive switches to a continuation-based design, where the I/O threads are released, and continuation invoked when the I/Os complete.
As a result, the I/O thread can handle multiple concurrent requests, improving the overall concurrency of the application.</p>
</div>
<div class="paragraph">
<p>But, there is a catch.
We need a way to write continuation-passing code.
There are many ways of doing this.
In Quarkus, we propose:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mutiny - an intuitive and event-driven reactive programming library</p>
</li>
<li>
<p>Kotlin co-routines - a way to write asynchronous code in a sequential manner</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this guide, we will use Mutiny.
To know more about Mutiny, check the <a href="mutiny-primer">Mutiny documentation</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Project Loom is coming to the JDK soon and proposes a virtual thread-based model.
The Quarkus architecture is ready to support Loom as soon as it&#8217;s become globally available.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bootstrapping-the-reactive-fruits-application"><a class="anchor" href="#bootstrapping-the-reactive-fruits-application"></a>Bootstrapping the Reactive Fruits application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With this in mind, let&#8217;s see how we can develop a CRUD application with Quarkus, which will use the I/O thread to handle the HTTP requests, interact with a database, process the result, and write the HTTP response; in other words: a reactive CRUD application.</p>
</div>
<div class="paragraph">
<p>While we recommend you to follow the step-by-step instructions, you can find the final solution on <a href="https://github.com/quarkusio/quarkus-quickstarts/tree/main/hibernate-reactive-panache-quickstart" class="bare">https://github.com/quarkusio/quarkus-quickstarts/tree/main/hibernate-reactive-panache-quickstart</a>.</p>
</div>
<div class="paragraph">
<p>First, go to <a href="https://code.quarkus.io">code.quarkus.io</a> and select the following extensions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Quarkus REST Jackson</p>
</li>
<li>
<p>Hibernate Reactive with Panache</p>
</li>
<li>
<p>Reactive PostgreSQL client</p>
</li>
</ol>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./images/reactive-guide-code.png" alt="Extensions to select in https://code.quarkus.io" width="90%">
</div>
</div>
<div class="paragraph">
<p>The last extension is the reactive database driver for PostgreSQL.
Hibernate Reactive uses that driver to interact with the database without blocking the caller thread.</p>
</div>
<div class="paragraph">
<p>Once selected, click on "Generate your application", download the zip file, unzip it and open the code in your favorite IDE.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reactive-panache-entity"><a class="anchor" href="#reactive-panache-entity"></a>Reactive Panache Entity</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s start with the <code>Fruit</code> entity.Create the <code>src/main/java/org/acme/hibernate/orm/panache/Fruit.java</code> file with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.hibernate.orm.panache;

import jakarta.persistence.Cacheable;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;

import io.quarkus.hibernate.reactive.panache.PanacheEntity;  <i class="conum" data-value="1"></i><b>(1)</b>

@Entity
@Cacheable
public class Fruit extends PanacheEntity {

	 @Column(length = 40, unique = true)
	 public String name;

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Make sure you import the reactive variant of <code>PanacheEntity</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This class represents <code>Fruits</code>.
It&#8217;s a straightforward entity with a single field (<code>name</code>).
Note that it uses <code>io.quarkus.hibernate.reactive.panache.PanacheEntity</code>, the reactive variant of <code>PanacheEntity</code>.
So, behind the scenes, Hibernate uses the execution model we described above.
It interacts with the database without blocking the thread.
In addition, this reactive <code>PanacheEntity</code> proposes a reactive API.
We will use this API to implement the REST endpoint.</p>
</div>
<div class="paragraph">
<p>Before going further, open the <code>src/main/resources/application.properties</code> file and add:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.datasource.db-kind=postgresql
quarkus.hibernate-orm.database.generation=drop-and-create</code></pre>
</div>
</div>
<div class="paragraph">
<p>It instructs the application to use PostgreSQL for the database and to handle the database schema generation.</p>
</div>
<div class="paragraph">
<p>In the same directory, create an <code>import.sql</code> file, which inserts a few fruits, so we don&#8217;t start with an empty database in dev mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">INSERT INTO fruit(id, name) VALUES (1, 'Cherry');
INSERT INTO fruit(id, name) VALUES (2, 'Apple');
INSERT INTO fruit(id, name) VALUES (3, 'Banana');
ALTER SEQUENCE fruit_seq RESTART WITH 4;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In a terminal, launch the application in dev mode using: <code>./mvnw quarkus:dev</code>.
Quarkus automatically starts a database instance for you and configure the application. Now we only need to implement the HTTP endpoint.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reactive-resource"><a class="anchor" href="#reactive-resource"></a>Reactive Resource</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Because the interaction with the database is non-blocking and asynchronous, we need to use asynchronous constructs to implement our HTTP resource.
Quarkus uses Mutiny as its central reactive programming model.
So, it supports returning Mutiny types (<code>Uni</code> and <code>Multi</code>) from HTTP endpoints.
Also, our Fruit Panache entity exposes methods using these types, so we only need to implement the <em>glue</em>.</p>
</div>
<div class="paragraph">
<p>Create the <code>src/main/java/org/acme/hibernate/orm/panache/FruitResource.java</code> file with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.hibernate.orm.panache;

import java.util.List;

import io.quarkus.panache.common.Sort;
import io.smallrye.mutiny.Uni;
import jakarta.enterprise.context.ApplicationScoped;
import jakarta.ws.rs.Path;

@Path("/fruits")
@ApplicationScoped
public class FruitResource {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s start with the <code>getAll</code> method. The <code>getAll</code> method returns all the fruits stored in the database.
In the <code>FruitResource</code>, add the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@GET
public Uni&lt;List&lt;Fruit&gt;&gt; get() {
    return Fruit.listAll(Sort.by("name"));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Open <a href="http://localhost:8080/fruits" class="bare">http://localhost:8080/fruits</a> to invoke this method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[{"id":2,"name":"Apple"},{"id":3,"name":"Banana"},{"id":1,"name":"Cherry"},{"id":4,"name":"peach"}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>We get the expected JSON array.
Quarkus REST automatically maps the list into a JSON Array, except if instructed otherwise.</p>
</div>
<div class="paragraph">
<p>Look at the return type; it returns a <code>Uni</code> of <code>List&lt;Fruit&gt;</code>.
<code>Uni</code> is an asynchronous type.
It&#8217;s a bit like a future.
It&#8217;s a placeholder that will get its value (item) later.
When it receives the item (Mutiny says it <em>emits</em> its item), you can attach some behavior.
That&#8217;s how we express the continuation: get a uni, and when the uni emits its item, execute the rest of the processing.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Reactive developers may wonder why we can&#8217;t return a stream of fruits directly.
It tends to be a bad idea when dealing with a database.
Relational databases do not handle streaming well.
It’s a problem of protocols not designed for this use case.
So, to stream rows from the database, you need to keep a connection (and sometimes a transaction) open until all the rows are consumed.
If you have slow consumers, you break the golden rule of databases: don’t hold connections for too long.
Indeed, the number of connections is rather low, and having consumers keeping them for too long will dramatically reduce the concurrency of your application.
So, when possible, use a <code>Uni&lt;List&lt;T&gt;&gt;</code> and load the content.
If you have a large set of results, implement pagination.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s continue our API with <code>getSingle</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@GET
@Path("/{id}")
public Uni&lt;Fruit&gt; getSingle(Long id) {
    return Fruit.findById(id);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, we use <code>Fruit.findById</code> to retrieve the fruit.
It returns a <code>Uni</code>, which will complete when the database has retrieved the row.</p>
</div>
<div class="paragraph">
<p>The <code>create</code> method allows adding a new fruit to the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@POST
public Uni&lt;RestResponse&lt;Fruit&gt;&gt; create(Fruit fruit) {
    return Panache.withTransaction(fruit::persist).replaceWith(RestResponse.status(CREATED, fruit));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code is a bit more involved.
To write to a database, we need a transaction, therefore we use <code>Panache.withTransaction</code> to obtain one (asynchronously) and proceed to call the <code>persist</code> method.
The <code>persist</code> method returns a <code>Uni</code> that emits the result of the insertion of the fruit in the database.
Once the insertion completes (which plays the role of the continuation), we create a <code>201 CREATED</code> HTTP response.</p>
</div>
<div class="paragraph">
<p>If you have <a href="https://curl.se/">curl</a> on your machine, you can try the endpoint using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; curl --header "Content-Type: application/json" \
  --request POST \
  --data '{"name":"peach"}' \
  http://localhost:8080/fruits</code></pre>
</div>
</div>
<div class="paragraph">
<p>Following the same ideas, you can implement the other CRUD methods.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing-and-running"><a class="anchor" href="#testing-and-running"></a>Testing and Running</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Testing a reactive application is similar to testing a non-reactive one: use the HTTP endpoint and verify the HTTP responses.
The fact that the application is reactive does not change anything.</p>
</div>
<div class="paragraph">
<p>In <a href="https://github.com/quarkusio/quarkus-quickstarts/blob/main/hibernate-reactive-panache-quickstart/src/test/java/org/acme/hibernate/orm/panache/FruitsEndpointTest.java">FruitsEndpointTest.java</a> you can see how the test for the fruit application can be implemented.</p>
</div>
<div class="paragraph">
<p>Packaging and running the application does not change either.</p>
</div>
<div class="paragraph">
<p>You can use the following command as usual:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">CLI</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew build</code></pre>
</div>
</div>
<div class="paragraph">
<p>or to build a native executable:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">CLI</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build --native</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install -Dnative</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew build -Dquarkus.native.enabled=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also package the application in a container.</p>
</div>
<div class="paragraph">
<p>To run the application, don’t forget to start a database and provide the configuration to your application.</p>
</div>
<div class="paragraph">
<p>For example, you can use Docker to run your database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker run -it --rm=true \
    --name postgres-quarkus -e POSTGRES_USER=quarkus \
    -e POSTGRES_PASSWORD=quarkus -e POSTGRES_DB=fruits \
    -p 5432:5432 postgres:14.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, launch the application using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">java \
   -Dquarkus.datasource.reactive.url=postgresql://localhost/fruits \
   -Dquarkus.datasource.username=quarkus \
   -Dquarkus.datasource.password=quarkus \
   -jar target/quarkus-app/quarkus-run.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, if you packaged your application as native executable, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./target/getting-started-with-reactive-runner \
  -Dquarkus.datasource.reactive.url=postgresql://localhost/fruits \
  -Dquarkus.datasource.username=quarkus \
  -Dquarkus.datasource.password=quarkus</code></pre>
</div>
</div>
<div class="paragraph">
<p>The parameters passed to the application are described in the datasource guide.
There are other ways to configure the application - please check the <a href="config-reference#configuration-sources">configuration guide</a> to have an overview of the possibilities (such as env variable, .env files and so on).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="going-further"><a class="anchor" href="#going-further"></a>Going further</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide is a brief introduction to some reactive features offered by Quarkus.
Quarkus is a reactive framework, and so offers a lot of reactive features.</p>
</div>
<div class="paragraph">
<p>If you want to continue on this topic check:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="quarkus-reactive-architecture">The Quarkus Reactive Architecture</a></p>
</li>
<li>
<p><a href="mutiny-primer">Mutiny - an intuitive reactive programming library</a></p>
</li>
</ul>
</div>
</div>
</div>
    </div>
    <div class="grid__item width-4-12 width-12-12-m tocwrapper">
      <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#imperative-vs-reactive-a-question-of-threads">Imperative vs. Reactive: a question of threads</a></li>
<li><a href="#from-sequential-to-continuation-style">From sequential to continuation style</a></li>
<li><a href="#bootstrapping-the-reactive-fruits-application">Bootstrapping the Reactive Fruits application</a></li>
<li><a href="#reactive-panache-entity">Reactive Panache Entity</a></li>
<li><a href="#reactive-resource">Reactive Resource</a></li>
<li><a href="#testing-and-running">Testing and Running</a></li>
<li><a href="#going-further">Going further</a></li>
</ul></div>
    </div>
  </div>
  <h2>Related content</h2>
  <div class="grid-wrapper relations">
    <div class="grid__item width-6-12 width-12-12-m">
      <h3>On the same topics</h3>
      <ul class="related-content">
      
        
        <li class="reference"><a href="/version/3.20/guides/datasource">Configure data sources in Quarkus</a></li>
      
        
        <li class="tutorial"><a href="/version/3.20/guides/getting-started">Creating Your First Application</a></li>
      
        
        <li class="guide"><a href="/version/3.20/guides/mutiny-primer">Mutiny - Async for mere mortals</a></li>
      
        
        <li class="guide"><a href="/version/3.20/guides/quarkus-reactive-architecture">Quarkus Reactive Architecture</a></li>
      
        
        <li class="guide"><a href="/version/3.20/guides/reactive-sql-clients">Reactive SQL Clients</a></li>
      
        
        <li class="guide"><a href="/version/3.20/guides/getting-started-testing">Testing Your Application</a></li>
      
        
        <li class="tutorial"><a href="/version/3.20/guides/getting-started-dev-services">Your second Quarkus application</a></li>
      </ul>
    </div>
    </div>
  </div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license.<br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>GitHub Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links">
          
          
            <li><a href="/" target="_blank">Home</a></li>
          
          
          
            <li><a href="/about" target="_blank">About</a></li>
          
          
          
            <li><a href="/blog" target="_blank">Blog</a></li>
          
          
          
            <li><a href="/insights" target="_blank">Podcast</a></li>
          
          
          
            <li><a href="/events" target="_blank">Events</a></li>
          
          
          
            <li><a href="/newsletter" target="_blank">Newsletter</a></li>
          
          
          
            <li><a href="/userstories" target="_blank">User Stories</a></li>
          
          
          
            <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" target="_blank">Roadmap</a></li>
          
          
          
            <li><a href="/security" target="_blank">Security&nbsp;policy</a></li>
          
          
          
            <li><a href="/usage" target="_blank">Usage</a></li>
          
          
          
            <li><a href="/brand" target="_blank">Brand</a></li>
          
          
          
            <li><a href="/desktopwallpapers" target="_blank">Wallpapers</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Follow Us</span>
        <ul class="footer-links">
          
          
            <li><a href="https://x.com/quarkusio" target="_blank">X</a></li>
          
          
          
            <li><a href="https://bsky.app/profile/quarkus.io" target="_blank">Bluesky</a></li>
          
          
          
            <li><a rel="me" href="https://fosstodon.org/@quarkusio" target="_blank">Mastodon</a></li>
            
          
          
            <li><a href="https://www.facebook.com/quarkusio" target="_blank">Facebook</a></li>
          
          
          
            <li><a href="https://www.linkedin.com/company/quarkusio/" target="_blank">Linkedin</a></li>
          
          
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg" target="_blank">Youtube</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio" target="_blank">GitHub</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links">
          
          
            <li><a href="/support" target="_blank">Support</a></li>
          
          
          
            <li><a href="/guides" target="_blank">Guides</a></li>
          
          
          
            <li><a href="/faq" target="_blank">FAQ</a></li>
          
          
          
            <li><a href="/get-started" target="_blank">Get Started</a></li>
          
          
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus" target="_blank">Stack Overflow</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions" target="_blank">Discussions</a></li>
          
          
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev" target="_blank">Development mailing list</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Languages</span>
        <ul class="footer-links">
          
          
            <li><a href="https://quarkus.io/" target="_blank">English</a></li>
          
          
          
            <li><a href="https://pt.quarkus.io/" target="_blank">Português&nbsp;(Brasileiro)</a></li>
          
          
          
            <li><a href="https://es.quarkus.io/" target="_blank">Español</a></li>
          
          
          
            <li><a href="https://cn.quarkus.io/" target="_blank">简体中文</a></li>
          
          
          
            <li><a href="https://ja.quarkus.io/" target="_blank">日本語</a></li>
          
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a blah href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a blah href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a blah href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a blah href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a blah href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a blah href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a blah href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a blah href="https://code.quarkus.io/" target="_blank">And many more...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
  <script src="/assets/javascript/future-date.js" type="text/javascript"></script>
</body>

</html>
