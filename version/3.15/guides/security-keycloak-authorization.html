<!DOCTYPE html>
<html lang="en">







<head>
  <title>Using OpenID Connect (OIDC) and Keycloak to centralize authorization - 3.15 - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://route-default-test-mscherer-matamo.apps.ospo-osci.z3b1.p1.openshiftapps.com/ https://search.quarkus.io https://smetrics.redhat.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      js.bizographics.com
      https://www.redhat.com
      https://static.redhat.com
      https://app.requestly.io/
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://giscus.app
      https://route-default-test-mscherer-matamo.apps.ospo-osci.z3b1.p1.openshiftapps.com/
      https://app.mailjet.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net https://www.youtube.com https://embed.restream.io https://app.mailjet.com http://xy0p2.mjt.lu https://mj.quarkus.io https://giscus.app; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/version/3.15/guides/security-keycloak-authorization" />
  <meta property="og:title" content="Using OpenID Connect (OIDC) and Keycloak to centralize authorization - 3.15" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/security-keycloak-authorization">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="en" href="https://quarkus.io/version/3.15/guides/security-keycloak-authorization" />
  
  <link rel="alternate" hreflang="pt-br" href="https://pt.quarkus.io/version/3.15/guides/security-keycloak-authorization" />
  
  <link rel="alternate" hreflang="es" href="https://es.quarkus.io/version/3.15/guides/security-keycloak-authorization" />
  
  <link rel="alternate" hreflang="zh" href="https://cn.quarkus.io/version/3.15/guides/security-keycloak-authorization" />
  
  <link rel="alternate" hreflang="ja" href="https://ja.quarkus.io/version/3.15/guides/security-keycloak-authorization" />
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />  
  <script src="/assets/javascript/tracking.js"></script>
  
  <script src="/assets/javascript/colormode.js" type="text/javascript"></script>

</head>

<body class="guides">

  
  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
        <div class="logo-wrapper">
           <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/about/">Why<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">WHAT IS QUARKUS?</a></li>
          <li><a href="/container-first" class="">CONTAINER FIRST</a></li>
          <li><a href="/continuum" class="">VERSATILITY</a></li>
          <li><a href="/developer-joy" class="">DEVELOPER JOY</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">STANDARDS</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/learn/">Learn<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">GET STARTED</a></li>
          <li><a href="/guides" class="active">DOCUMENTATION</a></li>
          <li><a href="/qtips" class="">"Q" TIP VIDEOS</a></li>          
          <li><a href="/books" class="">BOOKS</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="https://quarkus.io/extensions/">Extensions<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <!-- Note that quarkus.io is hardcoded here, because it is the only url which supports extensions -->
          <li><a href="https://quarkus.io/extensions/" class="">BROWSE EXTENSIONS</a></li>
          <li><a href="/faq/#what-is-a-quarkus-extension" class="">USE EXTENSIONS</a></li>
          <li><a href="/guides/writing-extensions" class="">CREATE EXTENSIONS</a></li>
          <li><a href="https://hub.quarkiverse.io" class="">SHARE EXTENSIONS</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/community/">Community<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">SUPPORT</a></li>
          <li><a href="/blog" class="">BLOG</a></li>
          <li><a href="/discussion" class="">DISCUSSION</a></li>
          <li><a href="/working-groups" class="">WORKING GROUPS</a></li>
          <li><a href="/insights" class="">PODCAST</a></li>
          <li><a href="/events" class="">EVENTS</a></li>
          <li><a href="/newsletter" class="">NEWSLETTER</a></li>
          <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" class="">ROADMAP</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary white">START CODING</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/version/3.15/guides/security-keycloak-authorization" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://pt.quarkus.io/version/3.15/guides/security-keycloak-authorization">PORTUGUÊS (BR)</a></li>
          <li><a href="https://es.quarkus.io/version/3.15/guides/security-keycloak-authorization">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/version/3.15/guides/security-keycloak-authorization">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/version/3.15/guides/security-keycloak-authorization">日本語</a></li>
          </ul>
      </li>
      <li>
        <span href="#" class="modeswitcher" id='theme-toggle'><i class="fas fa-sun"></i><i class="fas fa-moon"></i><i class="fas fa-cog"></i></span>
      </li>
    </ul>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    







<section class="full-width-version-bg flexfilterbar guides">
  <div class="guideflexcontainer">
    <div class="docslink">
      <a class="returnlink" href="/version/3.15/guides/"> Back to Guides</a>
    </div>
    <div class="flexlabel">
      <label>By Version</label>
    </div>
    <div class="guidepulldown version">
    <select id="guide-version-dropdown">
      
        
        
        <option value="main" >Main - SNAPSHOT</option>
        
        
        
        <option value="latest" >3.16.2 - Latest</option>
        
        
        
        <option value="3.15" selected>3.15</option>
        
        
        
        <option value="3.8" >3.8</option>
        
        
        
        <option value="3.2" >3.2</option>
        
        
        
        <option value="2.16" >2.16</option>
        
        
        
        <option value="2.13" >2.13</option>
        </select>
    </div>
  </div>
</section>

<div class="guide">
  <div class="grid-wrapper">
    <div class="grid__item width-8-12 width-12-12-m">
      
      <h1 class="text-caps">Using OpenID Connect (OIDC) and Keycloak to centralize authorization </h1>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Learn how to enable bearer token authorization in your Quarkus application using <a href="https://www.keycloak.org/docs/latest/authorization_services/index.html">Keycloak Authorization Services</a> for secure access to protected resources.</p>
</div>
<div class="paragraph">
<p>The <code>quarkus-keycloak-authorization</code> extension relies on <code>quarkus-oidc</code>.
It includes a policy enforcer that regulates access to secured resources.
Access is governed by permissions set in Keycloak.
Currently, this extension is compatible solely with Quarkus <a href="security-oidc-bearer-token-authentication">OIDC service applications</a>.</p>
</div>
<div class="paragraph">
<p>It provides a flexible and dynamic authorization capability based on Resource-Based Access Control.</p>
</div>
<div class="paragraph">
<p>Rather than explicitly enforcing access through specific mechanisms such as role-based access control (RBAC), <code>quarkus-keycloak-authorization</code> determines request permissions based on resource attributes such as name, identifier, or Uniform Resource Identifier (URI).
This process involves sending a <code>quarkus-oidc</code>-verified bearer access token to Keycloak Authorization Services for an authorization decision.</p>
</div>
<div class="paragraph">
<p>Use <code>quarkus-keycloak-authorization</code> only if you work with Keycloak and have Keycloak Authorization Services enabled to make authorization decisions.
Use <code>quarkus-oidc</code> if you do not work with Keycloak or work with Keycloak but do not have its Keycloak Authorization Services enabled to make authorization decisions.</p>
</div>
<div class="paragraph">
<p>By shifting authorization responsibilities outside your application, you enhance security through various access control methods while eliminating the need for frequent re-deployments whenever security needs evolve.
In this case, Keycloak acts as a centralized authorization hub, managing your protected resources and their corresponding permissions effectively.</p>
</div>
<div class="paragraph">
<p>For more information, see the <a href="security-oidc-bearer-token-authentication">OIDC Bearer token authentication</a> guide.
It is important to realize that the Bearer token authentication mechanism does the authentication and creates a security identity.
Meanwhile, the <code>quarkus-keycloak-authorization</code> extension applies a Keycloak Authorization Policy to this identity based on the current request path and other policy settings.</p>
</div>
<div class="paragraph">
<p>For more information, see <a href="https://www.keycloak.org/docs/latest/authorization_services/index.html#_enforcer_overview">Keycloak Authorization Services documentation</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To complete this guide, you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Roughly 15 minutes</p>
</li>
<li>
<p>An IDE</p>
</li>
<li>
<p>JDK 17+ installed with <code>JAVA_HOME</code> configured appropriately</p>
</li>
<li>
<p>Apache Maven 3.9.8</p>
</li>
<li>
<p>A working container runtime (Docker or <a href="podman">Podman</a>)</p>
</li>
<li>
<p>Optionally the <a href="cli-tooling">Quarkus CLI</a> if you want to use it</p>
</li>
<li>
<p>Optionally Mandrel or GraalVM installed and <a href="building-native-image#configuring-graalvm">configured appropriately</a> if you want to build a native executable (or Docker if you use a native container build)</p>
</li>
<li>
<p><a href="https://stedolan.github.io/jq/">jq tool</a></p>
</li>
<li>
<p><a href="https://www.keycloak.org">Keycloak</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="architecture"><a class="anchor" href="#architecture"></a>Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this example, we build a very simple microservice that offers two endpoints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/api/users/me</code></p>
</li>
<li>
<p><code>/api/admin</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These endpoints are protected.
Access is granted only when a client sends a bearer token with the request.
This token must be valid, having a correct signature, expiration date, and audience.
Additionally, the microservice must trust the token.</p>
</div>
<div class="paragraph">
<p>The bearer token is issued by a Keycloak server and represents the subject for which the token was issued.
For being an OAuth 2.0 Authorization Server, the token also references the client acting on behalf of the user.</p>
</div>
<div class="paragraph">
<p>The <code>/api/users/me</code> endpoint can be accessed by any user with a valid token.
As a response, it returns a JSON document with details about the user obtained from the information carried on the token.
This endpoint is protected with RBAC, and only users granted with the <code>user</code> role can access this endpoint.</p>
</div>
<div class="paragraph">
<p>The <code>/api/admin</code> endpoint is protected with RBAC, and only users granted the <code>admin</code> role can access it.</p>
</div>
<div class="paragraph">
<p>This is a very simple example of using RBAC policies to govern access to your resources.
However, Keycloak supports other policies that you can use to perform even more fine-grained access control.
By using this example, you&#8217;ll see that your application is completely decoupled from your authorization policies, with enforcement purely based on the accessed resource.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="solution"><a class="anchor" href="#solution"></a>Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We recommend that you follow the instructions in the next sections and create the application step by step.
However, you can go right to the completed example.</p>
</div>
<div class="paragraph">
<p>Clone the Git repository: <code>git clone -b 3.15 <a href="https://github.com/quarkusio/quarkus-quickstarts.git" class="bare">https://github.com/quarkusio/quarkus-quickstarts.git</a></code>, or download an <a href="https://github.com/quarkusio/quarkus-quickstarts/archive/3.15.zip">archive</a>.</p>
</div>
<div class="paragraph">
<p>The solution is in the <code>security-keycloak-authorization-quickstart</code> <a href="https://github.com/quarkusio/quarkus-quickstarts/tree/3.15/security-keycloak-authorization-quickstart">directory</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-the-project"><a class="anchor" href="#creating-the-project"></a>Creating the project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, we need a new project.
Create a new project with the following command:</p>
</div>
<div class="sidebarblock primary asciidoc-tabs-sync-cli">
<div class="content">
<div class="title">CLI</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus create app org.acme:security-keycloak-authorization-quickstart \
    --extension='oidc,keycloak-authorization,rest-jackson' \
    --no-code
cd security-keycloak-authorization-quickstart</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create a Gradle project, add the <code>--gradle</code> or <code>--gradle-kotlin-dsl</code> option.</p>
</div>
<div class="paragraph">
<p>For more information about how to install and use the Quarkus CLI, see the <a href="cli-tooling">Quarkus CLI</a> guide.</p>
</div>
</div>
</div>
<div class="sidebarblock secondary asciidoc-tabs-sync-maven">
<div class="content">
<div class="title">Maven</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn io.quarkus.platform:quarkus-maven-plugin:3.15.1:create \
    -DprojectGroupId=org.acme \
    -DprojectArtifactId=security-keycloak-authorization-quickstart \
    -Dextensions='oidc,keycloak-authorization,rest-jackson' \
    -DnoCode
cd security-keycloak-authorization-quickstart</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create a Gradle project, add the <code>-DbuildTool=gradle</code> or <code>-DbuildTool=gradle-kotlin-dsl</code> option.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>For Windows users:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If using cmd, (don&#8217;t use backward slash <code>\</code> and put everything on the same line)</p>
</li>
<li>
<p>If using Powershell, wrap <code>-D</code> parameters in double quotes e.g. <code>"-DprojectArtifactId=security-keycloak-authorization-quickstart"</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command generates a project, importing the <code>keycloak-authorization</code> extension.
This extension implements a Keycloak Adapter for Quarkus applications and provides all the necessary capabilities to integrate with a Keycloak server and perform bearer token authorization.</p>
</div>
<div class="paragraph">
<p>If you already have your Quarkus project configured, you can add the <code>oidc</code> and <code>keycloak-authorization</code> extensions
to your project by running the following command in your project base directory:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">CLI</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus extension add oidc,keycloak-authorization</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:add-extension -Dextensions='oidc,keycloak-authorization'</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew addExtension --extensions='oidc,keycloak-authorization'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This adds the following dependencies to your build file:</p>
</div>
<div class="listingblock primary asciidoc-tabs-target-sync-cli asciidoc-tabs-target-sync-maven">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-oidc&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-keycloak-authorization&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-target-sync-gradle">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">implementation("io.quarkus:quarkus-oidc")
implementation("io.quarkus:quarkus-keycloak-authorization")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s start by implementing the <code>/api/users/me</code> endpoint.
As you can see in the following source code, it is a regular Jakarta REST resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.keycloak.authorization;

import jakarta.inject.Inject;
import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;

import org.jboss.resteasy.reactive.NoCache;

import io.quarkus.security.identity.SecurityIdentity;

@Path("/api/users")
public class UsersResource {

    @Inject
    SecurityIdentity identity;

    @GET
    @Path("/me")
    @NoCache
    public User me() {
        return new User(identity);
    }

    public static class User {

        private final String userName;

        User(SecurityIdentity identity) {
            this.userName = identity.getPrincipal().getName();
        }

        public String getUserName() {
            return userName;
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The source code for the <code>/api/admin</code> endpoint is also very simple:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.keycloak.authorization;

import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;
import jakarta.ws.rs.Produces;
import jakarta.ws.rs.core.MediaType;

import io.quarkus.security.Authenticated;

@Path("/api/admin")
@Authenticated
public class AdminResource {

    @GET
    @Produces(MediaType.TEXT_PLAIN)
    public String admin() {
        return "granted";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Be aware that we have not defined annotations such as <code>@RolesAllowed</code> to explicitly enforce access to a resource.
Instead, the extension is responsible for mapping the URIs of the protected resources in Keycloak and evaluating the permissions accordingly, granting or denying access depending on the permissions granted by Keycloak.</p>
</div>
<div class="sect2">
<h3 id="configuring-the-application"><a class="anchor" href="#configuring-the-application"></a>Configuring the application</h3>
<div class="paragraph">
<p>The OpenID Connect extension allows you to define the adapter configuration by using the <code>application.properties</code> file, which is usually located in the <code>src/main/resources</code> directory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># OIDC Configuration
%prod.quarkus.oidc.auth-server-url=https://localhost:8543/realms/quarkus
quarkus.oidc.client-id=backend-service
quarkus.oidc.credentials.secret=secret
quarkus.oidc.tls.verification=none

# Enable Policy Enforcement
quarkus.keycloak.policy-enforcer.enable=true

# Tell Dev Services for Keycloak to import the realm file
# This property is not effective when running the application in JVM or native modes
quarkus.keycloak.devservices.realm-path=quarkus-realm.json</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Adding a <code>%prod.</code> profile prefix to <code>quarkus.oidc.auth-server-url</code> ensures that Dev Services for Keycloak launches a container for you when the application is run in dev mode.
For more information, see the <a href="#keycloak-dev-mode">Running the application in Dev mode</a> section.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default, applications that use the <code>quarkus-oidc</code> extension are marked as a <code>service</code> type application (see <code>quarkus.oidc.application-type</code>).
This extension also supports only  <code>web-app</code> type applications but only if the access token returned as part of the authorization code grant response is marked as a source of roles: <code>quarkus.oidc.roles.source=accesstoken</code> (<code>web-app</code> type applications check ID token roles by default).
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="starting-and-configuring-the-keycloak-server"><a class="anchor" href="#starting-and-configuring-the-keycloak-server"></a>Starting and configuring the Keycloak server</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Do not start the Keycloak server when you run the application in dev mode.
Dev Services for Keycloak launches a container.
For more information, see the <a href="#keycloak-dev-mode">Running the application in Dev mode</a> section.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To start a Keycloak server, use the following Docker command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker run --name keycloak -e KEYCLOAK_ADMIN=admin -e KEYCLOAK_ADMIN_PASSWORD=admin -p 8543:8443 -v "$(pwd)"/config/keycloak-keystore.jks:/etc/keycloak-keystore.jks quay.io/keycloak/keycloak:{keycloak.version} start  --hostname-strict=false --https-key-store-file=/etc/keycloak-keystore.jks</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>keycloak.version</code> must be <code>25.0.6</code> or later and the <code>keycloak-keystore.jks</code> can be found in <a href="https://github.com/quarkusio/quarkus-quickstarts/blob/main/security-keycloak-authorization-quickstart/config/keycloak-keystore.jks">quarkus-quickstarts/security-keycloak-authorization-quickstart/config</a>.</p>
</div>
<div class="paragraph">
<p>Try to access your Keycloak server at <a href="https://localhost:8543">localhost:8543</a>.</p>
</div>
<div class="paragraph">
<p>To access the Keycloak Administration Console, log in as the <code>admin</code> user.
The username and password are both <code>admin</code>.</p>
</div>
<div class="paragraph">
<p>Import the <a href="https://github.com/quarkusio/quarkus-quickstarts/tree/3.15/security-keycloak-authorization-quickstart/config/quarkus-realm.json">realm configuration file</a> to create a new realm.
For more details, see the Keycloak documentation about how to <a href="https://www.keycloak.org/docs/latest/server_admin/index.html#_create-realm">create a new realm</a>.</p>
</div>
<div class="paragraph">
<p>After importing the realm you can see the resource permissions:</p>
</div>
<div class="imageblock center">
<div class="content">
<img src="./images/keycloak-authorization-permissions.png" alt="Keycloak Authorization Permissions">
</div>
</div>
<div class="paragraph">
<p>It explains why the endpoint has no <code>@RolesAllowed</code> annotations - the resource access permissions are set directly in Keycloak.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="keycloak-dev-mode"><a class="anchor" href="#keycloak-dev-mode"></a>Running the application in dev mode</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To run the application in dev mode, use:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">CLI</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus dev</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew --console=plain quarkusDev</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="security-openid-connect-dev-services">Dev Services for Keycloak</a> launches a Keycloak container and imports a <code>quarkus-realm.json</code>.</p>
</div>
<div class="paragraph">
<p>Open a <a href="dev-ui">Dev UI</a> available at <a href="http://localhost:8080/q/dev-ui">/q/dev-ui</a> and click a <code>Provider: Keycloak</code> link in an <code>OpenID Connect</code> <code>Dev UI</code> card.</p>
</div>
<div class="paragraph">
<p>When asked to log in to a <code>Single Page Application</code> provided by <code>OpenID Connect Dev UI</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Log in as <code>alice</code> (password: <code>alice</code>), who only has a <code>User Permission</code> to access the <code>/api/users/me</code> resource:</p>
<div class="ulist">
<ul>
<li>
<p>Access <code>/api/admin</code>, which returns <code>403</code>.</p>
</li>
<li>
<p>Access <code>/api/users/me</code>, which returns <code>200</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Log out and log in as <code>admin</code> (password: <code>admin</code>), who has both <code>Admin Permission</code> to access the <code>/api/admin</code> resource and <code>User Permission</code> to access the <code>/api/users/me</code> resource:</p>
<div class="ulist">
<ul>
<li>
<p>Access <code>/api/admin</code>, which returns <code>200</code>.</p>
</li>
<li>
<p>Access <code>/api/users/me</code>, which returns <code>200</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you have started <a href="security-openid-connect-dev-services">Dev Services for Keycloak</a> without importing a realm file such as <a href="https://github.com/quarkusio/quarkus-quickstarts/tree/3.15/security-keycloak-authorization-quickstart/config/quarkus-realm.json">quarkus-realm.json</a> that is already configured to support Keycloak Authorization, create a default <code>quarkus</code> realm without Keycloak authorization policies.
In this case, you must select the <code>Keycloak Admin</code> link in the <code>OpenId Connect</code> Dev UI card and configure <a href="https://www.keycloak.org/docs/latest/authorization_services/index.html">Keycloak Authorization Services</a> in the default <code>quarkus</code> realm.</p>
</div>
<div class="paragraph">
<p>The <code>Keycloak Admin</code> link is easy to find in Dev UI:</p>
</div>
<div class="imageblock center">
<div class="content">
<img src="./images/dev-ui-oidc-keycloak-card.png" alt="Dev UI OpenID Connect Card">
</div>
</div>
<div class="paragraph">
<p>When logging into the Keycloak admin console, the username and password are both <code>admin</code>.</p>
</div>
<div class="paragraph">
<p>If your application uses Keycloak authorization configured with <a href="https://www.keycloak.org/docs/latest/authorization_services/index.html#_policy_js">JavaScript policies</a> that are deployed in a JAR file, you can set up Dev Services for Keycloak to transfer this archive to the Keycloak container.
For instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.keycloak.devservices.resource-aliases.policies=/policies.jar <i class="conum" data-value="1"></i><b>(1)</b>
quarkus.keycloak.devservices.resource-mappings.policies=/opt/keycloak/providers/policies.jar <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>policies</code> alias is created for the <code>/policies.jar</code> classpath resource.
Policy archive can also be located in the file system.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The policies archive is mapped to the <code>/opt/keycloak/providers/policies.jar</code> container location.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-the-application-in-jvm-mode"><a class="anchor" href="#running-the-application-in-jvm-mode"></a>Running the application in JVM mode</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After exploring the application in dev mode, you can run it as a standard Java application.</p>
</div>
<div class="paragraph">
<p>First compile it:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">CLI</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew build</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then run it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">java -jar target/quarkus-app/quarkus-run.jar</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-the-application-in-native-mode"><a class="anchor" href="#running-the-application-in-native-mode"></a>Running the application in native mode</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This same demo can be compiled into native code; no modifications are required.</p>
</div>
<div class="paragraph">
<p>This implies that you no longer need to install a JVM on your production environment because the runtime technology is included in the produced binary and optimized to run with minimal resources.</p>
</div>
<div class="paragraph">
<p>Compilation takes a bit longer, so this step is turned off by default; let&#8217;s build again by enabling the <code>native</code> profile:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">CLI</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build --native</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install -Dnative</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew build -Dquarkus.native.enabled=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>After a while, you can run this binary directly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./target/security-keycloak-authorization-quickstart-runner</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing"><a class="anchor" href="#testing"></a>Testing the application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>See the preceding <a href="#keycloak-dev-mode">Running the application in Dev mode</a> section about testing your application in a dev mode.</p>
</div>
<div class="paragraph">
<p>You can test the application launched in JVM or native modes with <code>curl</code>.</p>
</div>
<div class="paragraph">
<p>The application uses bearer token authorization, and the first thing to do is obtain an access token from the Keycloak server to access the application resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export access_token=$(\
    curl --insecure -X POST https://localhost:8543/realms/quarkus/protocol/openid-connect/token \
    --user backend-service:secret \
    -H 'content-type: application/x-www-form-urlencoded' \
    -d 'username=alice&amp;password=alice&amp;grant_type=password' | jq --raw-output '.access_token' \
 )</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding example obtains an access token for user <code>alice</code>.</p>
</div>
<div class="paragraph">
<p>Any user is allowed to access the
<code><a href="http://localhost:8080/api/users/me" class="bare">http://localhost:8080/api/users/me</a></code> endpoint,
which returns a JSON payload with details about the user.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -v -X GET \
  http://localhost:8080/api/users/me \
  -H "Authorization: Bearer "$access_token</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code><a href="http://localhost:8080/api/admin" class="bare">http://localhost:8080/api/admin</a></code> endpoint can only be accessed by users with the <code>admin</code> role.
If you try to access this endpoint with the previously issued access token, you get a <code>403</code> response from the server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"> curl -v -X GET \
   http://localhost:8080/api/admin \
   -H "Authorization: Bearer "$access_token</code></pre>
</div>
</div>
<div class="paragraph">
<p>To access the admin endpoint, get a token for the <code>admin</code> user:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export access_token=$(\
    curl --insecure -X POST https://localhost:8543/realms/quarkus/protocol/openid-connect/token \
    --user backend-service:secret \
    -H 'content-type: application/x-www-form-urlencoded' \
    -d 'username=admin&amp;password=admin&amp;grant_type=password' | jq --raw-output '.access_token' \
 )</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="injecting-the-authorization-client"><a class="anchor" href="#injecting-the-authorization-client"></a>Injecting the authorization client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In some cases, using the <a href="https://www.keycloak.org/docs/latest/authorization_services/#_service_client_api">Keycloak Authorization Client Java API</a> is beneficial for tasks such as managing resources and obtaining permissions directly from Keycloak.
For this purpose, you can inject an <code>AuthzClient</code> instance into your beans as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class ProtectedResource {
    @Inject
    AuthzClient authzClient;
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you want to use the <code>AuthzClient</code> directly, set <code>quarkus.keycloak.policy-enforcer.enable=true</code>; otherwise, no bean is available for injection.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mapping-protected-resources"><a class="anchor" href="#mapping-protected-resources"></a>Mapping protected resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, the extension fetches resources on-demand from Keycloak, using their URI to identify and map the resources in your application that need to be protected.</p>
</div>
<div class="paragraph">
<p>To disable this on-demand fetching and instead pre-load resources at startup, apply the following configuration setting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.keycloak.policy-enforcer.lazy-load-paths=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>The time required to pre-load resources from Keycloak at startup varies based on their quantity, potentially affecting your application&#8217;s initial load time."</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="more-about-configuring-protected-resources"><a class="anchor" href="#more-about-configuring-protected-resources"></a>More about configuring protected resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the default configuration, Keycloak manages the roles and decides who can access which routes.</p>
</div>
<div class="paragraph">
<p>To configure the protected routes by using the <code>@RolesAllowed</code> annotation or the <code>application.properties</code> file, check the <a href="security-oidc-bearer-token-authentication">OpenID Connect (OIDC) Bearer token authentication</a> and <a href="security-authorize-web-endpoints-reference">Authorization of web endpoints</a> guides.
For more details, check the <a href="security-overview">Quarkus Security overview</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="access-to-public-resources"><a class="anchor" href="#access-to-public-resources"></a>Access to public resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To enable access to a public resource without the <code>quarkus-keycloak-authorization</code> applying its policies, create a <code>permit</code> HTTP Policy configuration in <code>application.properties</code>.
For more information, see the <a href="security-authorize-web-endpoints-reference">Authorization of web endpoints</a> guide.</p>
</div>
<div class="paragraph">
<p>There&#8217;s no need to deactivate policy checks for a Keycloak Authorization Policy with settings such as these:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.keycloak.policy-enforcer.paths.1.paths=/api/public
quarkus.keycloak.policy-enforcer.paths.1.enforcement-mode=DISABLED</code></pre>
</div>
</div>
<div class="paragraph">
<p>To block access to the public resource to anonymous users, you can create an enforcing Keycloak Authorization Policy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.keycloak.policy-enforcer.paths.1.paths=/api/public-enforcing
quarkus.keycloak.policy-enforcer.paths.1.enforcement-mode=ENFORCING</code></pre>
</div>
</div>
<div class="paragraph">
<p>Only the default tenant configuration applies when controlling anonymous access to the public resource is required.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="checking-permission-scopes-programmatically"><a class="anchor" href="#checking-permission-scopes-programmatically"></a>Checking permission scopes programmatically</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In addition to resource permissions, you can specify method scopes.
The scope usually represents an action that can be performed on a resource.
You can create an enforcing Keycloak Authorization Policy with a method scope.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># path policy with enforced scope 'read' for method 'GET'
quarkus.keycloak.policy-enforcer.paths.1.name=Scope Permission Resource
quarkus.keycloak.policy-enforcer.paths.1.paths=/api/protected/standard-way
quarkus.keycloak.policy-enforcer.paths.1.methods.get.method=GET
quarkus.keycloak.policy-enforcer.paths.1.methods.get.scopes=read <i class="conum" data-value="1"></i><b>(1)</b>

# path policies without scope
quarkus.keycloak.policy-enforcer.paths.2.name=Scope Permission Resource
quarkus.keycloak.policy-enforcer.paths.2.paths=/api/protected/programmatic-way,/api/protected/annotation-way</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>User must have resource permission 'Scope Permission Resource' and scope 'read'</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Keycloak Policy Enforcer now secures the <code>/api/protected/standard-way</code> request path, eliminating the need for additional annotations such as <code>@RolesAllowed</code>.
However, in certain scenarios, a programmatic check is necessary.
You can achieve this by injecting a <code>SecurityIdentity</code> instance into your beans, as shown in the following example.
Or, you can get the same result by annotating the resource method with <code>@PermissionsAllowed</code>.
The following example demonstrates three resource methods, each requiring the same <code>read</code> scope:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.security.BasicPermission;
import java.util.List;

import jakarta.inject.Inject;
import jakarta.ws.rs.ForbiddenException;
import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;

import org.keycloak.representations.idm.authorization.Permission;

import io.quarkus.security.PermissionsAllowed;
import io.quarkus.security.identity.SecurityIdentity;
import io.smallrye.mutiny.Uni;

@Path("/api/protected")
public class ProtectedResource {

    @Inject
    SecurityIdentity identity;

    @GET
    @Path("/standard-way")
    public Uni&lt;List&lt;Permission&gt;&gt; standardWay() { <i class="conum" data-value="1"></i><b>(1)</b>
        return Uni.createFrom().item(identity.&lt;List&lt;Permission&gt;&gt; getAttribute("permissions"));
    }

    @GET
    @Path("/programmatic-way")
    public Uni&lt;List&lt;Permission&gt;&gt; programmaticWay() {
        var requiredPermission = new BasicPermission("Scope Permission Resource") {
            @Override
            public String getActions() {
                return "read";
            }
        };
        return identity.checkPermission(requiredPermission).onItem() <i class="conum" data-value="2"></i><b>(2)</b>
                .transform(granted -&gt; {
                    if (granted) {
                        return identity.getAttribute("permissions");
                    }
                    throw new ForbiddenException();
                });
    }

    @PermissionsAllowed("Scope Permission Resource:read") <i class="conum" data-value="3"></i><b>(3)</b>
    @GET
    @Path("/annotation-way")
    public Uni&lt;List&lt;Permission&gt;&gt; annotationWay() {
        return Uni.createFrom().item(identity.&lt;List&lt;Permission&gt;&gt; getAttribute("permissions"));
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Request sub-path <code>/standard-way</code> requires both resource permission and scope <code>read</code> according to the configuration properties we previously set in the <code>application.properties</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Request sub-path <code>/programmatic-way</code> only requires permission <code>Scope Permission Resource</code>, but we can enforce scope with <code>SecurityIdentity#checkPermission</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>@PermissionsAllowed</code> annotation only grants access to the requests with permission <code>Scope Permission Resource</code> and scope <code>read</code>.
For more information, see the section <a href="security-authorize-web-endpoints-reference#standard-security-annotations">Authorization using annotations</a> of the Security Authorization guide.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="multi-tenancy"><a class="anchor" href="#multi-tenancy"></a>Multi-tenancy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can set up policy enforcer configurations for each tenant, similar to how it is done with <a href="security-openid-connect-multitenancy">OpenID Connect (OIDC) multi-tenancy</a>.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.keycloak.policy-enforcer.enable=true

# Default Tenant
quarkus.oidc.auth-server-url=${keycloak.url:replaced-by-test-resource}/realms/quarkus
quarkus.oidc.client-id=quarkus-app
quarkus.oidc.credentials.secret=secret

quarkus.keycloak.policy-enforcer.enforcement-mode=PERMISSIVE
quarkus.keycloak.policy-enforcer.paths.1.name=Permission Resource
quarkus.keycloak.policy-enforcer.paths.1.paths=/api/permission
quarkus.keycloak.policy-enforcer.paths.1.claim-information-point.claims.static-claim=static-claim

# Service Tenant

quarkus.oidc.service-tenant.auth-server-url=${keycloak.url:replaced-by-test-resource}/realms/quarkus
quarkus.oidc.service-tenant.client-id=quarkus-app
quarkus.oidc.service-tenant.credentials.secret=secret

quarkus.keycloak.service-tenant.policy-enforcer.enforcement-mode=PERMISSIVE
quarkus.keycloak.service-tenant.policy-enforcer.paths.1.name=Permission Resource Service
quarkus.keycloak.service-tenant.policy-enforcer.paths.1.paths=/api/permission
quarkus.keycloak.service-tenant.policy-enforcer.paths.1.claim-information-point.claims.static-claim=static-claim


# WebApp Tenant

quarkus.oidc.webapp-tenant.auth-server-url=${keycloak.url:replaced-by-test-resource}/realms/quarkus
quarkus.oidc.webapp-tenant.client-id=quarkus-app
quarkus.oidc.webapp-tenant.credentials.secret=secret
quarkus.oidc.webapp-tenant.application-type=web-app
quarkus.oidc.webapp-tenant.roles.source=accesstoken

quarkus.keycloak.webapp-tenant.policy-enforcer.enforcement-mode=PERMISSIVE
quarkus.keycloak.webapp-tenant.policy-enforcer.paths.1.name=Permission Resource WebApp
quarkus.keycloak.webapp-tenant.policy-enforcer.paths.1.paths=/api/permission
quarkus.keycloak.webapp-tenant.policy-enforcer.paths.1.claim-information-point.claims.static-claim=static-claim</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dynamic-tenant-configuration-resolution"><a class="anchor" href="#dynamic-tenant-configuration-resolution"></a>Dynamic tenant configuration resolution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you need a more dynamic configuration for the different tenants you want to support and don’t want to end up
with multiple entries in your configuration file, you can use the <code>io.quarkus.keycloak.pep.TenantPolicyConfigResolver</code>.</p>
</div>
<div class="paragraph">
<p>This interface allows you to dynamically create tenant configurations at runtime:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.keycloak.authorization;

import java.util.Map;

import jakarta.enterprise.context.ApplicationScoped;

import io.quarkus.keycloak.pep.TenantPolicyConfigResolver;
import io.quarkus.keycloak.pep.runtime.KeycloakPolicyEnforcerConfig;
import io.quarkus.keycloak.pep.runtime.KeycloakPolicyEnforcerTenantConfig;
import io.quarkus.oidc.OidcRequestContext;
import io.quarkus.oidc.OidcTenantConfig;
import io.smallrye.mutiny.Uni;
import io.vertx.ext.web.RoutingContext;

@ApplicationScoped
public class CustomTenantPolicyConfigResolver implements TenantPolicyConfigResolver {

    private final KeycloakPolicyEnforcerTenantConfig enhancedTenantConfig;
    private final KeycloakPolicyEnforcerTenantConfig newTenantConfig;

    public CustomTenantPolicyConfigResolver(KeycloakPolicyEnforcerConfig enforcerConfig) {
        this.enhancedTenantConfig = KeycloakPolicyEnforcerTenantConfig.builder(config) <i class="conum" data-value="1"></i><b>(1)</b>
            .paths("/enhanced-config")
            .permissionName("Permission Name")
            .get("read-scope")
            .build();
        this.newTenantConfig = KeycloakPolicyEnforcerTenantConfig.builder() <i class="conum" data-value="2"></i><b>(2)</b>
            .paths("/new-config")
            .claimInformationPoint(Map.of("claims", Map.of("grant", "{request.parameter['grant']}")))
            .build();
    }

    @Override
    public Uni&lt;KeycloakPolicyEnforcerTenantConfig&gt; resolve(RoutingContext routingContext, OidcTenantConfig tenantConfig,
                                                OidcRequestContext&lt;KeycloakPolicyEnforcerTenantConfig&gt; requestContext) {
        String path = routingContext.normalizedPath();
        String tenantId = tenantConfig.tenantId.orElse(null);
        if ("enhanced-config-tenant".equals(tenantId) &amp;&amp; path.equals("/enhanced-config")) {
            return Uni.createFrom().item(enhancedTenantConfig);
        } else if ("new-config-tenant".equals(tenantId) &amp;&amp; path.equals("/new-config")) {
            return Uni.createFrom().item(newTenantConfig);
        }
        return Uni.createFrom().nullItem(); <i class="conum" data-value="3"></i><b>(3)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create or update the <code>/enhanced-config</code> path in the default tenant config.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add <code>/new-config</code> path into tenant config populated with documented configuration default values.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Use default static tenant configuration resolution based on the <code>application.properties</code> file and other SmallRye Config configuration sources.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-reference"><a class="anchor" href="#configuration-reference"></a>Configuration reference</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This configuration adheres to the official [Keycloak Policy Enforcer Configuration](<a href="https://www.keycloak.org/docs/latest/authorization_services/index.html#_enforcer_filter" class="bare">https://www.keycloak.org/docs/latest/authorization_services/index.html#_enforcer_filter</a>) guidelines.
For detailed insights into various configuration options, see the following documentation:</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> Configuration property fixed at build time - All other configuration properties are overridable at runtime <input type="search" id="config-search-0" placeholder="FILTER CONFIGURATION" disabled></p>
</div>
<table class="tableblock frame-all grid-all stretch configuration-reference searchable configuration-reference-all-rows">
<colgroup>
<col style="width: 80%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><span class="header-title">Configuration property</span></p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">Type</p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">Default</p></th>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-enable"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-enable"><code>quarkus.keycloak.policy-enforcer.enable</code></a></span></p>
</div>
<div id="conf-collapsible-desc-1" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Enables policy enforcement.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30619">QUARKUS_KEYCLOAK_POLICY_ENFORCER_ENABLE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30619" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-connection-pool-size"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-connection-pool-size"><code>quarkus.keycloak.connection-pool-size</code></a></span></p>
</div>
<div id="conf-collapsible-desc-2" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Adapters will make separate HTTP invocations to the Keycloak server to turn an access code into an access token. This config option defines how many connections to the Keycloak server should be pooled</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30620">QUARKUS_KEYCLOAK_CONNECTION_POOL_SIZE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30620" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>20</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-enforcement-mode"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-enforcement-mode"><code>quarkus.keycloak.policy-enforcer.enforcement-mode</code></a></span></p>
</div>
<div id="conf-collapsible-desc-3" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how policies are enforced.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30621">QUARKUS_KEYCLOAK_POLICY_ENFORCER_ENFORCEMENT_MODE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30621" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>permissive</code>, <code>enforcing</code>, <code>disabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>enforcing</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-path-cache-max-entries"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-path-cache-max-entries"><code>quarkus.keycloak.policy-enforcer.path-cache.max-entries</code></a></span></p>
</div>
<div id="conf-collapsible-desc-4" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Defines the limit of entries that should be kept in the cache</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30622">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATH_CACHE_MAX_ENTRIES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30622" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1000</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-path-cache-lifespan"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-path-cache-lifespan"><code>quarkus.keycloak.policy-enforcer.path-cache.lifespan</code></a></span></p>
</div>
<div id="conf-collapsible-desc-5" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Defines the time in milliseconds when the entry should be expired</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30623">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATH_CACHE_LIFESPAN</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30623" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>30000</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-lazy-load-paths"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-lazy-load-paths"><code>quarkus.keycloak.policy-enforcer.lazy-load-paths</code></a></span></p>
</div>
<div id="conf-collapsible-desc-6" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how the adapter should fetch the server for resources associated with paths in your application. If true, the policy enforcer is going to fetch resources on-demand accordingly with the path being requested</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30624">QUARKUS_KEYCLOAK_POLICY_ENFORCER_LAZY_LOAD_PATHS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30624" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-claim-information-point-complex-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-claim-information-point-complex-config"><code>quarkus.keycloak.policy-enforcer.claim-information-point."complex-config"</code></a></span></p>
</div>
<div id="conf-collapsible-desc-7" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Complex config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30625">QUARKUS_KEYCLOAK_POLICY_ENFORCER_CLAIM_INFORMATION_POINT__COMPLEX_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30625" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,Map&lt;String,String&gt;&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-claim-information-point-simple-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-claim-information-point-simple-config"><code>quarkus.keycloak.policy-enforcer.claim-information-point."simple-config"</code></a></span></p>
</div>
<div id="conf-collapsible-desc-8" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Simple config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30626">QUARKUS_KEYCLOAK_POLICY_ENFORCER_CLAIM_INFORMATION_POINT__SIMPLE_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30626" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,String&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-http-method-as-scope"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-http-method-as-scope"><code>quarkus.keycloak.policy-enforcer.http-method-as-scope</code></a></span></p>
</div>
<div id="conf-collapsible-desc-9" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how scopes should be mapped to HTTP methods. If set to true, the policy enforcer will use the HTTP method from the current request to check whether access should be granted</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30627">QUARKUS_KEYCLOAK_POLICY_ENFORCER_HTTP_METHOD_AS_SCOPE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30627" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-name"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-name"><code>quarkus.keycloak.policy-enforcer.paths."paths".name</code></a></span></p>
</div>
<div id="conf-collapsible-desc-10" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The name of a resource on the server that is to be associated with a given path</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30628">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__NAME</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30628" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-paths"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-paths"><code>quarkus.keycloak.policy-enforcer.paths."paths".paths</code></a></span></p>
</div>
<div id="conf-collapsible-desc-11" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>HTTP request paths that should be protected by the policy enforcer</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30629">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__PATHS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30629" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-methods-methods-method"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-methods-methods-method"><code>quarkus.keycloak.policy-enforcer.paths."paths".methods."methods".method</code></a></span></p>
</div>
<div id="conf-collapsible-desc-12" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The name of the HTTP method</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30630">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__METHODS__METHODS__METHOD</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30630" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">required <span class="icon"><i class="fa fa-exclamation-circle" title="Configuration property is required"></i></span></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-methods-methods-scopes"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-methods-methods-scopes"><code>quarkus.keycloak.policy-enforcer.paths."paths".methods."methods".scopes</code></a></span></p>
</div>
<div id="conf-collapsible-desc-13" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>An array of strings with the scopes associated with the method</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30631">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__METHODS__METHODS__SCOPES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30631" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">required <span class="icon"><i class="fa fa-exclamation-circle" title="Configuration property is required"></i></span></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-methods-methods-scopes-enforcement-mode"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-methods-methods-scopes-enforcement-mode"><code>quarkus.keycloak.policy-enforcer.paths."paths".methods."methods".scopes-enforcement-mode</code></a></span></p>
</div>
<div id="conf-collapsible-desc-14" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>A string referencing the enforcement mode for the scopes associated with a method</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30632">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__METHODS__METHODS__SCOPES_ENFORCEMENT_MODE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30632" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>all</code>, <code>any</code>, <code>disabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>all</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-enforcement-mode"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-enforcement-mode"><code>quarkus.keycloak.policy-enforcer.paths."paths".enforcement-mode</code></a></span></p>
</div>
<div id="conf-collapsible-desc-15" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how policies are enforced</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30633">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__ENFORCEMENT_MODE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30633" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>permissive</code>, <code>enforcing</code>, <code>disabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>enforcing</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-claim-information-point-complex-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-claim-information-point-complex-config"><code>quarkus.keycloak.policy-enforcer.paths."paths".claim-information-point."complex-config"</code></a></span></p>
</div>
<div id="conf-collapsible-desc-16" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Complex config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30634">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__CLAIM_INFORMATION_POINT__COMPLEX_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30634" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,Map&lt;String,String&gt;&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-claim-information-point-simple-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-claim-information-point-simple-config"><code>quarkus.keycloak.policy-enforcer.paths."paths".claim-information-point."simple-config"</code></a></span></p>
</div>
<div id="conf-collapsible-desc-17" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Simple config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30635">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__CLAIM_INFORMATION_POINT__SIMPLE_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30635" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,String&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><a id="quarkus-keycloak-authorization_section_quarkus-keycloak"></a> <span class="section-name section-level0"><a href="#quarkus-keycloak-authorization_section_quarkus-keycloak">Additional named tenants</a></span></p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">Type</p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">Default</p></th>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-connection-pool-size"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-connection-pool-size"><code>quarkus.keycloak."tenant".connection-pool-size</code></a></span></p>
</div>
<div id="conf-collapsible-desc-18" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Adapters will make separate HTTP invocations to the Keycloak server to turn an access code into an access token. This config option defines how many connections to the Keycloak server should be pooled</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30636">QUARKUS_KEYCLOAK__TENANT__CONNECTION_POOL_SIZE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30636" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>20</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-enforcement-mode"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-enforcement-mode"><code>quarkus.keycloak."tenant".policy-enforcer.enforcement-mode</code></a></span></p>
</div>
<div id="conf-collapsible-desc-19" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how policies are enforced.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30637">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_ENFORCEMENT_MODE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30637" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>permissive</code>, <code>enforcing</code>, <code>disabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>enforcing</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-name"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-name"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".name</code></a></span></p>
</div>
<div id="conf-collapsible-desc-20" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The name of a resource on the server that is to be associated with a given path</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30638">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__NAME</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30638" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-paths"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-paths"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".paths</code></a></span></p>
</div>
<div id="conf-collapsible-desc-21" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>HTTP request paths that should be protected by the policy enforcer</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30639">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__PATHS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30639" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-methods-methods-method"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-methods-methods-method"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".methods."methods".method</code></a></span></p>
</div>
<div id="conf-collapsible-desc-22" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The name of the HTTP method</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30640">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__METHODS__METHODS__METHOD</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30640" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">required <span class="icon"><i class="fa fa-exclamation-circle" title="Configuration property is required"></i></span></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-methods-methods-scopes"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-methods-methods-scopes"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".methods."methods".scopes</code></a></span></p>
</div>
<div id="conf-collapsible-desc-23" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>An array of strings with the scopes associated with the method</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30641">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__METHODS__METHODS__SCOPES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30641" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">required <span class="icon"><i class="fa fa-exclamation-circle" title="Configuration property is required"></i></span></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-methods-methods-scopes-enforcement-mode"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-methods-methods-scopes-enforcement-mode"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".methods."methods".scopes-enforcement-mode</code></a></span></p>
</div>
<div id="conf-collapsible-desc-24" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>A string referencing the enforcement mode for the scopes associated with a method</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30642">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__METHODS__METHODS__SCOPES_ENFORCEMENT_MODE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30642" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>all</code>, <code>any</code>, <code>disabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>all</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-enforcement-mode"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-enforcement-mode"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".enforcement-mode</code></a></span></p>
</div>
<div id="conf-collapsible-desc-25" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how policies are enforced</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30643">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__ENFORCEMENT_MODE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30643" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>permissive</code>, <code>enforcing</code>, <code>disabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>enforcing</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-claim-information-point-complex-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-claim-information-point-complex-config"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".claim-information-point."complex-config"</code></a></span></p>
</div>
<div id="conf-collapsible-desc-26" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Complex config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30644">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__CLAIM_INFORMATION_POINT__COMPLEX_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30644" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,Map&lt;String,String&gt;&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-claim-information-point-simple-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-claim-information-point-simple-config"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".claim-information-point."simple-config"</code></a></span></p>
</div>
<div id="conf-collapsible-desc-27" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Simple config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30645">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__CLAIM_INFORMATION_POINT__SIMPLE_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30645" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,String&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-path-cache-max-entries"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-path-cache-max-entries"><code>quarkus.keycloak."tenant".policy-enforcer.path-cache.max-entries</code></a></span></p>
</div>
<div id="conf-collapsible-desc-28" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Defines the limit of entries that should be kept in the cache</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30646">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATH_CACHE_MAX_ENTRIES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30646" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1000</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-path-cache-lifespan"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-path-cache-lifespan"><code>quarkus.keycloak."tenant".policy-enforcer.path-cache.lifespan</code></a></span></p>
</div>
<div id="conf-collapsible-desc-29" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Defines the time in milliseconds when the entry should be expired</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30647">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATH_CACHE_LIFESPAN</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30647" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>30000</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-lazy-load-paths"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-lazy-load-paths"><code>quarkus.keycloak."tenant".policy-enforcer.lazy-load-paths</code></a></span></p>
</div>
<div id="conf-collapsible-desc-30" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how the adapter should fetch the server for resources associated with paths in your application. If true, the policy enforcer is going to fetch resources on-demand accordingly with the path being requested</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30648">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_LAZY_LOAD_PATHS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30648" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc row-hidden odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-claim-information-point-complex-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-claim-information-point-complex-config"><code>quarkus.keycloak."tenant".policy-enforcer.claim-information-point."complex-config"</code></a></span></p>
</div>
<div id="conf-collapsible-desc-31" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Complex config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30649">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_CLAIM_INFORMATION_POINT__COMPLEX_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30649" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,Map&lt;String,String&gt;&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc row-hidden">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-claim-information-point-simple-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-claim-information-point-simple-config"><code>quarkus.keycloak."tenant".policy-enforcer.claim-information-point."simple-config"</code></a></span></p>
</div>
<div id="conf-collapsible-desc-32" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Simple config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30650">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_CLAIM_INFORMATION_POINT__SIMPLE_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30650" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,String&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc row-hidden odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-http-method-as-scope"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-http-method-as-scope"><code>quarkus.keycloak."tenant".policy-enforcer.http-method-as-scope</code></a></span></p>
</div>
<div id="conf-collapsible-desc-33" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how scopes should be mapped to HTTP methods. If set to true, the policy enforcer will use the HTTP method from the current request to check whether access should be granted</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-30651">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_HTTP_METHOD_AS_SCOPE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-30651" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="references"><a class="anchor" href="#references"></a>References</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://www.keycloak.org/documentation.html">Keycloak documentation</a></p>
</li>
<li>
<p><a href="https://www.keycloak.org/docs/latest/authorization_services/index.html">Keycloak Authorization Services</a></p>
</li>
<li>
<p><a href="https://openid.net/connect/">OpenID Connect</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7519">JSON Web Token</a></p>
</li>
<li>
<p><a href="security-overview">Quarkus Security overview</a></p>
</li>
<li>
<p><a href="security-keycloak-admin-client">Quarkus Keycloak Admin Client</a></p>
</li>
</ul>
</div>
</div>
</div>
    </div>
    <div class="grid__item width-4-12 width-12-12-m tocwrapper">
      <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#solution">Solution</a></li>
<li><a href="#creating-the-project">Creating the project</a>
<ul class="sectlevel2">
<li><a href="#configuring-the-application">Configuring the application</a></li>
</ul>
</li>
<li><a href="#starting-and-configuring-the-keycloak-server">Starting and configuring the Keycloak server</a></li>
<li><a href="#keycloak-dev-mode">Running the application in dev mode</a></li>
<li><a href="#running-the-application-in-jvm-mode">Running the application in JVM mode</a></li>
<li><a href="#running-the-application-in-native-mode">Running the application in native mode</a></li>
<li><a href="#testing">Testing the application</a></li>
<li><a href="#injecting-the-authorization-client">Injecting the authorization client</a></li>
<li><a href="#mapping-protected-resources">Mapping protected resources</a></li>
<li><a href="#more-about-configuring-protected-resources">More about configuring protected resources</a></li>
<li><a href="#access-to-public-resources">Access to public resources</a></li>
<li><a href="#checking-permission-scopes-programmatically">Checking permission scopes programmatically</a></li>
<li><a href="#multi-tenancy">Multi-tenancy</a></li>
<li><a href="#dynamic-tenant-configuration-resolution">Dynamic tenant configuration resolution</a></li>
<li><a href="#configuration-reference">Configuration reference</a></li>
<li><a href="#references">References</a></li>
</ul></div>
    </div>
  </div>
  <h2>Related content</h2>
  <div class="grid-wrapper relations">
    <div class="grid__item width-6-12 width-12-12-m">
      <h3>On the same extensions</h3>
      <ul class="related-content">
      
        
        <li class="concepts"><a href="/version/3.15/guides/security-openid-connect-providers">Configuring Well-Known OpenID Connect Providers</a></li>
      
        
        <li class="howto"><a href="/version/3.15/guides/security-openid-connect-dev-services">Dev Services and Dev UI for OpenID Connect (OIDC)</a></li>
      
        
        <li class="concepts"><a href="/version/3.15/guides/security-oidc-bearer-token-authentication">OpenID Connect (OIDC) Bearer token authentication</a></li>
      
        
        <li class="reference"><a href="/version/3.15/guides/security-oidc-configuration-properties-reference">OpenID Connect (OIDC) configuration properties</a></li>
      
        
        <li class="concepts"><a href="/version/3.15/guides/security-oidc-code-flow-authentication">OpenID Connect authorization code flow mechanism for protecting web applications</a></li>
      
        
        <li class="tutorial"><a href="/version/3.15/guides/security-oidc-bearer-token-authentication-tutorial">Protect a service application by using OpenID Connect (OIDC) Bearer token authentication</a></li>
      
        
        <li class="tutorial"><a href="/version/3.15/guides/security-oidc-code-flow-authentication-tutorial">Protect a web application by using OpenID Connect (OIDC) authorization code flow</a></li>
      
        
        <li class="howto"><a href="/version/3.15/guides/security-openid-connect-multitenancy">Using OpenID Connect (OIDC) multitenancy</a></li>
      </ul>
    </div>
    <div class="grid__item width-6-12 width-12-12-m">
      <h3>On the same topics</h3>
      <ul class="related-content">
      
        
        <li class="guide"><a href="/version/3.15/guides/security-keycloak-admin-client">Using Keycloak Admin Client</a></li>
      
        
        <li class="concepts"><a href="/version/3.15/guides/security-oidc-bearer-token-authentication">OpenID Connect (OIDC) Bearer token authentication</a></li>
      
        
        <li class="concepts"><a href="/version/3.15/guides/security-oidc-code-flow-authentication">OpenID Connect authorization code flow mechanism for protecting web applications</a></li>
      
        
        <li class="tutorial"><a href="/version/3.15/guides/security-oidc-bearer-token-authentication-tutorial">Protect a service application by using OpenID Connect (OIDC) Bearer token authentication</a></li>
      
        
        <li class="tutorial"><a href="/version/3.15/guides/security-oidc-code-flow-authentication-tutorial">Protect a web application by using OpenID Connect (OIDC) authorization code flow</a></li>
      
        
        <li class="howto"><a href="/version/3.15/guides/security-openid-connect-dev-services">Dev Services and Dev UI for OpenID Connect (OIDC)</a></li>
      
        
        <li class="concepts"><a href="/version/3.15/guides/security-authentication-mechanisms">Authentication mechanisms in Quarkus</a></li>
      
        
        <li class="reference"><a href="/version/3.15/guides/security-authorize-web-endpoints-reference">Authorization of web endpoints</a></li>
      
        
        <li class="concepts"><a href="/version/3.15/guides/security-basic-authentication">Basic authentication</a></li>
      
        
        <li class="concepts"><a href="/version/3.15/guides/security-openid-connect-providers">Configuring Well-Known OpenID Connect Providers</a></li>
      
        
        <li class="howto"><a href="/version/3.15/guides/security-basic-authentication-howto">Enable Basic authentication</a></li>
      
        
        <li class="tutorial"><a href="/version/3.15/guides/security-getting-started-tutorial">Getting started with Security by using Basic authentication and Jakarta Persistence</a></li>
      
        
        <li class="reference"><a href="/version/3.15/guides/security-openid-connect-client-reference">OpenID Connect (OIDC) and OAuth2 client and filters</a></li>
      
        
        <li class="reference"><a href="/version/3.15/guides/security-oidc-configuration-properties-reference">OpenID Connect (OIDC) configuration properties</a></li>
      
        
        <li class="tutorial"><a href="/version/3.15/guides/security-openid-connect-client">OpenID Connect client and token propagation quickstart</a></li>
      
        
        <li class="concepts"><a href="/version/3.15/guides/security-proactive-authentication">Proactive authentication</a></li>
      
        
        <li class="howto"><a href="/version/3.15/guides/security-openid-connect-multitenancy">Using OpenID Connect (OIDC) multitenancy</a></li>
      
        
        <li class="guide"><a href="/version/3.15/guides/security-webauthn">Using Security with WebAuthn</a></li>
      
        
        <li class="guide"><a href="/version/3.15/guides/security-jwt-build">Build, Sign and Encrypt JSON Web Tokens</a></li>
      
        
        <li class="guide"><a href="/version/3.15/guides/security-csrf-prevention">Cross-Site Request Forgery Prevention</a></li>
      </ul>
    </div>
    </div>
  </div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license.<br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>GitHub Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links">
          
          
            <li><a href="/" target="_blank">Home</a></li>
          
          
          
            <li><a href="/about" target="_blank">About</a></li>
          
          
          
            <li><a href="/blog" target="_blank">Blog</a></li>
          
          
          
            <li><a href="/insights" target="_blank">Podcast</a></li>
          
          
          
            <li><a href="/events" target="_blank">Events</a></li>
          
          
          
            <li><a href="/newsletter" target="_blank">Newsletter</a></li>
          
          
          
            <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" target="_blank">Roadmap</a></li>
          
          
          
            <li><a href="/security" target="_blank">Security&nbsp;policy</a></li>
          
          
          
            <li><a href="/usage" target="_blank">Usage</a></li>
          
          
          
            <li><a href="/brand" target="_blank">Brand</a></li>
          
          
          
            <li><a href="/desktopwallpapers" target="_blank">Wallpapers</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Follow Us</span>
        <ul class="footer-links">
          
          
            <li><a href="https://x.com/quarkusio" target="_blank">X</a></li>
          
          
          
            <li><a rel="me" href="https://fosstodon.org/@quarkusio" target="_blank">Mastodon</a></li>
            
          
          
            <li><a href="https://www.facebook.com/quarkusio" target="_blank">Facebook</a></li>
          
          
          
            <li><a href="https://www.linkedin.com/company/quarkusio/" target="_blank">Linkedin</a></li>
          
          
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg" target="_blank">Youtube</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio" target="_blank">GitHub</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links">
          
          
            <li><a href="/support" target="_blank">Support</a></li>
          
          
          
            <li><a href="/guides" target="_blank">Guides</a></li>
          
          
          
            <li><a href="/faq" target="_blank">FAQ</a></li>
          
          
          
            <li><a href="/get-started" target="_blank">Get Started</a></li>
          
          
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus" target="_blank">Stack Overflow</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions" target="_blank">Discussions</a></li>
          
          
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev" target="_blank">Development mailing list</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Languages</span>
        <ul class="footer-links">
          
          
            <li><a href="https://quarkus.io/" target="_blank">English</a></li>
          
          
          
            <li><a href="https://pt.quarkus.io/" target="_blank">Português&nbsp;(Brasileiro)</a></li>
          
          
          
            <li><a href="https://es.quarkus.io/" target="_blank">Español</a></li>
          
          
          
            <li><a href="https://cn.quarkus.io/" target="_blank">简体中文</a></li>
          
          
          
            <li><a href="https://ja.quarkus.io/" target="_blank">日本語</a></li>
          
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a blah href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a blah href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a blah href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a blah href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a blah href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a blah href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a blah href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a blah href="https://code.quarkus.io/" target="_blank">And many more...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
  <script src="/assets/javascript/future-date.js" type="text/javascript"></script>
</body>

</html>
