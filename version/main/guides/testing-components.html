<!DOCTYPE html>
<html lang="en">







<head>
  <title>Testing components - main - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://analytics.ossupstream.org/ https://search.quarkus.io https://smetrics.redhat.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      js.bizographics.com
      https://www.redhat.com
      https://static.redhat.com
      https://app.requestly.io/
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://giscus.app
      https://analytics.ossupstream.org/
      https://app.mailjet.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net https://www.youtube.com https://player.restream.io https://app.mailjet.com http://xy0p2.mjt.lu https://mj.quarkus.io https://giscus.app; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/version/main/guides/testing-components" />
  <meta property="og:title" content="Testing components - main" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/testing-components">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="en" href="https://quarkus.io/version/main/guides/testing-components" />
  
  <link rel="alternate" hreflang="pt-br" href="https://pt.quarkus.io/version/main/guides/testing-components" />
  
  <link rel="alternate" hreflang="es" href="https://es.quarkus.io/version/main/guides/testing-components" />
  
  <link rel="alternate" hreflang="zh" href="https://cn.quarkus.io/version/main/guides/testing-components" />
  
  <link rel="alternate" hreflang="ja" href="https://ja.quarkus.io/version/main/guides/testing-components" />
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />  
  <script src="/assets/javascript/tracking.js"></script>
  
  <script src="/assets/javascript/colormode.js" type="text/javascript"></script>

</head>

<body class="guides">

  
  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
        <div class="logo-wrapper">
           <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/about/">Why<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">WHAT IS QUARKUS?</a></li>
          <li><a href="/developer-joy" class="">DEVELOPER JOY</a></li>
          <li><a href="/performance" class="">PERFORMANCE</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">STANDARDS</a></li>
          <li><a href="/versatility" class="">VERSATILITY</a></li>
          <li><a href="/container-first" class="">CONTAINER FIRST</a></li>          
        </ul>
      </li>
      <li class="dropdown">
        <span href="/learn/">Learn<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">GET STARTED</a></li>
          <li><a href="/guides" class="active">DOCUMENTATION</a></li>
          <li><a href="/userstories/" class="">USER STORIES</a></li>  
          <li><a href="/qtips" class="">"Q" TIP VIDEOS</a></li>          
          <li><a href="/books" class="">BOOKS</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="https://quarkus.io/extensions/">Extensions<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <!-- Note that quarkus.io is hardcoded here, because it is the only url which supports extensions -->
          <li><a href="https://quarkus.io/extensions/" class="">BROWSE EXTENSIONS</a></li>
          <li><a href="/faq/#what-is-a-quarkus-extension" class="">USE EXTENSIONS</a></li>
          <li><a href="/guides/writing-extensions" class="">CREATE EXTENSIONS</a></li>
          <li><a href="https://hub.quarkiverse.io" class="">SHARE EXTENSIONS</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/community/">Community<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">SUPPORT</a></li>
          <li><a href="/blog" class="">BLOG</a></li>
          <li><a href="/discussion" class="">DISCUSSION</a></li>
          <li><a href="/working-groups" class="">WORKING GROUPS</a></li>
          <li><a href="/insights" class="">PODCAST</a></li>
          <li><a href="/events" class="">EVENTS</a></li>
          <li><a href="/newsletter" class="">NEWSLETTER</a></li>
          <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" class="">ROADMAP</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary white">START CODING</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/version/main/guides/testing-components" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://pt.quarkus.io/version/main/guides/testing-components">PORTUGUÊS (BR)</a></li>
          <li><a href="https://es.quarkus.io/version/main/guides/testing-components">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/version/main/guides/testing-components">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/version/main/guides/testing-components">日本語</a></li>
          </ul>
      </li>
      <li>
        <span href="#" class="modeswitcher" id='theme-toggle'><i class="fas fa-sun"></i><i class="fas fa-moon"></i><i class="fas fa-cog"></i></span>
      </li>
    </ul>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    







<section class="full-width-version-bg flexfilterbar guides">
  <div class="guideflexcontainer">
    <div class="docslink">
      <a class="returnlink" href="/version/main/guides/"> Back to Guides</a>
    </div>
    <div class="flexlabel">
      <label>By Version</label>
    </div>
    <div class="guidepulldown version">
    <select id="guide-version-dropdown">
      
        
        
        <option value="main" selected>Main - SNAPSHOT</option>
        
        
        
        <option value="latest" >3.23.4 - Latest</option>
        
        
        
        <option value="3.20" >3.20</option>
        
        
        
        <option value="3.15" >3.15</option>
        
        
        
        
        
        
        
        
        
        
        
        
        </select>
    </div>
  </div>
</section>

<div class="guide">
  <div class="grid-wrapper">
    <div class="grid__item width-8-12 width-12-12-m">
      
      <a class="editlink" href="https://github.com/quarkusio/quarkus/edit/main/docs/src/main/asciidoc/testing-components.adoc">Edit this Page</a>
      
      <h1 class="text-caps">Testing components </h1>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The component model of Quarkus is built on top <a href="cdi-reference">CDI</a>.
Therefore, Quarkus provides <code>QuarkusComponentTestExtension</code> - a JUnit extension that makes it easy to test the components/CDI beans and mock their dependencies.
Unlike <code>@QuarkusTest</code> this extension does not start a full Quarkus application but merely the CDI container and the configuration service.
You can find more details in the <a href="#lifecycle">Lifecycle</a> section.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
This extension is available in the <code>quarkus-junit5-component</code> dependency.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="basic-example"><a class="anchor" href="#basic-example"></a>1. Basic example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s have a component <code>Foo</code> - a CDI bean with two injection points.</p>
</div>
<div class="listingblock">
<div class="title"><code>Foo</code> component</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme;

import jakarta.enterprise.context.ApplicationScoped;
import jakarta.inject.Inject;

@ApplicationScoped <i class="conum" data-value="1"></i><b>(1)</b>
public class Foo {

    @Inject
    Charlie charlie; <i class="conum" data-value="2"></i><b>(2)</b>

    @ConfigProperty(name = "bar")
    boolean bar; <i class="conum" data-value="3"></i><b>(3)</b>

    public String ping() {
        return bar ? charlie.ping() : "nok";
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>Foo</code> is an <code>@ApplicationScoped</code> CDI bean.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>Foo</code> depends on <code>Charlie</code> which declares a method <code>ping()</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>Foo</code> depends on the config property <code>bar</code>. <code>@Inject</code> is not needed for this injection point because it also declares a CDI qualifier - this is a Quarkus-specific feature.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then a component test could look like:</p>
</div>
<div class="listingblock">
<div class="title">Simple component test</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import static org.junit.jupiter.api.Assertions.assertEquals;

import jakarta.inject.Inject;
import io.quarkus.test.InjectMock;
import io.quarkus.test.component.TestConfigProperty;
import io.quarkus.test.component.QuarkusComponentTest;
import org.junit.jupiter.api.Test;
import org.mockito.Mockito;

@QuarkusComponentTest <i class="conum" data-value="1"></i><b>(1)</b>
@TestConfigProperty(key = "bar", value = "true") <i class="conum" data-value="2"></i><b>(2)</b>
public class FooTest {

    @Inject
    Foo foo; <i class="conum" data-value="3"></i><b>(3)</b>

    @InjectMock
    Charlie charlieMock; <i class="conum" data-value="4"></i><b>(4)</b>

    @Test
    public void testPing() {
        Mockito.when(charlieMock.ping()).thenReturn("OK"); <i class="conum" data-value="5"></i><b>(5)</b>
        assertEquals("OK", foo.ping());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>QuarkusComponentTest</code> annotation registers the JUnit extension.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Sets a configuration property for the test.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The test injects the component under the test. The types of all fields annotated with <code>@Inject</code> are considered the component types under test. You can also specify additional component classes via <code>@QuarkusComponentTest#value()</code>. Furthermore, the static nested classes declared on the test class are components too.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The test also injects a mock for <code>Charlie</code>. <code>Charlie</code> is an <em>unsatisfied</em> dependency for which a synthetic <code>@Singleton</code> bean is registered automatically. The injected reference is an "unconfigured" Mockito mock.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We can leverage the Mockito API in a test method to configure the behavior.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>QuarkusComponentTestExtension</code> also resolves parameters of test methods and injects matching beans.</p>
</div>
<div class="paragraph">
<p>So the code snippet above can be rewritten as:</p>
</div>
<div class="listingblock">
<div class="title">Simple component test with test method parameters</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import static org.junit.jupiter.api.Assertions.assertEquals;

import jakarta.inject.Inject;
import io.quarkus.test.InjectMock;
import io.quarkus.test.component.TestConfigProperty;
import io.quarkus.test.component.QuarkusComponentTest;
import org.junit.jupiter.api.Test;
import org.mockito.Mockito;

@QuarkusComponentTest
@TestConfigProperty(key = "bar", value = "true")
public class FooTest {

    @Test
    public void testPing(Foo foo, @InjectMock Charlie charlieMock) { <i class="conum" data-value="1"></i><b>(1)</b>
        Mockito.when(charlieMock.ping()).thenReturn("OK");
        assertEquals("OK", foo.ping());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Parameters annotated with <code>@io.quarkus.test.component.SkipInject</code> are never resolved by this extension.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Furthermore, if you need the full control over the <code>QuarkusComponentTestExtension</code> configuration then you can use the <code>@RegisterExtension</code> annotation and configure the extension programmatically.</p>
</div>
<div class="paragraph">
<p>The original test could be rewritten like:</p>
</div>
<div class="listingblock">
<div class="title">Simple component test with programmatic configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import static org.junit.jupiter.api.Assertions.assertEquals;

import jakarta.inject.Inject;
import io.quarkus.test.InjectMock;
import io.quarkus.test.component.QuarkusComponentTestExtension;
import org.junit.jupiter.api.Test;
import org.mockito.Mockito;

public class FooTest {

    @RegisterExtension <i class="conum" data-value="1"></i><b>(1)</b>
    static final QuarkusComponentTestExtension extension = QuarkusComponentTestExtension.builder().configProperty("bar","true").build();

    @Inject
    Foo foo;

    @InjectMock
    Charlie charlieMock;

    @Test
    public void testPing() {
        Mockito.when(charlieMock.ping()).thenReturn("OK");
        assertEquals("OK", foo.ping());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>QuarkusComponentTestExtension</code> is configured in a static field of the test class.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lifecycle"><a class="anchor" href="#lifecycle"></a>2. Lifecycle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>So what exactly does the <code>QuarkusComponentTest</code> do?
It starts the CDI container and registers a dedicated <a href="config-reference">configuration object</a>.</p>
</div>
<div class="paragraph">
<p>If the test instance lifecycle is <code>Lifecycle#PER_METHOD</code> (default) then the container is started during the <code>before each</code> test phase and stopped during the <code>after each</code> test phase.
However, if  the test instance lifecycle is <code>Lifecycle#PER_CLASS</code> then the container is started during the <code>before all</code> test phase and stopped during the <code>after all</code> test phase.</p>
</div>
<div class="paragraph">
<p>The fields annotated with <code>@Inject</code> and <code>@InjectMock</code> are injected after a test instance is created.
The parameters of a test method for which a matching bean exists are resolved (unless annotated with <code>@io.quarkus.test.component.SkipInject</code> or <code>@org.mockito.Mock</code>) when a test method is executed.
Finally, the CDI request context is activated and terminated per each test method.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="injection"><a class="anchor" href="#injection"></a>3. Injection</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Fields of the test class that are annotated with <code>@jakarta.inject.Inject</code> and <code>@io.quarkus.test.InjectMock</code> are injected after a test instance is created.
Furthermore, the parameters of a test method for which a matching bean exists are resolved unless annotated with <code>@io.quarkus.test.component.SkipInject</code> or <code>@org.mockito.Mock</code>.
There are also some JUnit built-in parameters, such as <code>RepetitionInfo</code> and <code>TestInfo</code>, which are skipped automatically.</p>
</div>
<div class="paragraph">
<p>An <code>@Inject</code> injection point receives the contextual instance of a CDI bean - the real component under test.
An <code>@InjectMock</code> injection point receives an "unconfigured" Mockito mock that was created for an <a href="#auto_mocking">unsatisfied dependency automatically</a>.</p>
</div>
<div class="paragraph">
<p>Dependent beans injected into the fields and test method arguments are correctly destroyed before a test instance is destroyed and after the test method completes, respectively.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Arguments of a <code>@ParameterizedTest</code> method that are provided by an <code>ArgumentsProvider</code>, for example with <code>@org.junit.jupiter.params.provider.ValueArgumentsProvider</code>, must be annotated with <code>@SkipInject</code>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="tested-components"><a class="anchor" href="#tested-components"></a>3.1. Tested components</h3>
<div class="paragraph">
<p>The initial set of tested components is derived from the test class:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The types of all fields annotated with <code>@jakarta.inject.Inject</code> are considered the component types.</p>
</li>
<li>
<p>The types of test methods parameters that are not annotated with <code>@InjectMock</code>, <code>@SkipInject</code>, or <code>@org.mockito.Mock</code> are also considered the component types.</p>
</li>
<li>
<p>If <code>@QuarkusComponentTest#addNestedClassesAsComponents()</code> is set to <code>true</code> (default) then all static nested classes declared on the test class are components too.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@Inject Instance&lt;T&gt;</code> and <code>@Inject @All List&lt;T&gt;</code> injection points are handled specifically. The actual type argument is registered as a component. However, if the type argument is an interface the implementations <em>are not registered</em> automatically.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Additional component classes can be set using <code>@QuarkusComponentTest#value()</code> or <code>QuarkusComponentTestExtensionBuilder#addComponentClasses()</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="auto_mocking"><a class="anchor" href="#auto_mocking"></a>3.2. Auto Mocking Unsatisfied Dependencies</h3>
<div class="paragraph">
<p>Unlike in regular CDI environments the test does not fail if a component injects an unsatisfied dependency.
Instead, a synthetic bean is registered automatically for each combination of required type and qualifiers of an injection point that resolves to an unsatisfied dependency.
The bean has the <code>@Singleton</code> scope so it&#8217;s shared across all injection points with the same required type and qualifiers.
The injected reference is an <em>unconfigured</em> Mockito mock.
You can inject the mock in your test using the <code>io.quarkus.test.InjectMock</code> annotation and leverage the Mockito API to configure the behavior.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>@InjectMock</code> is not intended as a universal replacement for functionality provided by the Mockito JUnit extension.
It&#8217;s meant to be used for configuration of unsatisfied dependencies of CDI beans.
You can use the <code>QuarkusComponentTest</code> and <code>MockitoExtension</code> side by side.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.mockito.Mock;
import org.mockito.Mockito;
import org.mockito.junit.jupiter.MockitoExtension;

@ExtendWith(MockitoExtension.class)
@QuarkusComponentTest
public class FooTest {

    @TestConfigProperty(key = "bar", value = "true")
    @Test
    public void testPing(Foo foo, @InjectMock Charlie charlieMock, @Mock Ping ping) {
        Mockito.when(ping.pong()).thenReturn("OK");
        Mockito.when(charlieMock.ping()).thenReturn(ping);
        assertEquals("OK", foo.ping());
    }
}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="custom-mocks-for-unsatisfied-dependencies"><a class="anchor" href="#custom-mocks-for-unsatisfied-dependencies"></a>3.3. Custom Mocks For Unsatisfied Dependencies</h3>
<div class="paragraph">
<p>Sometimes you need the full control over the bean attributes and maybe even configure the default mock behavior.
You can use the mock configurator API via the <code>QuarkusComponentTestExtensionBuilder#mock()</code> method.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="nested-tests"><a class="anchor" href="#nested-tests"></a>4. Nested Tests</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JUnit 5 <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-nested">@Nested tests</a> may help to structure more complex test scenarios.
However, only basic use cases are tested with <code>@QuarkusComponentTest</code>.</p>
</div>
<div class="listingblock">
<div class="title">Nested test</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import static org.junit.jupiter.api.Assertions.assertEquals;

import jakarta.inject.Inject;
import io.quarkus.test.InjectMock;
import io.quarkus.test.component.TestConfigProperty;
import io.quarkus.test.component.QuarkusComponentTest;
import org.junit.jupiter.api.Test;
import org.mockito.Mockito;

@QuarkusComponentTest <i class="conum" data-value="1"></i><b>(1)</b>
@TestConfigProperty(key = "bar", value = "true") <i class="conum" data-value="2"></i><b>(2)</b>
public class FooTest {

    @Inject
    Foo foo; <i class="conum" data-value="3"></i><b>(3)</b>

    @InjectMock
    Charlie charlieMock; <i class="conum" data-value="4"></i><b>(4)</b>

    @Nested
    class PingTest {

       @Test
       public void testPing() {
          Mockito.when(charlieMock.ping()).thenReturn("OK");
          assertEquals("OK", foo.ping());
       }
    }

    @Nested
    class PongTest {

       @Test
       public void testPong() {
          Mockito.when(charlieMock.pong()).thenReturn("NOK");
          assertEquals("NOK", foo.pong());
       }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>QuarkusComponentTest</code> annotation registers the JUnit extension.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Sets a configuration property for the test.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The test injects the component under the test. <code>Foo</code> injects <code>Charlie</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The test also injects a mock for <code>Charlie</code>. The injected reference is an "unconfigured" Mockito mock.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a>5. Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can set the configuration properties for a test with the <code>@io.quarkus.test.component.TestConfigProperty</code> annotation or with the <code>QuarkusComponentTestExtensionBuilder#configProperty(String, String)</code> method.
If you only need to use the default values for missing config properties, then the <code>@QuarkusComponentTest#useDefaultConfigProperties()</code> or <code>QuarkusComponentTestExtensionBuilder#useDefaultConfigProperties()</code> might come in useful.</p>
</div>
<div class="paragraph">
<p>It is also possible to set configuration properties for a test method with the <code>@io.quarkus.test.component.TestConfigProperty</code> annotation.
However, if the test instance lifecycle is <code>Lifecycle#_PER_CLASS</code> this annotation can only be used on the test class and is ignored on test methods.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@io.quarkus.test.component.TestConfigProperty</code> declared on a <code>@Nested</code> test class is always ignored.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>CDI beans are also automatically registered for all injected <a href="https://smallrye.io/smallrye-config/Main/config/mappings/">Config Mappings</a>. The mappings are populated with the test configuration properties.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mocking-cdi-interceptors"><a class="anchor" href="#mocking-cdi-interceptors"></a>6. Mocking CDI Interceptors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If a tested component class declares an interceptor binding then you might need to mock the interception too.
There are two ways to accomplish this task.
First, you can define an interceptor class as a static nested class of the test class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import static org.junit.jupiter.api.Assertions.assertEquals;

import jakarta.inject.Inject;
import io.quarkus.test.component.QuarkusComponentTest;
import org.junit.jupiter.api.Test;

@QuarkusComponentTest
public class FooTest {

    @Inject
    Foo foo;

    @Test
    public void testPing() {
        assertEquals("OK", foo.ping());
    }

    @ApplicationScoped
    static class Foo {

       @SimpleBinding <i class="conum" data-value="1"></i><b>(1)</b>
       String ping() {
         return "ok";
       }

    }

    @SimpleBinding
    @Interceptor
    static class SimpleInterceptor { <i class="conum" data-value="2"></i><b>(2)</b>

        @AroundInvoke
        Object aroundInvoke(InvocationContext context) throws Exception {
            return context.proceed().toString().toUpperCase();
        }

    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@SimpleBinding</code> is an interceptor binding.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The interceptor class is automatically considered a tested component.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Static nested classes declared on a test class that is annotated with <code>@QuarkusComponentTest</code> are excluded from bean discovery when running a <code>@QuarkusTest</code> in order to prevent unintentional CDI conflicts.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The second option is to declare an interceptor method directly in the test class; the method is then invoked in the relevant interception phase.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import static org.junit.jupiter.api.Assertions.assertEquals;

import jakarta.inject.Inject;
import io.quarkus.test.component.QuarkusComponentTest;
import org.junit.jupiter.api.Test;

@QuarkusComponentTest
public class FooTest {

    @Inject
    Foo foo;

    @Test
    public void testPing() {
        assertEquals("OK", foo.ping());
    }

    @SimpleBinding <i class="conum" data-value="1"></i><b>(1)</b>
    @AroundInvoke <i class="conum" data-value="2"></i><b>(2)</b>
    Object aroundInvoke(InvocationContext context) throws Exception {
       return context.proceed().toString().toUpperCase();
    }

    @ApplicationScoped
    static class Foo {

       @SimpleBinding <i class="conum" data-value="1"></i><b>(1)</b>
       String ping() {
         return "ok";
       }

    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The interceptor bindings of the resulting interceptor are specified by annotating the method with the interceptor binding types.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Defines the interception type.</td>
</tr>
</table>
</div>
</div>
</div>
    </div>
    <div class="grid__item width-4-12 width-12-12-m tocwrapper">
      <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#basic-example">1. Basic example</a></li>
<li><a href="#lifecycle">2. Lifecycle</a></li>
<li><a href="#injection">3. Injection</a>
<ul class="sectlevel2">
<li><a href="#tested-components">3.1. Tested components</a></li>
<li><a href="#auto_mocking">3.2. Auto Mocking Unsatisfied Dependencies</a></li>
<li><a href="#custom-mocks-for-unsatisfied-dependencies">3.3. Custom Mocks For Unsatisfied Dependencies</a></li>
</ul>
</li>
<li><a href="#nested-tests">4. Nested Tests</a></li>
<li><a href="#configuration">5. Configuration</a></li>
<li><a href="#mocking-cdi-interceptors">6. Mocking CDI Interceptors</a></li>
</ul></div>
    </div>
  </div>
  <h2>Related content</h2>
  <div class="grid-wrapper relations">
    <div class="grid__item width-6-12 width-12-12-m">
      <h3>On the same topics</h3>
      <ul class="related-content">
      
        
        <li class="guide"><a href="/version/main/guides/continuous-testing">Continuous Testing</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/tests-with-coverage">Measuring the coverage of your tests</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/getting-started-testing">Testing Your Application</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/cli-tooling">Building Quarkus apps with Quarkus Command Line Interface (CLI)</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/compose-dev-services">Compose Dev Services</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/upx">Compressing native executables using UPX</a></li>
      
        
        <li class="howto"><a href="/version/main/guides/security-openid-connect-dev-services">Dev Services and Dev UI for OpenID Connect (OIDC)</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/amqp-dev-services">Dev Services for AMQP</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/apicurio-registry-dev-services">Dev Services for Apicurio Registry</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/databases-dev-services">Dev Services for Databases</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/elasticsearch-dev-services">Dev Services for Elasticsearch</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/infinispan-dev-services">Dev Services for Infinispan</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/kafka-dev-services">Dev Services for Kafka</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/kubernetes-dev-services">Dev Services for Kubernetes</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/pulsar-dev-services">Dev Services for Pulsar</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/rabbitmq-dev-services">Dev Services for RabbitMQ</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/redis-dev-services">Dev Services for Redis</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/dev-services">Dev Services Overview</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/dev-ui">Dev UI</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/jreleaser">Packaging And Releasing With JReleaser</a></li>
      </ul>
    </div>
    </div>
  </div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license.<br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>GitHub Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links">
          
          
            <li><a href="/" target="_blank">Home</a></li>
          
          
          
            <li><a href="/about" target="_blank">About</a></li>
          
          
          
            <li><a href="/blog" target="_blank">Blog</a></li>
          
          
          
            <li><a href="/insights" target="_blank">Podcast</a></li>
          
          
          
            <li><a href="/events" target="_blank">Events</a></li>
          
          
          
            <li><a href="/newsletter" target="_blank">Newsletter</a></li>
          
          
          
            <li><a href="/userstories" target="_blank">User Stories</a></li>
          
          
          
            <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" target="_blank">Roadmap</a></li>
          
          
          
            <li><a href="/security" target="_blank">Security&nbsp;policy</a></li>
          
          
          
            <li><a href="/usage" target="_blank">Usage</a></li>
          
          
          
            <li><a href="/brand" target="_blank">Brand</a></li>
          
          
          
            <li><a href="/desktopwallpapers" target="_blank">Wallpapers</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Follow Us</span>
        <ul class="footer-links">
          
          
            <li><a href="https://x.com/quarkusio" target="_blank">X</a></li>
          
          
          
            <li><a href="https://bsky.app/profile/quarkus.io" target="_blank">Bluesky</a></li>
          
          
          
            <li><a rel="me" href="https://fosstodon.org/@quarkusio" target="_blank">Mastodon</a></li>
            
          
          
            <li><a href="https://www.facebook.com/quarkusio" target="_blank">Facebook</a></li>
          
          
          
            <li><a href="https://www.linkedin.com/company/quarkusio/" target="_blank">Linkedin</a></li>
          
          
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg" target="_blank">Youtube</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio" target="_blank">GitHub</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links">
          
          
            <li><a href="/support" target="_blank">Support</a></li>
          
          
          
            <li><a href="/guides" target="_blank">Guides</a></li>
          
          
          
            <li><a href="/faq" target="_blank">FAQ</a></li>
          
          
          
            <li><a href="/get-started" target="_blank">Get Started</a></li>
          
          
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus" target="_blank">Stack Overflow</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions" target="_blank">Discussions</a></li>
          
          
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev" target="_blank">Development mailing list</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Languages</span>
        <ul class="footer-links">
          
          
            <li><a href="https://quarkus.io/" target="_blank">English</a></li>
          
          
          
            <li><a href="https://pt.quarkus.io/" target="_blank">Português&nbsp;(Brasileiro)</a></li>
          
          
          
            <li><a href="https://es.quarkus.io/" target="_blank">Español</a></li>
          
          
          
            <li><a href="https://cn.quarkus.io/" target="_blank">简体中文</a></li>
          
          
          
            <li><a href="https://ja.quarkus.io/" target="_blank">日本語</a></li>
          
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a blah href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a blah href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a blah href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a blah href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a blah href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a blah href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a blah href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a blah href="https://code.quarkus.io/" target="_blank">And many more...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
  <script src="/assets/javascript/future-date.js" type="text/javascript"></script>
</body>

</html>
