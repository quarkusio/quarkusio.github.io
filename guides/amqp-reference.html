<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide is the companion from the <a href="amqp">Getting Started with AMQP 1.0</a>.
It explains in more details the configuration and usage of the AMQP connector for reactive messaging.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
This documentation does not cover all the details of the connector.
Refer to the <a href="https://smallrye.io/smallrye-reactive-messaging">SmallRye Reactive Messaging website</a> for further details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The AMQP connector allows Quarkus applications to send and receive messages using the AMQP 1.0 protocol.
More details about the protocol can be found in <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-overview-v1.0-os.html">the AMQP 1.0 specification</a>.
It&#8217;s important to note that AMQP 1.0 and AMQP 0.9.1 (implemented by RabbitMQ) are incompatible.
Check <a href="#using-rabbitmq">Using RabbitMQ</a> to get more details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="amqp-connector-extension"><a class="anchor" href="#amqp-connector-extension"></a>AMQP connector extension</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use the connector, you need to add the <code>quarkus-smallrye-reactive-messaging-amqp</code> extension.</p>
</div>
<div class="paragraph">
<p>You can add the extension to your project using:</p>
</div>
<div class="paragraph">
<p>Unresolved directive in amqp-reference.adoc - include::{includes}/devtools/extension-add.adoc[]</p>
</div>
<div class="paragraph">
<p>Or just add the following dependency to your project:</p>
</div>
<div class="listingblock primary asciidoc-tabs-target-sync-cli asciidoc-tabs-target-sync-maven">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-smallrye-reactive-messaging-amqp&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-target-sync-gradle">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">implementation("io.quarkus:quarkus-smallrye-reactive-messaging-amqp")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once added to your project, you can map <em>channels</em> to AMQP addresses by configuring the <code>connector</code> attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># Inbound
mp.messaging.incoming.[channel-name].connector=smallrye-amqp

# Outbound
mp.messaging.outgoing.[channel-name].connector=smallrye-amqp</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Connector auto-attachment</div>
<div class="paragraph">
<p>If you have a single connector on your classpath, you can omit the <code>connector</code> attribute configuration.
Quarkus automatically associates <em>orphan</em> channels to the (unique) connector found on the classpath.
<em>Orphans</em> channels are outgoing channels without a downstream consumer or incoming channels without an upstream producer.</p>
</div>
<div class="paragraph">
<p>This auto-attachment can be disabled using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.reactive-messaging.auto-connector-attachment=false</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-the-amqp-broker-access"><a class="anchor" href="#configuring-the-amqp-broker-access"></a>Configuring the AMQP Broker access</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The AMQP connector connects to AMQP 1.0 brokers such as Apache ActiveMQ or Artemis.
To configure the location and credentials of the broker, add the following properties in the <code>application.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">amqp-host=amqp <i class="conum" data-value="1"></i><b>(1)</b>
amqp-port=5672 <i class="conum" data-value="2"></i><b>(2)</b>
amqp-username=my-username <i class="conum" data-value="3"></i><b>(3)</b>
amqp-password=my-password <i class="conum" data-value="4"></i><b>(4)</b>

mp.messaging.incoming.prices.connector=smallrye-amqp <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Configures the broker/router host name. You can do it per channel (using the <code>host</code> attribute) or globally using <code>amqp-host</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Configures the broker/router port. You can do it per channel (using the <code>port</code> attribute) or globally using <code>amqp-port</code>. The default is <code>5672</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Configures the broker/router username if required. You can do it per channel (using the <code>username</code> attribute) or globally using <code>amqp-username</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Configures the broker/router password if required. You can do it per channel (using the <code>password</code> attribute) or globally using <code>amqp-password</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Instructs the prices channel to be managed by the AMQP connector</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In dev mode and when running tests, <a href="amqp-dev-services">Dev Services for AMQP</a> automatically starts an AMQP broker.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="receiving-amqp-messages"><a class="anchor" href="#receiving-amqp-messages"></a>Receiving AMQP messages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s imagine your application receives <code>Message&lt;Double&gt;</code>.
You can consume the payload directly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package inbound;

import org.eclipse.microprofile.reactive.messaging.Incoming;

import jakarta.enterprise.context.ApplicationScoped;

@ApplicationScoped
public class AmqpPriceConsumer {

    @Incoming("prices")
    public void consume(double price) {
        // process your price.
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, you can retrieve the Message&lt;Double&gt;:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package inbound;

import org.eclipse.microprofile.reactive.messaging.Incoming;
import org.eclipse.microprofile.reactive.messaging.Message;

import jakarta.enterprise.context.ApplicationScoped;
import java.util.concurrent.CompletionStage;

@ApplicationScoped
public class AmqpPriceMessageConsumer {

    @Incoming("prices")
    public CompletionStage&lt;Void&gt; consume(Message&lt;Double&gt; price) {
        // process your price.

        // Acknowledge the incoming message, marking the AMQP message as `accepted`.
        return price.ack();
    }

}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="inbound-metadata"><a class="anchor" href="#inbound-metadata"></a>Inbound Metadata</h3>
<div class="paragraph">
<p>Messages coming from AMQP contain an instance of <code>IncomingAmqpMetadata</code> in the metadata.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Optional&lt;IncomingAmqpMetadata&gt; metadata = incoming.getMetadata(IncomingAmqpMetadata.class);
metadata.ifPresent(meta -&gt; {
    String address = meta.getAddress();
    String subject = meta.getSubject();
    boolean durable = meta.isDurable();
    // Use io.vertx.core.json.JsonObject
    JsonObject properties = meta.getProperties();
    // ...
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deserialization"><a class="anchor" href="#deserialization"></a>Deserialization</h3>
<div class="paragraph">
<p>The connector converts incoming AMQP Messages into Reactive Messaging <code>Message&lt;T&gt;</code> instances.
<code>T</code> depends on the <em>body</em> of the received AMQP Message.</p>
</div>
<div class="paragraph">
<p>The <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-types-v1.0-os.html">AMQP Type System</a> defines the supported types.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">AMQP Body Type</th>
<th class="tableblock halign-left valign-top"><code>&lt;T&gt;</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMQP Value containing a <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-types-v1.0-os.html#section-primitive-type-definitions">AMQP Primitive Type</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the corresponding Java type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMQP Value using the <code>Binary</code> type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte[]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMQP Sequence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMQP Data (with binary content) and the <code>content-type</code> is set to <code>application/json</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://vertx.io/docs/apidocs/io/vertx/core/json/JsonObject.html"><code>JsonObject</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMQP Data with a different <code>content-type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte[]</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If you send objects with this AMQP connector (outbound connector), it gets encoded as JSON and sent as binary.
The <code>content-type</code> is set to <code>application/json</code>.
So, you can rebuild the object as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.vertx.core.json.JsonObject;
//
@ApplicationScoped
public static class Consumer {

    List&lt;Price&gt; prices = new CopyOnWriteArrayList&lt;&gt;();

    @Incoming("from-amqp") <i class="conum" data-value="1"></i><b>(1)</b>
    public void consume(JsonObject p) {   <i class="conum" data-value="2"></i><b>(2)</b>
        Price price = p.mapTo(Price.class);  <i class="conum" data-value="3"></i><b>(3)</b>
        prices.add(price);
    }

    public List&lt;Price&gt; list() {
        return prices;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>Price</code> instances are automatically encoded to JSON by the connector</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>You can receive it using a <code>JsonObject</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Then, you can reconstruct the instance using the <code>mapTo</code> method</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>mapTo</code> method uses the Quarkus Jackson mapper. Check <a href="rest-json#json">this guide</a> to learn more about the mapper configuration.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="acknowledgement"><a class="anchor" href="#acknowledgement"></a>Acknowledgement</h3>
<div class="paragraph">
<p>When a Reactive Messaging Message associated with an AMQP Message is acknowledged, it informs the broker that the message has been <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-accepted">accepted</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="failure-management"><a class="anchor" href="#failure-management"></a>Failure Management</h3>
<div class="paragraph">
<p>If a message produced from an AMQP message is <em>nacked</em>, a failure strategy is applied.
The AMQP connector supports six strategies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>fail</code> - fail the application; no more AMQP messages will be processed (default).
The AMQP message is marked as rejected.</p>
</li>
<li>
<p><code>accept</code> - this strategy marks the AMQP message as <em>accepted</em>. The processing continues ignoring the failure.
Refer to the <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-accepted">accepted delivery state documentation</a>.</p>
</li>
<li>
<p><code>release</code> - this strategy marks the AMQP message as <em>released</em>. The processing continues with the next message. The broker can redeliver the message.
Refer to the <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-released">released delivery state documentation</a>.</p>
</li>
<li>
<p><code>reject</code> - this strategy marks the AMQP message as rejected. The processing continues with the next message.
Refer to the <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-rejected">rejected delivery state documentation</a>.</p>
</li>
<li>
<p><code>modified-failed</code> - this strategy marks the AMQP
message as <em>modified</em> and indicates that it failed (with the <code>delivery-failed</code> attribute). The processing continues with the next message, but the broker may attempt to redeliver the message.
Refer to the <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-modified">modified delivery state documentation</a></p>
</li>
<li>
<p><code>modified-failed-undeliverable-here</code> - this strategy marks the AMQP message as <em>modified</em> and indicates that it failed (with the <code>delivery-failed</code> attribute). It also indicates that the application cannot process the message, meaning that the broker will not attempt to redeliver the message to this node. The processing continues with the next message.
Refer to the <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-modified">modified delivery state documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sending-amqp-messages"><a class="anchor" href="#sending-amqp-messages"></a>Sending AMQP messages</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="serialization"><a class="anchor" href="#serialization"></a>Serialization</h3>
<div class="paragraph">
<p>When sending a <code>Message&lt;T&gt;</code>, the connector converts the message into an AMQP Message.
The payload is converted to the AMQP Message <em>body</em>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>T</code></th>
<th class="tableblock halign-left valign-top">AMQP Message Body</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">primitive types or <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMQP Value with the payload</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Instant</code> or <code>UUID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMQP Value using the corresponding AMQP Type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://vertx.io/docs/apidocs/io/vertx/core/json/JsonObject.html"><code>JsonObject</code></a> or <a href="https://vertx.io/docs/apidocs/io/vertx/core/json/JsonArray.html"><code>JsonArray</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMQP Data using a binary content. The <code>content-type</code> is set to <code>application/json</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io.vertx.mutiny.core.buffer.Buffer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMQP Data using a binary content. No <code>content-type</code> set</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any other class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The payload is converted to JSON (using a Json Mapper). The result is wrapped into AMQP Data using a <strong>binary</strong> content. The <code>content-type</code> is set to <code>application/json</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If the message payload cannot be serialized to JSON, the message is <em>nacked</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="outbound-metadata"><a class="anchor" href="#outbound-metadata"></a>Outbound Metadata</h3>
<div class="paragraph">
<p>When sending <code>Messages</code>, you can add an instance of <code>OutgoingAmqpMetadata</code> to influence how the message is going to be sent to AMQP.
For example, you can configure the subjects, properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java"> OutgoingAmqpMetadata metadata = OutgoingAmqpMetadata.builder()
    .withDurable(true)
    .withSubject("my-subject")
    .build();

// Create a new message from the `incoming` message
// Add `metadata` to the metadata from the `incoming` message.
return incoming.addMetadata(metadata);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dynamic-address-names"><a class="anchor" href="#dynamic-address-names"></a>Dynamic address names</h3>
<div class="paragraph">
<p>Sometimes it is desirable to select the destination of a message dynamically.
In this case, you should not configure the address inside your application configuration file, but instead, use the outbound metadata to set the address.</p>
</div>
<div class="paragraph">
<p>For example, you can send to a dynamic address based on the incoming message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String addressName = selectAddressFromIncommingMessage(incoming);
OutgoingAmqpMetadata metadata = OutgoingAmqpMetadata.builder()
    .withAddress(addressName)
    .withDurable(true)
    .build();

// Create a new message from the `incoming` message
// Add `metadata` to the metadata from the `incoming` message.
return incoming.addMetadata(metadata);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To be able to set the address per message, the connector is using an <em>anonymous sender</em>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="acknowledgement-2"><a class="anchor" href="#acknowledgement-2"></a>Acknowledgement</h3>
<div class="paragraph">
<p>By default, the Reactive Messaging <code>Message</code> is acknowledged when the broker acknowledged the message.
When using routers, this acknowledgement may not be enabled.
In this case, configure the <code>auto-acknowledgement</code> attribute to acknowledge the message as soon as it has been sent to the router.</p>
</div>
<div class="paragraph">
<p>If an AMQP message is rejected/released/modified by the broker (or cannot be sent successfully), the message is nacked.</p>
</div>
</div>
<div class="sect2">
<h3 id="back-pressure-and-credits"><a class="anchor" href="#back-pressure-and-credits"></a>Back Pressure and Credits</h3>
<div class="paragraph">
<p>The back-pressure is handled by AMQP <em>credits</em>.
The outbound connector only requests the amount of allowed credits.
When the amount of credits reaches 0, it waits (in a non-blocking fashion) until the broker grants more credits to the AMQP sender.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-the-amqp-address"><a class="anchor" href="#configuring-the-amqp-address"></a>Configuring the AMQP address</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can configure the AMQP address using the <code>address</code> attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">mp.messaging.incoming.prices.connector=smallrye-amqp
mp.messaging.incoming.prices.address=my-queue

mp.messaging.outgoing.orders.connector=smallrye-amqp
mp.messaging.outgoing.orders.address=my-order-queue</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>address</code> attribute is not set, the connector uses the channel name.</p>
</div>
<div class="paragraph">
<p>To use an existing queue, you need to configure the <code>address</code>, <code>container-id</code> and, optionally, the <code>link-name</code> attributes.
For example, if you have an Apache Artemis broker configured with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;queues&gt;
    &lt;queue name="people"&gt;
        &lt;address&gt;people&lt;/address&gt;
        &lt;durable&gt;true&lt;/durable&gt;
        &lt;user&gt;artemis&lt;/user&gt;
    &lt;/queue&gt;
&lt;/queues&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You need the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">mp.messaging.outgoing.people.connector=smallrye-amqp
mp.messaging.outgoing.people.durable=true
mp.messaging.outgoing.people.address=people
mp.messaging.outgoing.people.container-id=people</code></pre>
</div>
</div>
<div class="paragraph">
<p>You may need to configure the <code>link-name</code> attribute, if the queue name is not the channel name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">mp.messaging.outgoing.people-out.connector=smallrye-amqp
mp.messaging.outgoing.people-out.durable=true
mp.messaging.outgoing.people-out.address=people
mp.messaging.outgoing.people-out.container-id=people
mp.messaging.outgoing.people-out.link-name=people</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use a <code>MULTICAST</code> queue, you need to provide the <em>FQQN</em> (fully-qualified queue name) instead of just the name of the queue:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">mp.messaging.outgoing.people-out.connector=smallrye-amqp
mp.messaging.outgoing.people-out.durable=true
mp.messaging.outgoing.people-out.address=foo
mp.messaging.outgoing.people-out.container-id=foo

mp.messaging.incoming.people-out.connector=smallrye-amqp
mp.messaging.incoming.people-out.durable=true
mp.messaging.incoming.people-out.address=foo::bar # Note the syntax: address-name::queue-name
mp.messaging.incoming.people-out.container-id=bar
mp.messaging.incoming.people-out.link-name=people</code></pre>
</div>
</div>
<div class="paragraph">
<p>More details about the AMQP Address model can be found in the <a href="https://activemq.apache.org/components/artemis/documentation/2.0.0/address-model.html">Artemis documentation</a>.</p>
</div>
<div class="sect2">
<h3 id="blocking-processing"><a class="anchor" href="#blocking-processing"></a>Execution model and Blocking processing</h3>
<div class="paragraph">
<p>Reactive Messaging invokes your method on an I/O thread.
See the <a href="quarkus-reactive-architecture">Quarkus Reactive Architecture documentation</a> for further details on this topic.
But, you often need to combine Reactive Messaging with blocking processing such as database interactions.
For this, you need to use the <code>@Blocking</code> annotation indicating that the processing is <em>blocking</em> and should not be run on the caller thread.</p>
</div>
<div class="paragraph">
<p>For example, The following code illustrates how you can store incoming payloads to a database using Hibernate with Panache:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.smallrye.reactive.messaging.annotations.Blocking;
import org.eclipse.microprofile.reactive.messaging.Incoming;

import jakarta.enterprise.context.ApplicationScoped;
import jakarta.transaction.Transactional;

@ApplicationScoped
public class PriceStorage {

    @Incoming("prices")
    @Transactional
    public void store(int priceInUsd) {
        Price price = new Price();
        price.value = priceInUsd;
        price.persist();
    }

}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There are 2 <code>@Blocking</code> annotations:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>io.smallrye.reactive.messaging.annotations.Blocking</code></p>
</li>
<li>
<p><code>io.smallrye.common.annotation.Blocking</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>They have the same effect.
Thus, you can use both.
The first one provides more fine-grained tuning such as the worker pool to use and whether it preserves the order.
The second one, used also with other reactive features of Quarkus, uses the default worker pool and preserves the order.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">@Transactional</div>
<div class="paragraph">
<p>If your method is annotated with <code>@Transactional</code>, it will be considered <em>blocking</em> automatically, even if the method is not annotated with <code>@Blocking</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="customizing-the-underlying-amqp-client"><a class="anchor" href="#customizing-the-underlying-amqp-client"></a>Customizing the underlying AMQP client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The connector uses the Vert.x AMQP client underneath.
More details about this client can be found in the <a href="https://vertx.io/docs/vertx-amqp-client/java/">Vert.x website</a>.</p>
</div>
<div class="paragraph">
<p>You can customize the underlying client configuration by producing an instance of <code>AmqpClientOptions</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Produces
@Identifier("my-named-options")
public AmqpClientOptions getNamedOptions() {
  // You can use the produced options to configure the TLS connection
  PemKeyCertOptions keycert = new PemKeyCertOptions()
    .addCertPath("./tls/tls.crt")
    .addKeyPath("./tls/tls.key");
  PemTrustOptions trust = new PemTrustOptions().addCertPath("./tlc/ca.crt");
  return new AmqpClientOptions()
        .setSsl(true)
        .setPemKeyCertOptions(keycert)
        .setPemTrustOptions(trust)
        .addEnabledSaslMechanism("EXTERNAL")
        .setHostnameVerificationAlgorithm("")
        .setConnectTimeout(30000)
        .setReconnectInterval(5000)
        .setContainerId("my-container");
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This instance is retrieved and used to configure the client used by the connector.
You need to indicate the name of the client using the <code>client-options-name</code> attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">mp.messaging.incoming.prices.client-options-name=my-named-options</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="health-reporting"><a class="anchor" href="#health-reporting"></a>Health reporting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you use the AMQP connector with the <code>quarkus-smallrye-health</code> extension, it contributes to the readiness and liveness probes.
The AMQP connector reports the readiness and liveness of each channel managed by the connector.
At the moment, the AMQP connector uses the same logic for the readiness and liveness checks.</p>
</div>
<div class="paragraph">
<p>To disable health reporting, set the <code>health-enabled</code> attribute for the channel to false.
On the inbound side (receiving messages from AMQP), the check verifies that the receiver is attached to the broker.
On the outbound side (sending records to AMQP), the check verifies that the sender is attached to the broker.</p>
</div>
<div class="paragraph">
<p>Note that a message processing failures nacks the message, which is then handled by the <code>failure-strategy</code>.
It is the responsibility of the <code>failure-strategy</code> to report the failure and influence the outcome of the checks.
The <code>fail</code> failure strategy reports the failure, and so the check will report the fault.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-rabbitmq"><a class="anchor" href="#using-rabbitmq"></a>Using RabbitMQ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This connector is for AMQP 1.0. RabbitMQ implements AMQP 0.9.1.
RabbitMQ does not provide AMQP 1.0 by default, but there is a plugin for it.
To use RabbitMQ with this connector, enable and configure the AMQP 1.0 plugin.</p>
</div>
<div class="paragraph">
<p>Despite the existence of the plugin, a few AMQP 1.0 features won’t work with RabbitMQ.
Thus, we recommend the following configurations.</p>
</div>
<div class="paragraph">
<p>To receive messages from RabbitMQ:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set durable to false</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">mp.messaging.incoming.prices.connector=smallrye-amqp
mp.messaging.incoming.prices.durable=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>To send messages to RabbitMQ:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>set the destination address (anonymous sender are not supported)</p>
</li>
<li>
<p>set <code>use-anonymous-sender</code> to false</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">mp.messaging.outgoing.generated-price.connector=smallrye-amqp
mp.messaging.outgoing.generated-price.address=prices
mp.messaging.outgoing.generated-price.use-anonymous-sender=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>As a consequence, it’s not possible to change the destination dynamically (using message metadata) when using RabbitMQ.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="receiving-cloud-events"><a class="anchor" href="#receiving-cloud-events"></a>Receiving Cloud Events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The AMQP connector supports <a href="https://cloudevents.io/">Cloud Events</a>.
When the connector detects a <em>structured</em> or <em>binary</em> Cloud Events, it adds a  <code>IncomingCloudEventMetadata&lt;T&gt;</code> into the metadata of the <code>Message</code>.
<code>IncomingCloudEventMetadata</code> contains accessors to the mandatory and optional Cloud Event attributes.</p>
</div>
<div class="paragraph">
<p>If the connector cannot extract the Cloud Event metadata, it sends the Message without the metadata.</p>
</div>
<div class="paragraph">
<p>For more information on receiving Cloud Events, see <a href="https://smallrye.io/smallrye-reactive-messaging/smallrye-reactive-messaging/3.12/amqp/amqp.html#_receiving_cloud_events">Receiving Cloud Events</a> in SmallRye Reactive Messaging documentation.</p>
</div>
<div class="sect2">
<h3 id="sending-cloud-events"><a class="anchor" href="#sending-cloud-events"></a>Sending Cloud Events</h3>
<div class="paragraph">
<p>The AMQP connector supports <a href="https://cloudevents.io/">Cloud Events</a>.
The connector sends the outbound record as Cloud Events if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the message metadata contains an <code>io.smallrye.reactive.messaging.ce.OutgoingCloudEventMetadata</code> instance,</p>
</li>
<li>
<p>the channel configuration defines the <code>cloud-events-type</code> and <code>cloud-events-source</code> attributes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information on sending Cloud Events, see <a href="https://smallrye.io/smallrye-reactive-messaging/smallrye-reactive-messaging/3.12/amqp/amqp.html#_sending_cloud_events">Sending Cloud Events</a> in SmallRye Reactive Messaging documentation.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-reference"><a class="anchor" href="#configuration-reference"></a>AMQP Connector Configuration Reference</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="quarkus-specific-configuration"><a class="anchor" href="#quarkus-specific-configuration"></a>Quarkus specific configuration</h3>

</div>
<div class="sect2">
<h3 id="incoming-channel-configuration"><a class="anchor" href="#incoming-channel-configuration"></a>Incoming channel configuration</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 27.7777%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 22.2224%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute (<em>alias</em>)</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Mandatory</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>address</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The AMQP address. If not set, the channel name is used</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>auto-acknowledgement</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the received AMQP messages must be acknowledged when received</p>
<p class="tableblock">Type: <em>boolean</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>broadcast</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the received AMQP messages must be dispatched to multiple <em>subscribers</em></p>
<p class="tableblock">Type: <em>boolean</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>capabilities</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma-separated list of capabilities proposed by the sender or receiver client.</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>client-options-name</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-client-options-name)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the AMQP Client Option bean used to customize the AMQP client configuration</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>cloud-events</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables (default) or disables the Cloud Event support. If enabled on an <em>incoming</em> channel, the connector analyzes the incoming records and try to create Cloud Event metadata. If enabled on an <em>outgoing</em>, the connector sends the outgoing messages as Cloud Event if the message includes Cloud Event Metadata.</p>
<p class="tableblock">Type: <em>boolean</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>connect-timeout</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-connect-timeout)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The connection timeout in milliseconds</p>
<p class="tableblock">Type: <em>int</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>container-id</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The AMQP container id</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>durable</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether AMQP subscription is durable</p>
<p class="tableblock">Type: <em>boolean</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>failure-strategy</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the failure strategy to apply when a message produced from an AMQP message is nacked. Accepted values are <code>fail</code> (default), <code>accept</code>, <code>release</code>, <code>reject</code>, <code>modified-failed</code>, <code>modified-failed-undeliverable-here</code></p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fail</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>health-timeout</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The max number of seconds to wait to determine if the connection with the broker is still established for the readiness check. After that threshold, the check is considered as failed.</p>
<p class="tableblock">Type: <em>int</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>host</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-host)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The broker hostname</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localhost</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>link-name</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the link. If not set, the channel name is used.</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>password</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-password)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password used to authenticate to the broker</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>port</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-port)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The broker port</p>
<p class="tableblock">Type: <em>int</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5672</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>reconnect-attempts</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-reconnect-attempts)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of reconnection attempts</p>
<p class="tableblock">Type: <em>int</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>100</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>reconnect-interval</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-reconnect-interval)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The interval in second between two reconnection attempts</p>
<p class="tableblock">Type: <em>int</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>sni-server-name</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-sni-server-name)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set, explicitly override the hostname to use for the TLS SNI server name</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>selector</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets a message selector. This attribute is used to define an <code>apache.org:selector-filter:string</code> filter on the source terminus, using SQL-based syntax to request the server filters which messages are delivered to the receiver (if supported by the server in question). Precise functionality supported and syntax needed can vary depending on the server.</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>tracing-enabled</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether tracing is enabled (default) or disabled</p>
<p class="tableblock">Type: <em>boolean</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>use-ssl</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-use-ssl)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the AMQP connection uses SSL/TLS</p>
<p class="tableblock">Type: <em>boolean</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>username</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-username)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The username used to authenticate to the broker</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>virtual-host</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-virtual-host)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set, configure the hostname value used for the connection AMQP Open frame and TLS SNI server name (if TLS is in use)</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="outgoing-channel-configuration"><a class="anchor" href="#outgoing-channel-configuration"></a>Outgoing channel configuration</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 27.7777%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 22.2224%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute (<em>alias</em>)</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Mandatory</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>address</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The AMQP address. If not set, the channel name is used</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>capabilities</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma-separated list of capabilities proposed by the sender or receiver client.</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>client-options-name</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-client-options-name)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the AMQP Client Option bean used to customize the AMQP client configuration</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>cloud-events</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables (default) or disables the Cloud Event support. If enabled on an <em>incoming</em> channel, the connector analyzes the incoming records and try to create Cloud Event metadata. If enabled on an <em>outgoing</em>, the connector sends the outgoing messages as Cloud Event if the message includes Cloud Event Metadata.</p>
<p class="tableblock">Type: <em>boolean</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>cloud-events-data-content-type</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(cloud-events-default-data-content-type)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure the default <code>datacontenttype</code> attribute of the outgoing Cloud Event. Requires <code>cloud-events</code> to be set to <code>true</code>. This value is used if the message does not configure the <code>datacontenttype</code> attribute itself</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>cloud-events-data-schema</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(cloud-events-default-data-schema)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure the default <code>dataschema</code> attribute of the outgoing Cloud Event. Requires <code>cloud-events</code> to be set to <code>true</code>. This value is used if the message does not configure the <code>dataschema</code> attribute itself</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>cloud-events-insert-timestamp</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(cloud-events-default-timestamp)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the connector should insert automatically the <code>time</code> attribute into the outgoing Cloud Event. Requires <code>cloud-events</code> to be set to <code>true</code>. This value is used if the message does not configure the <code>time</code> attribute itself</p>
<p class="tableblock">Type: <em>boolean</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>cloud-events-mode</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Cloud Event mode (<code>structured</code> or <code>binary</code> (default)). Indicates how are written the cloud events in the outgoing record</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>binary</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>cloud-events-source</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(cloud-events-default-source)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure the default <code>source</code> attribute of the outgoing Cloud Event. Requires <code>cloud-events</code> to be set to <code>true</code>. This value is used if the message does not configure the <code>source</code> attribute itself</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>cloud-events-subject</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(cloud-events-default-subject)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure the default <code>subject</code> attribute of the outgoing Cloud Event. Requires <code>cloud-events</code> to be set to <code>true</code>. This value is used if the message does not configure the <code>subject</code> attribute itself</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>cloud-events-type</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(cloud-events-default-type)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure the default <code>type</code> attribute of the outgoing Cloud Event. Requires <code>cloud-events</code> to be set to <code>true</code>. This value is used if the message does not configure the <code>type</code> attribute itself</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>connect-timeout</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-connect-timeout)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The connection timeout in milliseconds</p>
<p class="tableblock">Type: <em>int</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>container-id</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The AMQP container id</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>credit-retrieval-period</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The period (in milliseconds) between two attempts to retrieve the credits granted by the broker. This time is used when the sender run out of credits.</p>
<p class="tableblock">Type: <em>int</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>durable</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether sent AMQP messages are marked durable</p>
<p class="tableblock">Type: <em>boolean</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>health-timeout</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The max number of seconds to wait to determine if the connection with the broker is still established for the readiness check. After that threshold, the check is considered as failed.</p>
<p class="tableblock">Type: <em>int</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>host</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-host)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The broker hostname</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localhost</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>link-name</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the link. If not set, the channel name is used.</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>merge</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the connector should allow multiple upstreams</p>
<p class="tableblock">Type: <em>boolean</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>password</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-password)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password used to authenticate to the broker</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>port</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-port)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The broker port</p>
<p class="tableblock">Type: <em>int</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5672</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>reconnect-attempts</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-reconnect-attempts)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of reconnection attempts</p>
<p class="tableblock">Type: <em>int</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>100</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>reconnect-interval</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-reconnect-interval)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The interval in second between two reconnection attempts</p>
<p class="tableblock">Type: <em>int</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>sni-server-name</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-sni-server-name)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set, explicitly override the hostname to use for the TLS SNI server name</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>tracing-enabled</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether tracing is enabled (default) or disabled</p>
<p class="tableblock">Type: <em>boolean</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>ttl</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time-to-live of the sent AMQP messages. 0 to disable the TTL</p>
<p class="tableblock">Type: <em>long</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>use-anonymous-sender</strong></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the connector should use an anonymous sender. Default value is <code>true</code> if the broker supports it, <code>false</code> otherwise. If not supported, it is not possible to dynamically change the destination address.</p>
<p class="tableblock">Type: <em>boolean</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>use-ssl</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-use-ssl)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the AMQP connection uses SSL/TLS</p>
<p class="tableblock">Type: <em>boolean</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>username</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-username)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The username used to authenticate to the broker</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="no-hyphens"><strong>virtual-host</strong></span></p>
<p class="tableblock"><span class="no-hyphens"><em>(amqp-virtual-host)</em></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set, configure the hostname value used for the connection AMQP Open frame and TLS SNI server name (if TLS is in use)</p>
<p class="tableblock">Type: <em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>