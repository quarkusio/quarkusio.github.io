<!DOCTYPE html>
<html lang="en">







<head>
  <title>Security Tips and Tricks - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://route-default-test-mscherer-matamo.apps.ospo-osci.z3b1.p1.openshiftapps.com/ https://search.quarkus.io https://smetrics.redhat.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      js.bizographics.com
      https://www.redhat.com
      https://static.redhat.com
      https://app.requestly.io/
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://giscus.app
      https://route-default-test-mscherer-matamo.apps.ospo-osci.z3b1.p1.openshiftapps.com/
      https://app.mailjet.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net https://www.youtube.com https://embed.restream.io https://app.mailjet.com http://xy0p2.mjt.lu https://mj.quarkus.io https://giscus.app; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/guides/security-customization" />
  <meta property="og:title" content="Security Tips and Tricks" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/security-customization">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="en" href="https://quarkus.io/guides/security-customization" />
  
  <link rel="alternate" hreflang="pt-br" href="https://pt.quarkus.io/guides/security-customization" />
  
  <link rel="alternate" hreflang="es" href="https://es.quarkus.io/guides/security-customization" />
  
  <link rel="alternate" hreflang="zh" href="https://cn.quarkus.io/guides/security-customization" />
  
  <link rel="alternate" hreflang="ja" href="https://ja.quarkus.io/guides/security-customization" />
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />  
  <script src="/assets/javascript/tracking.js"></script>
  
  <script src="/assets/javascript/colormode.js" type="text/javascript"></script>

</head>

<body class="guides">

  
  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
        <div class="logo-wrapper">
           <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/about/">Why<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">WHAT IS QUARKUS?</a></li>
          <li><a href="/container-first" class="">CONTAINER FIRST</a></li>
          <li><a href="/continuum" class="">VERSATILITY</a></li>
          <li><a href="/developer-joy" class="">DEVELOPER JOY</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">STANDARDS</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/learn/">Learn<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">GET STARTED</a></li>
          <li><a href="/guides" class="active">DOCUMENTATION</a></li>
          <li><a href="/qtips" class="">"Q" TIP VIDEOS</a></li>          
          <li><a href="/books" class="">BOOKS</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="https://quarkus.io/extensions/">Extensions<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <!-- Note that quarkus.io is hardcoded here, because it is the only url which supports extensions -->
          <li><a href="https://quarkus.io/extensions/" class="">BROWSE EXTENSIONS</a></li>
          <li><a href="/faq/#what-is-a-quarkus-extension" class="">USE EXTENSIONS</a></li>
          <li><a href="/guides/writing-extensions" class="">CREATE EXTENSIONS</a></li>
          <li><a href="https://hub.quarkiverse.io" class="">SHARE EXTENSIONS</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/community/">Community<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">SUPPORT</a></li>
          <li><a href="/blog" class="">BLOG</a></li>
          <li><a href="/discussion" class="">DISCUSSION</a></li>
          <li><a href="/working-groups" class="">WORKING GROUPS</a></li>
          <li><a href="/insights" class="">PODCAST</a></li>
          <li><a href="/events" class="">EVENTS</a></li>
          <li><a href="/newsletter" class="">NEWSLETTER</a></li>
          <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" class="">ROADMAP</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary white">START CODING</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/guides/security-customization" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://pt.quarkus.io/guides/security-customization">PORTUGUÊS (BR)</a></li>
          <li><a href="https://es.quarkus.io/guides/security-customization">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/guides/security-customization">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/guides/security-customization">日本語</a></li>
          </ul>
      </li>
      <li>
        <span href="#" class="modeswitcher" id='theme-toggle'><i class="fas fa-sun"></i><i class="fas fa-moon"></i><i class="fas fa-cog"></i></span>
      </li>
    </ul>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    







<section class="full-width-version-bg flexfilterbar guides">
  <div class="guideflexcontainer">
    <div class="docslink">
      <a class="returnlink" href="/guides/"> Back to Guides</a>
    </div>
    <div class="flexlabel">
      <label>By Version</label>
    </div>
    <div class="guidepulldown version">
    <select id="guide-version-dropdown">
      
        
        
        <option value="main" >Main - SNAPSHOT</option>
        
        
        
        <option value="latest" selected>3.16.2 - Latest</option>
        
        
        
        <option value="3.15" >3.15</option>
        
        
        
        <option value="3.8" >3.8</option>
        
        
        
        <option value="3.2" >3.2</option>
        
        
        
        <option value="2.16" >2.16</option>
        
        
        
        <option value="2.13" >2.13</option>
        </select>
    </div>
  </div>
</section>

<div class="guide">
  <div class="grid-wrapper">
    <div class="grid__item width-8-12 width-12-12-m">
      
      <a class="editlink" href="https://github.com/quarkusio/quarkus/edit/main/docs/src/main/asciidoc/security-customization.adoc">Edit this Page</a>
      
      <h1 class="text-caps">Security Tips and Tricks </h1>
      <div class="sect1">
<h2 id="quarkus-security-dependency"><a class="anchor" href="#quarkus-security-dependency"></a>Quarkus Security Dependency</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>io.quarkus:quarkus-security</code> module contains the core Quarkus Security classes.</p>
</div>
<div class="paragraph">
<p>In most cases, it does not have to be added directly to your project&#8217;s build file as it is already provided by all the security extensions.
However, if you need to write your own custom security code (for example, register a <a href="#jaxrs-security-context">Custom Jakarta REST SecurityContext</a>) or use <a href="#bouncy-castle">BouncyCastle</a> libraries, then please make sure it is included:</p>
</div>
<div class="listingblock primary asciidoc-tabs-target-sync-cli asciidoc-tabs-target-sync-maven">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-security&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-target-sync-gradle">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">implementation("io.quarkus:quarkus-security")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="httpauthenticationmechanism-customization"><a class="anchor" href="#httpauthenticationmechanism-customization"></a>HttpAuthenticationMechanism Customization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One can customize <code>HttpAuthenticationMechanism</code> by registering a CDI implementation bean.
In the example below the custom authenticator delegates to <code>JWTAuthMechanism</code> provided by <code>quarkus-smallrye-jwt</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Alternative
@Priority(1)
@ApplicationScoped
public class CustomAwareJWTAuthMechanism implements HttpAuthenticationMechanism {

	private static final Logger LOG = LoggerFactory.getLogger(CustomAwareJWTAuthMechanism.class);

	@Inject
	JWTAuthMechanism delegate;

	@Override
	public Uni&lt;SecurityIdentity&gt; authenticate(RoutingContext context, IdentityProviderManager identityProviderManager) {
	    // do some custom action and delegate
            return delegate.authenticate(context, identityProviderManager);
	}

	@Override
	public Uni&lt;ChallengeData&gt; getChallenge(RoutingContext context) {
		return delegate.getChallenge(context);
	}

	@Override
	public Set&lt;Class&lt;? extends AuthenticationRequest&gt;&gt; getCredentialTypes() {
		return delegate.getCredentialTypes();
	}

	@Override
	public Uni&lt;HttpCredentialTransport&gt; getCredentialTransport() {
		return delegate.getCredentialTransport();
	}

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>HttpAuthenticationMechanism</code> should transform incoming HTTP request with suitable authentication credentials
into an <code>io.quarkus.security.identity.request.AuthenticationRequest</code> instance and delegate the authentication to the <code>io.quarkus.security.identity.IdentityProviderManager</code>.
Leaving authentication to the <code>io.quarkus.security.identity.IdentityProvider</code>s gives you more options for credentials verifications,
as well as convenient way to perform blocking tasks.
Nevertheless, the <code>io.quarkus.security.identity.IdentityProvider</code> can be omitted and the <code>HttpAuthenticationMechanism</code> is free to authenticate request on its own in trivial use cases.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dealing-with-more-than-one-http-auth-mechanisms"><a class="anchor" href="#dealing-with-more-than-one-http-auth-mechanisms"></a>Dealing with more than one HttpAuthenticationMechanism</h2>
<div class="sectionbody">
<div class="paragraph">
<p>More than one <code>HttpAuthenticationMechanism</code> can be combined, for example, the built-in <code>Basic</code> or <code>JWT</code> mechanism provided by <code>quarkus-smallrye-jwt</code> has to be used to verify the service clients credentials passed as the HTTP <code>Authorization</code> <code>Basic</code> or <code>Bearer</code> scheme values while the <code>Authorization Code</code> mechanism provided by <code>quarkus-oidc</code> has to be used to authenticate the users with Keycloak or other OpenID Connect providers.</p>
</div>
<div class="paragraph">
<p>In such cases the mechanisms are asked to verify the credentials in turn until a <code>SecurityIdentity</code> is created. The mechanisms are sorted in the descending order using their priority. <code>Basic</code> authentication mechanism has the highest priority of <code>2000</code>, followed by the <code>Authorization Code</code> one with the priority of <code>1001</code>, with all other mechanisms provided by Quarkus having the priority of <code>1000</code>.</p>
</div>
<div class="paragraph">
<p>If no credentials are provided then the mechanism specific challenge is created, for example, <code>401</code> status is returned by either <code>Basic</code> or <code>JWT</code> mechanisms, URL redirecting the user to the OpenID Connect provider is returned by <code>quarkus-oidc</code>, etc.</p>
</div>
<div class="paragraph">
<p>So if <code>Basic</code> and <code>Authorization Code</code> mechanisms are combined then <code>401</code> will be returned if no credentials are provided and if <code>JWT</code> and <code>Authorization Code</code> mechanisms are combined then a redirect URL will be returned.</p>
</div>
<div class="paragraph">
<p>In some cases such a default logic of selecting the challenge is exactly what is required by a given application, but sometimes it may not meet the requirements. In such cases (or indeed in other similar cases where you&#8217;d like to change the order in which the mechanisms are asked to handle the current authentication or challenge request), you can create a custom mechanism and choose which mechanism should create a challenge, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Alternative <i class="conum" data-value="1"></i><b>(1)</b>
@Priority(1)
@ApplicationScoped
public class CustomAwareJWTAuthMechanism implements HttpAuthenticationMechanism {

	private static final Logger LOG = LoggerFactory.getLogger(CustomAwareJWTAuthMechanism.class);

	@Inject
	JWTAuthMechanism jwt;

        @Inject
	OidcAuthenticationMechanism oidc;

	@Override
	public Uni&lt;SecurityIdentity&gt; authenticate(RoutingContext context, IdentityProviderManager identityProviderManager) {
	    return selectBetweenJwtAndOidc(context).authenticate(context, identityProviderManager);
	}

	@Override
	public Uni&lt;ChallengeData&gt; getChallenge(RoutingContext context) {
            return selectBetweenJwtAndOidcChallenge(context).getChallenge(context);
	}

	@Override
	public Set&lt;Class&lt;? extends AuthenticationRequest&gt;&gt; getCredentialTypes() {
            Set&lt;Class&lt;? extends AuthenticationRequest&gt;&gt; credentialTypes = new HashSet&lt;&gt;();
            credentialTypes.addAll(jwt.getCredentialTypes());
            credentialTypes.addAll(oidc.getCredentialTypes());
            return credentialTypes;
	}

        @Override
        public Uni&lt;HttpCredentialTransport&gt; getCredentialTransport(RoutingContext context) {
            return selectBetweenJwtAndOidc(context).getCredentialTransport(context);
        }

        private HttpAuthenticationMechanism selectBetweenJwtAndOidc(RoutingContext context) {
            ....
        }

        private HttpAuthenticationMechanism selectBetweenJwtAndOidcChallenge(RoutingContext context) {
            // for example, if no `Authorization` header is available and no `code` parameter is provided - use `jwt` to create a challenge
        }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Declaring the mechanism an alternative bean ensures this mechanism is used rather than <code>OidcAuthenticationMechanism</code> and <code>JWTAuthMechanism</code>.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security-identity-customization"><a class="anchor" href="#security-identity-customization"></a>Security Identity Customization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Internally, the identity providers create and update an instance of the <code>io.quarkus.security.identity.SecurityIdentity</code> class which holds the principal, roles, credentials which were used to authenticate the client (user) and other security attributes. An easy option to customize <code>SecurityIdentity</code> is to register a custom <code>SecurityIdentityAugmentor</code>. For example, the augmentor below adds an addition role:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.quarkus.security.identity.AuthenticationRequestContext;
import io.quarkus.security.identity.SecurityIdentity;
import io.quarkus.security.identity.SecurityIdentityAugmentor;
import io.quarkus.security.runtime.QuarkusSecurityIdentity;
import io.smallrye.mutiny.Uni;

import jakarta.enterprise.context.ApplicationScoped;
import java.util.function.Supplier;

@ApplicationScoped
public class RolesAugmentor implements SecurityIdentityAugmentor {

    @Override
    public Uni&lt;SecurityIdentity&gt; augment(SecurityIdentity identity, AuthenticationRequestContext context) {
        return Uni.createFrom().item(build(identity));

        // Do 'return context.runBlocking(build(identity));'
        // if a blocking call is required to customize the identity
    }

    private Supplier&lt;SecurityIdentity&gt; build(SecurityIdentity identity) {
        if(identity.isAnonymous()) {
            return () -&gt; identity;
        } else {
            // create a new builder and copy principal, attributes, credentials and roles from the original identity
            QuarkusSecurityIdentity.Builder builder = QuarkusSecurityIdentity.builder(identity);

            // add custom role source here
            builder.addRole("dummy");
            return builder::build;
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is another example showing how to use the client certificate available in the current <a href="security-authentication-mechanisms#mutual-tls">mutual TLS (mTLS) authentication</a> request to add more roles:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.security.cert.X509Certificate;
import io.quarkus.security.credential.CertificateCredential;
import io.quarkus.security.identity.AuthenticationRequestContext;
import io.quarkus.security.identity.SecurityIdentity;
import io.quarkus.security.identity.SecurityIdentityAugmentor;
import io.quarkus.security.runtime.QuarkusSecurityIdentity;
import io.smallrye.mutiny.Uni;

import jakarta.enterprise.context.ApplicationScoped;
import java.util.function.Supplier;
import java.util.Set;

@ApplicationScoped
public class RolesAugmentor implements SecurityIdentityAugmentor {

    @Override
    public Uni&lt;SecurityIdentity&gt; augment(SecurityIdentity identity, AuthenticationRequestContext context) {
        return Uni.createFrom().item(build(identity));
    }

    private Supplier&lt;SecurityIdentity&gt; build(SecurityIdentity identity) {
        // create a new builder and copy principal, attributes, credentials and roles from the original identity
        QuarkusSecurityIdentity.Builder builder = QuarkusSecurityIdentity.builder(identity);

        CertificateCredential certificate = identity.getCredential(CertificateCredential.class);
        if (certificate != null) {
            builder.addRoles(extractRoles(certificate.getCertificate()));
        }
        return builder::build;
    }

    private Set&lt;String&gt; extractRoles(X509Certificate certificate) {
        String name = certificate.getSubjectX500Principal().getName();

        switch (name) {
            case "CN=client":
                return Collections.singleton("user");
            case "CN=guest-client":
                return Collections.singleton("guest");
            default:
                return Collections.emptySet();
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If more than one custom <code>SecurityIdentityAugmentor</code> is registered then they will be considered equal candidates and invoked in random order.
You can enforce the order by implementing a default <code>SecurityIdentityAugmentor#priority</code> method. Augmentors with higher priorities will be invoked first.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, the request context is not activated when augmenting the security identity, this means that if you want to use for example Hibernate
that mandates a request context, you will have a <code>jakarta.enterprise.context.ContextNotActiveException</code>.</p>
</div>
<div class="paragraph">
<p>The solution is to activate the request context, the following example shows how to get the roles from an Hibernate with Panache <code>UserRoleEntity</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.quarkus.security.identity.AuthenticationRequestContext;
import io.quarkus.security.identity.SecurityIdentity;
import io.quarkus.security.identity.SecurityIdentityAugmentor;
import io.smallrye.mutiny.Uni;

import jakarta.enterprise.context.ApplicationScoped;
import jakarta.enterprise.inject.Instance;
import jakarta.inject.Inject;

@ApplicationScoped
public class RolesAugmentor implements SecurityIdentityAugmentor {

    @Inject
    Instance&lt;SecurityIdentitySupplier&gt; identitySupplierInstance;

    @Override
    public Uni&lt;SecurityIdentity&gt; augment(SecurityIdentity identity, AuthenticationRequestContext context) {
        if(identity.isAnonymous()) {
            return Uni.createFrom().item(identity);
        }

        // Hibernate ORM is blocking
        SecurityIdentitySupplier identitySupplier = identitySupplierInstance.get();
        identitySupplier.setIdentity(identity);
        return context.runBlocking(identitySupplier);
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.quarkus.security.identity.SecurityIdentity;
import io.quarkus.security.runtime.QuarkusSecurityIdentity;

import jakarta.enterprise.context.Dependent;
import jakarta.enterprise.context.control.ActivateRequestContext;
import java.util.function.Supplier;

@Dependent
class SecurityIdentitySupplier implements Supplier&lt;SecurityIdentity&gt; {

    private SecurityIdentity identity;

    @Override
    @ActivateRequestContext
    public SecurityIdentity get() {
        QuarkusSecurityIdentity.Builder builder = QuarkusSecurityIdentity.builder(identity);
        String user = identity.getPrincipal().getName();

        UserRoleEntity.&lt;userRoleEntity&gt;streamAll()
                .filter(role -&gt; user.equals(role.user))
                .forEach(role -&gt; builder.addRole(role.role));

        return builder.build();
    }

    public void setIdentity(SecurityIdentity identity) {
        this.identity = identity;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The CDI request context activation shown in the example above does not help you to access the <code>RoutingContext</code> when the proactive authentication is enabled.
The following example illustrates how you can access the <code>RoutingContext</code> from the <code>SecurityIdentityAugmentor</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security;

import java.util.Map;

import jakarta.enterprise.context.ApplicationScoped;

import io.quarkus.security.identity.AuthenticationRequestContext;
import io.quarkus.security.identity.SecurityIdentity;
import io.quarkus.security.identity.SecurityIdentityAugmentor;
import io.quarkus.vertx.http.runtime.security.HttpSecurityUtils;
import io.smallrye.mutiny.Uni;
import io.vertx.ext.web.RoutingContext;

@ApplicationScoped
public class CustomSecurityIdentityAugmentor implements SecurityIdentityAugmentor {

    @Override
    public Uni&lt;SecurityIdentity&gt; augment(SecurityIdentity identity, AuthenticationRequestContext context,
            Map&lt;String, Object&gt; attributes) {
        RoutingContext routingContext = HttpSecurityUtils.getRoutingContextAttribute(attributes);
        if (routingContext != null) {
            // Augment SecurityIdentity using RoutingContext
        } else {
            return augment(identity, context); <i class="conum" data-value="1"></i><b>(1)</b>
        }
    }

    ...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>RoutingContext</code> is not be available when the <code>SecurityIdentity</code> is augmented after HTTP request has completed.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you implemented a custom <code>HttpAuthenticationMechanism</code>, then you need to add the <code>RoutingContext</code> to the authentication
request attributes with the <code>io.quarkus.vertx.http.runtime.security.HttpSecurityUtils.setRoutingContextAttribute</code> method call.
Otherwise, the <code>RoutingContext</code> will not be available during augmentation.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jaxrs-security-context"><a class="anchor" href="#jaxrs-security-context"></a>Custom Jakarta REST SecurityContext</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you use Jakarta REST <code>ContainerRequestFilter</code> to set a custom Jakarta REST <code>SecurityContext</code> then make sure <code>ContainerRequestFilter</code> runs in the Jakarta REST pre-match phase by adding a <code>@PreMatching</code> annotation to it for this custom security context to be linked with Quarkus <code>SecurityIdentity</code>, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.security.Principal;

import jakarta.ws.rs.container.ContainerRequestContext;
import jakarta.ws.rs.container.ContainerRequestFilter;
import jakarta.ws.rs.container.PreMatching;
import jakarta.ws.rs.core.SecurityContext;
import jakarta.ws.rs.ext.Provider;

@Provider
@PreMatching
public class SecurityOverrideFilter implements ContainerRequestFilter {
    @Override
    public void filter(ContainerRequestContext requestContext) throws IOException {
        String user = requestContext.getHeaders().getFirst("User");
        String role = requestContext.getHeaders().getFirst("Role");
        if (user != null &amp;&amp; role != null) {
            requestContext.setSecurityContext(new SecurityContext() {
                @Override
                public Principal getUserPrincipal() {
                    return new Principal() {
                        @Override
                        public String getName() {
                            return user;
                        }
                    };
                }

                @Override
                public boolean isUserInRole(String r) {
                    return role.equals(r);
                }

                @Override
                public boolean isSecure() {
                    return false;
                }

                @Override
                public String getAuthenticationScheme() {
                    return "basic";
                }
            });
        }

    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="disabling-authorization"><a class="anchor" href="#disabling-authorization"></a>Disabling Authorization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you have a good reason to disable the authorization then you can register a custom <code>AuthorizationController</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Alternative
@Priority(Interceptor.Priority.LIBRARY_AFTER)
@ApplicationScoped
public class DisabledAuthController extends AuthorizationController {
    @ConfigProperty(name = "disable.authorization", defaultValue = "false")
    boolean disableAuthorization;

    @Override
    public boolean isAuthorizationEnabled() {
        return !disableAuthorization;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For manual testing Quarkus provides a convenient config property to disable authorization in dev mode. This property has the exact same effect as the custom <code>AuthorizationController</code> shown above, but is only available in dev mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.security.auth.enabled-in-dev-mode=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please also see <a href="security-testing#testing-security">TestingSecurity Annotation</a> section on how to disable the security checks using <code>TestSecurity</code> annotation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="registering-security-providers"><a class="anchor" href="#registering-security-providers"></a>Registering Security Providers</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="default-providers"><a class="anchor" href="#default-providers"></a>Default providers</h3>
<div class="paragraph">
<p>When running in native mode, the default behavior for GraalVM native executable generation is to only include the main "SUN" provider
unless you have enabled SSL, in which case all security providers are registered. If you are not using SSL, then you can selectively
register security providers by name using the <code>quarkus.security.security-providers</code> property. The following example illustrates
configuration to register the "SunRsaSign" and "SunJCE" security providers:</p>
</div>
<div class="listingblock">
<div class="title">Example Security Providers Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.security.security-providers=SunRsaSign,SunJCE</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bouncy-castle"><a class="anchor" href="#bouncy-castle"></a>BouncyCastle</h3>
<div class="paragraph">
<p>If you need to register an <code>org.bouncycastle.jce.provider.BouncyCastleProvider</code> JCE provider then please set a <code>BC</code> provider name:</p>
</div>
<div class="listingblock">
<div class="title">Example Security Providers BouncyCastle Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.security.security-providers=BC</code></pre>
</div>
</div>
<div class="paragraph">
<p>and add the BouncyCastle provider dependency:</p>
</div>
<div class="listingblock primary asciidoc-tabs-target-sync-cli asciidoc-tabs-target-sync-maven">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;
    &lt;artifactId&gt;bcprov-jdk18on&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-target-sync-gradle">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">implementation("org.bouncycastle:bcprov-jdk18on")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bouncy-castle-jsse"><a class="anchor" href="#bouncy-castle-jsse"></a>BouncyCastle JSSE</h3>
<div class="paragraph">
<p>If you need to register an <code>org.bouncycastle.jsse.provider.BouncyCastleJsseProvider</code> JSSE provider and use it instead of the default SunJSSE provider then please set a <code>BCJSSE</code> provider name:</p>
</div>
<div class="listingblock">
<div class="title">Example Security Providers BouncyCastle JSSE Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.security.security-providers=BCJSSE

quarkus.http.ssl.client-auth=REQUIRED

quarkus.http.ssl.certificate.key-store-file=server-keystore.jks
quarkus.http.ssl.certificate.key-store-password=password
quarkus.http.ssl.certificate.trust-store-file=server-truststore.jks
quarkus.http.ssl.certificate.trust-store-password=password</code></pre>
</div>
</div>
<div class="paragraph">
<p>and add the BouncyCastle TLS dependency:</p>
</div>
<div class="listingblock primary asciidoc-tabs-target-sync-cli asciidoc-tabs-target-sync-maven">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;
    &lt;artifactId&gt;bctls-jdk18on&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-target-sync-gradle">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">implementation("org.bouncycastle:bctls-jdk18on")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bouncy-castle-fips"><a class="anchor" href="#bouncy-castle-fips"></a>BouncyCastle FIPS</h3>
<div class="paragraph">
<p>If you need to register an <code>org.bouncycastle.jcajce.provider.BouncyCastleFipsProvider</code> JCE provider then please set a <code>BCFIPS</code> provider name:</p>
</div>
<div class="listingblock">
<div class="title">Example Security Providers BouncyCastle FIPS Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.security.security-providers=BCFIPS</code></pre>
</div>
</div>
<div class="paragraph">
<p>and add the BouncyCastle FIPS provider dependency:</p>
</div>
<div class="listingblock primary asciidoc-tabs-target-sync-cli asciidoc-tabs-target-sync-maven">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;
    &lt;artifactId&gt;bc-fips&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-target-sync-gradle">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">implementation("org.bouncycastle:bc-fips")</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>BCFIPS</code> provider option is supported in native image but the algorithm self-tests which rely on <code>java.security.SecureRandom</code> to verify the generated keys have been removed for these tests to pass. The following classes have been affected:
- <code>org.bouncycastle.crypto.general.DSA</code>
- <code>org.bouncycastle.crypto.general.DSTU4145</code>
- <code>org.bouncycastle.crypto.general.ECGOST3410</code>
- <code>org.bouncycastle.crypto.general.GOST3410</code>
- <code>org.bouncycastle.crypto.fips.FipsDSA</code>
- <code>org.bouncycastle.crypto.fips.FipsEC</code>
- <code>org.bouncycastle.crypto.fips.FipsRSA</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="bouncy-castle-jsse-fips"><a class="anchor" href="#bouncy-castle-jsse-fips"></a>BouncyCastle JSSE FIPS</h3>
<div class="paragraph">
<p>If you need to register an <code>org.bouncycastle.jsse.provider.BouncyCastleJsseProvider</code> JSSE provider and use it in combination with <code>org.bouncycastle.jcajce.provider.BouncyCastleFipsProvider</code> instead of the default SunJSSE provider then please set a <code>BCFIPSJSSE</code> provider name:</p>
</div>
<div class="listingblock">
<div class="title">Example Security Providers BouncyCastle FIPS JSSE Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.security.security-providers=BCFIPSJSSE

quarkus.http.ssl.client-auth=REQUIRED

quarkus.http.ssl.certificate.key-store-file=server-keystore.jks
quarkus.http.ssl.certificate.key-store-password=password
quarkus.http.ssl.certificate.key-store-file-type=BCFKS
quarkus.http.ssl.certificate.key-store-provider=BCFIPS
quarkus.http.ssl.certificate.trust-store-file=server-truststore.jks
quarkus.http.ssl.certificate.trust-store-password=password
quarkus.http.ssl.certificate.trust-store-file-type=BCFKS
quarkus.http.ssl.certificate.trust-store-provider=BCFIPS</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the BouncyCastle TLS dependency optimized for using the BouncyCastle FIPS provider:</p>
</div>
<div class="listingblock primary asciidoc-tabs-target-sync-cli asciidoc-tabs-target-sync-maven">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;
  &lt;artifactId&gt;bctls-fips&lt;/artifactId&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;
    &lt;artifactId&gt;bc-fips&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-target-sync-gradle">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">implementation("org.bouncycastle:bctls-fips")
implementation("org.bouncycastle:bc-fips")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the keystore and truststore type and provider are set to <code>BCFKS</code> and <code>BCFIPS</code>.
One can generate a keystore with this type and provider like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">keytool -genkey -alias server -keyalg RSA -keystore server-keystore.jks -keysize 2048 -keypass password -provider org.bouncycastle.jcajce.provider.BouncyCastleFipsProvider -providerpath $PATH_TO_BC_FIPS_JAR -storetype BCFKS</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>BCFIPSJSSE</code> provider option is currently not supported in native image.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sun-pkcs11"><a class="anchor" href="#sun-pkcs11"></a>SunPKCS11</h3>
<div class="paragraph">
<p><code>SunPKCS11</code> provider provides a bridge to specific <code>PKCS#11</code> implementations such as cryptographic smartcards and other Hardware Security Modules, Network Security Services in FIPS mode, etc.</p>
</div>
<div class="paragraph">
<p>Typically, in order to work with <code>SunPKCS11</code>, one needs to install a <code>PKCS#11</code> implementation, generate a configuration which usually refers to a shared library, token slot, etc and write the following Java code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.security.Provider;
import java.security.Security;

String configuration = "pkcs11.cfg"

Provider sunPkcs11 = Security.getProvider("SunPKCS11");
Provider pkcsImplementation = sunPkcs11.configure(configuration);
// or prepare configuration in the code or read it from the file such as "pkcs11.cfg" and do
// sunPkcs11.configure("--" + configuration);
Security.addProvider(pkcsImplementation);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Quarkus you can achieve the same at the configuration level only without having to modify the code, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.security.security-providers=SunPKCS11
quarkus.security.security-provider-config.SunPKCS11=pkcs11.cfg</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that while accessing the <code>SunPKCS11</code> bridge provider is supported in native image, configuring <code>SunPKCS11</code> is currently not supported in native image at the Quarkus level.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reactive-security"><a class="anchor" href="#reactive-security"></a>Reactive Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you are going to use security in a reactive environment, you will likely need SmallRye Context Propagation:</p>
</div>
<div class="listingblock primary asciidoc-tabs-target-sync-cli asciidoc-tabs-target-sync-maven">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-smallrye-context-propagation&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-target-sync-gradle">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">implementation("io.quarkus:quarkus-smallrye-context-propagation")</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will allow you to propagate the identity throughout the reactive callbacks. You also need to make sure you
are using an executor that is capable of propagating the identity (e.g. no <code>CompletableFuture.supplyAsync</code>),
to make sure that Quarkus can propagate it. For more information see the
<a href="context-propagation">Context Propagation Guide</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="observe-security-events"><a class="anchor" href="#observe-security-events"></a>Observe security events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkus beans can use <a href="cdi#events-and-observers">CDI observers</a> to consume authentication and authorization security events.
The observers can be either synchronous or asynchronous.</p>
</div>
<div class="ulist">
<div class="title">List of supported security events</div>
<ul>
<li>
<p><code>io.quarkus.security.spi.runtime.AuthenticationFailureEvent</code></p>
</li>
<li>
<p><code>io.quarkus.security.spi.runtime.AuthenticationSuccessEvent</code></p>
</li>
<li>
<p><code>io.quarkus.security.spi.runtime.AuthorizationFailureEvent</code></p>
</li>
<li>
<p><code>io.quarkus.security.spi.runtime.AuthorizationSuccessEvent</code></p>
</li>
<li>
<p><code>io.quarkus.oidc.SecurityEvent</code></p>
</li>
<li>
<p><code>io.quarkus.vertx.http.runtime.security.FormAuthenticationEvent</code></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For more information about security events specific to the Quarkus OpenID Connect extension, please see
the <a href="security-oidc-code-flow-authentication#listen-to-authentication-events">Listening to important authentication events</a>
section of the OIDC code flow mechanism for protecting web applications guide.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security;

import io.quarkus.security.spi.runtime.AuthenticationFailureEvent;
import io.quarkus.security.spi.runtime.AuthenticationSuccessEvent;
import io.quarkus.security.spi.runtime.AuthorizationFailureEvent;
import io.quarkus.security.spi.runtime.AuthorizationSuccessEvent;
import io.quarkus.security.spi.runtime.SecurityEvent;
import io.vertx.ext.web.RoutingContext;
import jakarta.enterprise.event.Observes;
import jakarta.enterprise.event.ObservesAsync;
import org.jboss.logging.Logger;

public class SecurityEventObserver {

    private static final Logger LOG = Logger.getLogger(SecurityEventObserver.class.getName());

    void observeAuthenticationSuccess(@ObservesAsync AuthenticationSuccessEvent event) {    <i class="conum" data-value="1"></i><b>(1)</b>
        LOG.debugf("User '%s' has authenticated successfully", event.getSecurityIdentity().getPrincipal().getName());
    }

    void observeAuthenticationFailure(@ObservesAsync AuthenticationFailureEvent event) {
        RoutingContext routingContext = (RoutingContext) event.getEventProperties().get(RoutingContext.class.getName());
        LOG.debugf("Authentication failed, request path: '%s'", routingContext.request().path());
    }

    void observeAuthorizationSuccess(@ObservesAsync AuthorizationSuccessEvent event) {
        String principalName = getPrincipalName(event);
        if (principalName != null) {
            LOG.debugf("User '%s' has been authorized successfully", principalName);
        }
    }

    void observeAuthorizationFailure(@Observes AuthorizationFailureEvent event) {
        LOG.debugf(event.getAuthorizationFailure(), "User '%s' authorization failed", event.getSecurityIdentity().getPrincipal().getName());
    }

    private static String getPrincipalName(SecurityEvent event) {   <i class="conum" data-value="2"></i><b>(2)</b>
        if (event.getSecurityIdentity() != null) {
            return event.getSecurityIdentity().getPrincipal().getName();
        }
        return null;
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This observer consumes all the <code>AuthenticationSuccessEvent</code> events asynchronously, which means that HTTP request processing will continue regardless on the event processing.
Depending on the application, that can be a lot of the <code>AuthenticationSuccessEvent</code> events.
For that reason, asynchronous processing can have positive effect on performance.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Common code for all supported security event types is possible because they all implement the <code>io.quarkus.security.spi.runtime.SecurityEvent</code> interface.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="references"><a class="anchor" href="#references"></a>References</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="security-overview">Quarkus Security overview</a></p>
</li>
<li>
<p><a href="security-architecture">Quarkus Security architecture</a></p>
</li>
<li>
<p><a href="security-authentication-mechanisms#other-supported-authentication-mechanisms">Authentication mechanisms in Quarkus</a></p>
</li>
<li>
<p><a href="security-identity-providers">Identity providers</a></p>
</li>
</ul>
</div>
</div>
</div>
    </div>
    <div class="grid__item width-4-12 width-12-12-m tocwrapper">
      <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#quarkus-security-dependency">Quarkus Security Dependency</a></li>
<li><a href="#httpauthenticationmechanism-customization">HttpAuthenticationMechanism Customization</a></li>
<li><a href="#dealing-with-more-than-one-http-auth-mechanisms">Dealing with more than one HttpAuthenticationMechanism</a></li>
<li><a href="#security-identity-customization">Security Identity Customization</a></li>
<li><a href="#jaxrs-security-context">Custom Jakarta REST SecurityContext</a></li>
<li><a href="#disabling-authorization">Disabling Authorization</a></li>
<li><a href="#registering-security-providers">Registering Security Providers</a>
<ul class="sectlevel2">
<li><a href="#default-providers">Default providers</a></li>
<li><a href="#bouncy-castle">BouncyCastle</a></li>
<li><a href="#bouncy-castle-jsse">BouncyCastle JSSE</a></li>
<li><a href="#bouncy-castle-fips">BouncyCastle FIPS</a></li>
<li><a href="#bouncy-castle-jsse-fips">BouncyCastle JSSE FIPS</a></li>
<li><a href="#sun-pkcs11">SunPKCS11</a></li>
</ul>
</li>
<li><a href="#reactive-security">Reactive Security</a></li>
<li><a href="#observe-security-events">Observe security events</a></li>
<li><a href="#references">References</a></li>
</ul></div>
    </div>
  </div>
  <h2>Related content</h2>
  <div class="grid-wrapper relations">
    <div class="grid__item width-6-12 width-12-12-m">
      <h3>On the same topics</h3>
      <ul class="related-content">
      
        
        <li class="concepts"><a href="/guides/security-authentication-mechanisms">Authentication mechanisms in Quarkus</a></li>
      
        
        <li class="reference"><a href="/guides/security-authorize-web-endpoints-reference">Authorization of web endpoints</a></li>
      
        
        <li class="concepts"><a href="/guides/security-basic-authentication">Basic authentication</a></li>
      
        
        <li class="guide"><a href="/guides/security-jwt-build">Build, Sign and Encrypt JSON Web Tokens</a></li>
      
        
        <li class="concepts"><a href="/guides/security-openid-connect-providers">Configuring Well-Known OpenID Connect Providers</a></li>
      
        
        <li class="guide"><a href="/guides/security-csrf-prevention">Cross-Site Request Forgery Prevention</a></li>
      
        
        <li class="howto"><a href="/guides/security-openid-connect-dev-services">Dev Services and Dev UI for OpenID Connect (OIDC)</a></li>
      
        
        <li class="howto"><a href="/guides/security-basic-authentication-howto">Enable Basic authentication</a></li>
      
        
        <li class="tutorial"><a href="/guides/security-getting-started-tutorial">Getting started with Security by using Basic authentication and Jakarta Persistence</a></li>
      
        
        <li class="concepts"><a href="/guides/security-identity-providers">Identity providers</a></li>
      
        
        <li class="reference"><a href="/guides/security-openid-connect-client-reference">OpenID Connect (OIDC) and OAuth2 client and filters</a></li>
      
        
        <li class="reference"><a href="/guides/security-openid-connect-client-registration">OpenID Connect (OIDC) and OAuth2 dynamic client registration</a></li>
      
        
        <li class="concepts"><a href="/guides/security-oidc-bearer-token-authentication">OpenID Connect (OIDC) Bearer token authentication</a></li>
      
        
        <li class="reference"><a href="/guides/security-oidc-configuration-properties-reference">OpenID Connect (OIDC) configuration properties</a></li>
      
        
        <li class="concepts"><a href="/guides/security-oidc-code-flow-authentication">OpenID Connect authorization code flow mechanism for protecting web applications</a></li>
      
        
        <li class="tutorial"><a href="/guides/security-openid-connect-client">OpenID Connect client and token propagation quickstart</a></li>
      
        
        <li class="concepts"><a href="/guides/security-proactive-authentication">Proactive authentication</a></li>
      
        
        <li class="tutorial"><a href="/guides/security-oidc-bearer-token-authentication-tutorial">Protect a service application by using OpenID Connect (OIDC) Bearer token authentication</a></li>
      
        
        <li class="tutorial"><a href="/guides/security-oidc-code-flow-authentication-tutorial">Protect a web application by using OpenID Connect (OIDC) authorization code flow</a></li>
      
        
        <li class="concepts"><a href="/guides/security-architecture">Quarkus Security architecture</a></li>
      </ul>
    </div>
    </div>
  </div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license.<br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>GitHub Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links">
          
          
            <li><a href="/" target="_blank">Home</a></li>
          
          
          
            <li><a href="/about" target="_blank">About</a></li>
          
          
          
            <li><a href="/blog" target="_blank">Blog</a></li>
          
          
          
            <li><a href="/insights" target="_blank">Podcast</a></li>
          
          
          
            <li><a href="/events" target="_blank">Events</a></li>
          
          
          
            <li><a href="/newsletter" target="_blank">Newsletter</a></li>
          
          
          
            <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" target="_blank">Roadmap</a></li>
          
          
          
            <li><a href="/security" target="_blank">Security&nbsp;policy</a></li>
          
          
          
            <li><a href="/usage" target="_blank">Usage</a></li>
          
          
          
            <li><a href="/brand" target="_blank">Brand</a></li>
          
          
          
            <li><a href="/desktopwallpapers" target="_blank">Wallpapers</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Follow Us</span>
        <ul class="footer-links">
          
          
            <li><a href="https://x.com/quarkusio" target="_blank">X</a></li>
          
          
          
            <li><a rel="me" href="https://fosstodon.org/@quarkusio" target="_blank">Mastodon</a></li>
            
          
          
            <li><a href="https://www.facebook.com/quarkusio" target="_blank">Facebook</a></li>
          
          
          
            <li><a href="https://www.linkedin.com/company/quarkusio/" target="_blank">Linkedin</a></li>
          
          
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg" target="_blank">Youtube</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio" target="_blank">GitHub</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links">
          
          
            <li><a href="/support" target="_blank">Support</a></li>
          
          
          
            <li><a href="/guides" target="_blank">Guides</a></li>
          
          
          
            <li><a href="/faq" target="_blank">FAQ</a></li>
          
          
          
            <li><a href="/get-started" target="_blank">Get Started</a></li>
          
          
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus" target="_blank">Stack Overflow</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions" target="_blank">Discussions</a></li>
          
          
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev" target="_blank">Development mailing list</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Languages</span>
        <ul class="footer-links">
          
          
            <li><a href="https://quarkus.io/" target="_blank">English</a></li>
          
          
          
            <li><a href="https://pt.quarkus.io/" target="_blank">Português&nbsp;(Brasileiro)</a></li>
          
          
          
            <li><a href="https://es.quarkus.io/" target="_blank">Español</a></li>
          
          
          
            <li><a href="https://cn.quarkus.io/" target="_blank">简体中文</a></li>
          
          
          
            <li><a href="https://ja.quarkus.io/" target="_blank">日本語</a></li>
          
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a blah href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a blah href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a blah href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a blah href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a blah href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a blah href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a blah href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a blah href="https://code.quarkus.io/" target="_blank">And many more...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
  <script src="/assets/javascript/future-date.js" type="text/javascript"></script>
</body>

</html>
