<!DOCTYPE html>
<html lang="en">







<head>
  <title>How to Secure Your A2A Server Agent with Keycloak OAuth2 - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://analytics.ossupstream.org/ https://search.quarkus.io https://smetrics.redhat.com https://ajax.googleapis.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      js.bizographics.com
      https://www.redhat.com
      https://static.redhat.com
      https://app.requestly.io/
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://giscus.app
      https://analytics.ossupstream.org/
      https://app.mailjet.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net https://www.youtube.com https://player.restream.io https://app.mailjet.com http://xy0p2.mjt.lu https://mj.quarkus.io https://giscus.app; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />

  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/blog/quarkus-a2a-java-security/" />
  <meta property="og:title" content="How to Secure Your A2A Server Agent with Keycloak OAuth2" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/blog/quarkus-a2a-java-security/">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="en" href="https://quarkus.io/blog/quarkus-a2a-java-security/" />
  
  <link rel="alternate" hreflang="pt-br" href="https://pt.quarkus.io/blog/quarkus-a2a-java-security/" />
  
  <link rel="alternate" hreflang="es" href="https://es.quarkus.io/blog/quarkus-a2a-java-security/" />
  
  <link rel="alternate" hreflang="zh" href="https://cn.quarkus.io/blog/quarkus-a2a-java-security/" />
  
  <link rel="alternate" hreflang="ja" href="https://ja.quarkus.io/blog/quarkus-a2a-java-security/" />
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />  
  <script src="/assets/javascript/tracking.js"></script>
  
  <script src="/assets/javascript/colormode.js" type="text/javascript"></script>

</head>

<body class="post">

  
  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
        <div class="logo-wrapper">
           <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="#">Why<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">WHAT IS QUARKUS?</a></li>
          <li><a href="/developer-joy" class="">DEVELOPER JOY</a></li>
          <li><a href="/performance" class="">PERFORMANCE</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">STANDARDS</a></li>
          <li><a href="/versatility" class="">VERSATILITY</a></li>
          <li><a href="/container-first" class="">CONTAINER FIRST</a></li>
          <li><a href="/spring" class="">USING SPRING?</a></li>
          <li class="tertiarydropdown">
            <span href="#">AI<i class="fas fa-chevron-down"></i></span>
            <ul class="tertiarymenu">
              <li><a href="/ai" class="">AI OVERVIEW</a></li>
              <li><a href="/java-for-ai" class="">JAVA FOR AI</a></li>
              <li><a href="/quarkus-for-ai" class="">WHY QUARKUS FOR AI</a></li>
              <li><a href="/ai-blueprints" class="">AI BLUEPRINTS</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="#">Learn<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">GET STARTED</a></li>
          <li><a href="/guides" class="">DOCUMENTATION</a></li>
          <li><a href="/userstories/" class="">USER STORIES</a></li>  
          <li><a href="/qtips" class="">"Q" TIP VIDEOS</a></li>          
          <li><a href="/books" class="">BOOKS</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="#">Extensions<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <!-- Note that quarkus.io is hardcoded here, because it is the only url which supports extensions -->
          <li><a href="https://quarkus.io/extensions/" class="">BROWSE EXTENSIONS</a></li>
          <li><a href="/faq/#what-is-a-quarkus-extension" class="">USE EXTENSIONS</a></li>
          <li><a href="/guides/writing-extensions" class="">CREATE EXTENSIONS</a></li>
          <li><a href="https://hub.quarkiverse.io" class="">SHARE EXTENSIONS</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="#">Community<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">SUPPORT</a></li>
          <li><a href="/blog" class="active">BLOG</a></li>
          <li><a href="/discussion" class="">DISCUSSION</a></li>
          <li><a href="/working-groups" class="">WORKING GROUPS</a></li>
          <li><a href="/insights" class="">PODCAST</a></li>
          <li><a href="/events" class="">EVENTS</a></li>
          <li><a href="/newsletter" class="">NEWSLETTER</a></li>
          <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" class="">ROADMAP</a></li>
          <li><a href="/benefactors" class="">BENEFACTORS</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary white">START CODING</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/blog/quarkus-a2a-java-security/" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://pt.quarkus.io/blog/quarkus-a2a-java-security/">PORTUGUÊS (BR)</a></li>
          <li><a href="https://es.quarkus.io/blog/quarkus-a2a-java-security/">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/blog/quarkus-a2a-java-security/">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/blog/quarkus-a2a-java-security/">日本語</a></li>
          </ul>
      </li>
      <li>
        <span href="#" class="modeswitcher" id='theme-toggle'><i class="fas fa-sun"></i><i class="fas fa-moon"></i><i class="fas fa-cog"></i></span>
      </li>
    </ul>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    <div class="full-width-breadcrumb-bg align-self">
  <div class="width-12-12">
      <p class="returnlink"><a href="/blog">Blog</a> <i class="fas fa-chevron-right"></i> How to Secure Your A2A Server Agent with Keycloak OAuth2</p>
  </div>
</div>

<div class="post-page grid-wrapper">
  <div class="width-8-12 width-12-12-m doc-content">
    <div class="grid-wrapper">
      <div class="width-12-12">
        <div class="post-date">
          October 28, 2025 
          
            <span class="tags"><a href="/blog/tag/ai">#ai</a><a href="/blog/tag/a2a">#a2a</a><a href="/blog/tag/security">#security</a><a href="/blog/tag/keycloak">#keycloak</a><a href="/blog/tag/oauth2">#oauth2</a></span>
          
        </div>
        <h1 class="post-title">How to Secure Your A2A Server Agent with Keycloak OAuth2</h1>
        <div class="grid-wrapper">
          <div class="width-8-12 width-12-12-m byline-wrapper">
            <p class="byline">
              By 
              
              

              
              
              
                
                
                
                  <img class="headshot" src="https://www.gravatar.com/avatar/e07a676199f6ad0af96a61a691b114b3">
                
                  <a href="/author/fjuma">Farah Juma</a>
                  
              
            </p>
          </div>
          <div class="width-12-12">
              <div class="paragraph">
<p>Today, we&#8217;ve released A2A Java SDK 0.3.0.Final which includes security and cloud related enhancements.
In this post, we&#8217;ll focus on A2A security. Stay tuned for a future post on cloud related enhancements!</p>
</div>
<div class="paragraph">
<p>The A2A protocol delegates authentication to standard mechanisms like OAuth2 and OpenID Connect. An
A2A server agent specifies its authentication requirements in its agent card so A2A clients know
what type of credentials they need to obtain and then they can pass these credentials to
the server agent when sending requests.</p>
</div>
<div class="paragraph">
<p>We&#8217;re going to walk through securing an A2A server agent with OAuth2 using Keycloak and we&#8217;ll
show how to configure an A2A client to handle token management. Our A2A server agent will be able
to support all 3 transports (JSON‑RPC, HTTP+JSON/REST, and gRPC) so we can see that the authentication
configuration is consistent across transport protocols.</p>
</div>
<div class="sect1">
<h2 id="magic-8-ball-sample"><a class="anchor" href="#magic-8-ball-sample"></a>Magic 8 Ball Sample</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To see security configuration in action, we&#8217;ll use the <a href="https://github.com/a2aproject/a2a-samples/tree/main/samples/java/agents/magic_8_ball_security">Magic 8 Ball Security sample</a>
from the <a href="https://github.com/a2aproject/a2a-samples">a2a-samples</a> repository. This sample is a simple <a href="https://github.com/a2aproject/a2a-samples/blob/main/samples/java/agents/magic_8_ball_security/server/src/main/java/com/samples/a2a/Magic8BallAgent.java">Quarkus LangChain4j AI service</a> that consults a virtual Magic 8 Ball to answer yes/no questions.</p>
</div>
<div class="sect2">
<h3 id="a2a-server-agent"><a class="anchor" href="#a2a-server-agent"></a>A2A Server Agent</h3>
<div class="paragraph">
<p>We&#8217;re going to focus specifically on the security configuration for our A2A server agent. For a detailed
description on how to turn a Quarkus LangChain4j AI Service into an A2A server agent, check
out this previous <a href="https://quarkus.io/blog/quarkus-a2a-java-grpc/">blog post</a>.</p>
</div>
<div class="sect3">
<h4 id="security-configuration"><a class="anchor" href="#security-configuration"></a>Security Configuration</h4>
<div class="paragraph">
<p>When using the A2A Java SDK reference implementations, the endpoints that need to be secured according to
the A2A specification are already annotated with <code>@Authenticated</code> for you. That means that in order to secure
your A2A server agent, you just need to specify the configuration for the specific authentication mechanism
you&#8217;d like to use. To secure our A2A server agent with OAuth2, we simply need to add a dependency on the
<code>quarkus-oidc</code> extension as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-oidc&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>NOTE</strong>: In our sample, we&#8217;re going to rely on Quarkus Dev Services to automatically create and configure
a Keycloak instance that we&#8217;ll use as our OAuth2 provider. Quarkus Dev Services relies on a container runtime
like Docker or Podman to be installed and properly configured. For more details on using Podman with
Quarkus, see this <a href="https://quarkus.io/guides/podman">guide</a>.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Now that our A2A server agent is being secured with OAuth2, we need to indicate this in our agent card
as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Produces
  @PublicAgentCard
  public AgentCard agentCard() {
    ClientCredentialsOAuthFlow clientCredentialsOAuthFlow = new ClientCredentialsOAuthFlow( <i class="conum" data-value="1"></i><b>(1)</b>
            null, <i class="conum" data-value="2"></i><b>(2)</b>
            Map.of("openid", "openid", "profile", "profile"), <i class="conum" data-value="3"></i><b>(3)</b>
            "http://localhost:" + keycloakPort + "/realms/quarkus/protocol/openid-connect/token"); <i class="conum" data-value="4"></i><b>(4)</b>
    OAuth2SecurityScheme securityScheme = new OAuth2SecurityScheme.Builder() <i class="conum" data-value="5"></i><b>(5)</b>
            .flows(new OAuthFlows.Builder().clientCredentials(clientCredentialsOAuthFlow).build())
            .build();

    return new AgentCard.Builder()
        .name("Magic 8 Ball Agent")
        .description(
            "A mystical fortune-telling agent that answers your yes/no "
                + "questions by asking the all-knowing Magic 8 Ball oracle.")
        .preferredTransport(TransportProtocol.JSONRPC.asString())
        .url("http://localhost:" + httpPort)
        .version("1.0.0")
        .documentationUrl("http://example.com/docs")
        .capabilities(
            new AgentCapabilities.Builder()
                .streaming(true)
                .pushNotifications(false)
                .stateTransitionHistory(false)
                .build())
        .defaultInputModes(List.of("text"))
        .defaultOutputModes(List.of("text"))
        .security(List.of(Map.of(OAuth2SecurityScheme.OAUTH2, <i class="conum" data-value="6"></i><b>(6)</b>
                List.of("profile"))))
        .securitySchemes(Map.of(OAuth2SecurityScheme.OAUTH2, securityScheme)) <i class="conum" data-value="7"></i><b>(7)</b>
        .skills(
            List.of(
                new AgentSkill.Builder()
                    .id("magic_8_ball")
                    .name("Magic 8 Ball Fortune Teller")
                    .description("Uses a Magic 8 Ball to answer"
                            + " yes/no questions")
                    .tags(List.of("fortune", "magic-8-ball", "oracle"))
                    .examples(
                        List.of(
                            "Should I deploy this code on Friday?",
                            "Will my tests pass?",
                            "Is this a good idea?"))
                    .build()))
        .protocolVersion("0.3.0")
        .additionalInterfaces( <i class="conum" data-value="8"></i><b>(8)</b>
            List.of(
                new AgentInterface(
                    TransportProtocol.JSONRPC.asString(),
                        "http://localhost:" + httpPort),
                new AgentInterface(
                    TransportProtocol.HTTP_JSON.asString(),
                        "http://localhost:" + httpPort),
                new AgentInterface(TransportProtocol.GRPC.asString(),
                        "localhost:" + httpPort)))
        .build();
  }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Details about the OAuth2 flow our A2A server agent supports.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We can optionally specify the URL to be used for obtaining a refresh token.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The available scopes for the OAuth2 client credentials flow. This is a map between the scope name and a description of the scope.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The token URL to be used for this flow.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Specifies an OAuth2 security scheme using the <code>ClientCredentialsOAuthFlow</code>. We&#8217;ll refer to this from the
agent card.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>A list of security requirement objects that apply to all agent interactions. Each object lists
security schemes that can be used. Follows the OpenAPI 3.0 Security Requirement Object.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>A declaration of the security schemes that can be used.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Notice that our A2A server agent supports all 3 transports: JSON-RPC, HTTP+JSON/REST, and gRPC.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="starting-the-a2a-server-agent"><a class="anchor" href="#starting-the-a2a-server-agent"></a>Starting the A2A Server Agent</h4>
<div class="paragraph">
<p>Follow the <a href="https://github.com/a2aproject/a2a-samples/tree/main/samples/java/agents/magic_8_ball_security#running-the-a2a-server-agent">instructions</a> in the sample&#8217;s README to start our A2A server agent.</p>
</div>
<div class="paragraph">
<p>A2A clients can now send queries to our A2A server agent using any of the 3 configured transports.</p>
</div>
<div class="paragraph">
<p>Now that our secured A2A server agent is up and running, let&#8217;s take a look at how to create an A2A
client that can communicate with it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2a-client"><a class="anchor" href="#a2a-client"></a>A2A Client</h3>
<div class="paragraph">
<p>The <code>magic_8_ball_security</code> sample also includes a <a href="https://github.com/a2aproject/a2a-samples/tree/main/samples/java/agents/magic_8_ball_security/client/src/main/java/com/samples/a2a/client/TestClient.java">TestClient</a> that can be used to send messages to the <code>Magic8BallAgent</code>.</p>
</div>
<div class="paragraph">
<p>For general information on how to configure A2A clients using the A2A Java SDK, check out this <a href="https://quarkus.io/blog/quarkus-a2a-java-0-3-0-alpha-release/">previous post</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="security-configuration-2"><a class="anchor" href="#security-configuration-2"></a>Security Configuration</h3>
<div class="paragraph">
<p>Because the A2A server agent our client will be communicating with is secured using OAuth2, our client
needs to be able to obtain the required token and pass it to the A2A server agent with each request.</p>
</div>
<div class="paragraph">
<p>The <code>a2a-java-sdk-client</code> dependency provided by the A2A Java SDK gives us access to a <code>Client.builder</code> that we&#8217;ll use to create our A2A client and specify the necessary authentication configuration.</p>
</div>
<div class="paragraph">
<p>The A2A Java SDK provides two main classes related to authentication:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CredentialService</code>: An interface you can implement to define how to obtain a credential for a specific security scheme.</p>
</li>
<li>
<p><code>AuthInterceptor</code>: A <code>ClientCallInterceptor</code> implementation that uses a <code>CredentialService</code> to automatically obtain and attach the required credential to client requests.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s see how to configure an A2A client using these classes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Create credential service for OAuth2 authentication
CredentialService credentialService = new KeycloakOAuth2CredentialService(); <i class="conum" data-value="1"></i><b>(1)</b>

// Create an auth interceptor to be used for all transports
AuthInterceptor authInterceptor = new AuthInterceptor(credentialService); <i class="conum" data-value="2"></i><b>(2)</b>

...

var builder = Client.builder(agentCard)
                  .addConsumers(consumers)
                  .streamingErrorHandler(streamingErrorHandler);

// Our client will optionally allow the user to specify which transport to use.
// Here, we'll add configuration for the user-specified transport. The transport
// will default to jsonrpc if not specified by the user.
switch (transport.toLowerCase()) {
  case "grpc":
    builder.withTransport(
        GrpcTransport.class,
        new GrpcTransportConfigBuilder()
            .channelFactory(channelFactory)
            .addInterceptor(authInterceptor) <i class="conum" data-value="3"></i><b>(3)</b>
            .build());
    break;
  case "rest":
    builder.withTransport(
        RestTransport.class,
        new RestTransportConfigBuilder()
            .addInterceptor(authInterceptor) <i class="conum" data-value="4"></i><b>(4)</b>
            .build());
    break;
  case "jsonrpc":
    builder.withTransport(
        JSONRPCTransport.class,
        new JSONRPCTransportConfigBuilder()
            .addInterceptor(authInterceptor) <i class="conum" data-value="5"></i><b>(5)</b>
            .build());
    break;
  default:
    throw new IllegalArgumentException("Unsupported transport type. Supported types are: grpc, rest, jsonrpc");
}

return builder.build();</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>CredentialService</code> is an interface provided by the A2A Java SDK. You can implement this interface to
obtain credentials for a given security scheme. In our sample, since the A2A server agent is being secured
with Keycloak, we have created a class called <a href="https://github.com/a2aproject/a2a-samples/tree/main/samples/java/agents/magic_8_ball_security/client/src/main/java/com/samples/a2a/client/KeycloakOAuth2CredentialService.java">KeycloakOAuth2CredentialService</a> that implements this
interface and obtains credentials for the OAuth2 security scheme using the Keycloak <code>AuthzClient</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>AuthInterceptor</code> is a class provided by the A2A Java SDK that can be used to automatically add credential
details to a request based on the security schemes supported by the A2A server agent using a <code>CredentialService</code>.
Notice that we are passing our <code>KeycloakOAuth2CredentialService</code> to the <code>AuthInterceptor</code>. We&#8217;re going to use
the same <code>AuthInterceptor</code> to specify the authentication configuration for all 3 transport protocols.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Interceptors can be configured for each transport. Here we are specifying that we want to use our <code>AuthInterceptor</code> for the gRPC transport.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>This shows how to configure the <code>AuthInterceptor</code> for the HTTP+JSON/REST transport.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>This shows how to configure the <code>AuthInterceptor</code> for the JSON-RPC transport.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With this configuration, when our A2A client attempts to sends a request to the A2A server agent,
the <code>AuthInterceptor</code> will use the A2A server&#8217;s agent card to detect its supported security schemes
and will automatically obtain the required credential for the OAuth2 security scheme using the <code>KeycloakOAuth2CredentialService</code>. The obtained token will then be included in the HTTP authorization
header for the A2A server agent to validate.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-the-a2a-client"><a class="anchor" href="#using-the-a2a-client"></a>Using the A2A Client</h3>
<div class="paragraph">
<p>The sample application contains a <code>TestClientRunner</code> that can be run using JBang:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">jbang TestClientRunner.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see output similar to this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">Connecting to agent at: http://localhost:11000
Using transport: jsonrpc
...
Sending message: Should I deploy this code on Friday?
Using jsonrpc transport with OAuth2 Bearer token
Message sent successfully. Waiting for response...
Received status-update: submitted
Received status-update: working
Received artifact-update: The Magic 8 Ball says: "Outlook good." It seems like a Friday deployment might be a good idea! What are your thoughts on that?
Received status-update: completed
Final response: The Magic 8 Ball says: "Outlook good." It seems like a Friday deployment might be a good idea! What are your thoughts on that?</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also experiment with sending different messages to the A2A server agent using the --message option as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">jbang TestClientRunner.java --message "Should I refactor this code?"</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can try using different transports (<code>jsonrpc</code>, <code>grpc</code>, or <code>rest</code>) with the --transport option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">jbang TestClientRunner.java --transport grpc</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion"><a class="anchor" href="#conclusion"></a>Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This post has shown how to configure security for both A2A server agents and A2A clients.</p>
</div>
<div class="sect2">
<h3 id="further-reading"><a class="anchor" href="#further-reading"></a>Further Reading</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/a2aproject/a2a-samples/tree/main/samples/java/agents/magic_8_ball_security">Magic 8 Ball Security Sample</a></p>
</li>
<li>
<p><a href="https://quarkus.io/blog/quarkus-a2a-java-0-3-0-alpha-release/">Getting Started with Quarkus and A2A Java SDK 0.3.0</a></p>
</li>
<li>
<p><a href="https://quarkus.io/blog/quarkus-a2a-java-0-3-0-beta-release/">A2A Java SDK: Support for the REST Transport is Now Here</a></p>
</li>
<li>
<p><a href="https://quarkus.io/blog/quarkus-a2a-java-grpc/">Getting Started with A2A Java SDK and gRPC</a></p>
</li>
<li>
<p><a href="https://github.com/a2aproject/a2a-samples/tree/main/samples/java/agents">A2A Java SDK Samples</a></p>
</li>
<li>
<p><a href="https://github.com/a2aproject/a2a-java/blob/main/README.md">A2A Java SDK Documentation</a></p>
</li>
<li>
<p><a href="https://a2a-protocol.org/latest/specification/">A2A Specification</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
              
          </div>
          <div class="width-12-12"><div class="share-page">
  <a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://quarkus.io/blog/quarkus-a2a-java-security/&title=How to Secure Your A2A Server Agent with Keycloak OAuth2" rel="nofollow" target="_blank" title="Share on LinkedIn">
    <i class="fa-brands fa-linkedin fa-xl"></i>
  </a>
  <a class="share-x" href="https://x.com/intent/tweet?text=How to Secure Your A2A Server Agent with Keycloak OAuth2&url=https://quarkus.io/blog/quarkus-a2a-java-security/&via=quarkusio&related=quarkusio" rel="nofollow" target="_blank" title="Share on X">
    <i class="fa-brands fa-square-x-twitter fa-xl"></i>
  </a>
  <a class="share-facebook" href="https://facebook.com/sharer.php?u=https://quarkus.io/blog/quarkus-a2a-java-security/" rel="nofollow" target="_blank" title="Share on Facebook">
    <i class="fa-brands fa-square-facebook fa-xl"></i>
  </a>
  <a class="share-reddit" href="http://www.reddit.com/submit?url=https://quarkus.io/blog/quarkus-a2a-java-security/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" >
    <i class="fa-brands fa-square-reddit fa-xl"></i>
  </a>
  <a class="share-email" href="mailto:?subject=How to Secure Your A2A Server Agent with Keycloak OAuth2&amp;body=How to Secure Your A2A Server Agent with Keycloak OAuth2 https://quarkus.io/blog/quarkus-a2a-java-security/" title="Share via Email" >
    <i class="fa-solid fa-envelope fa-xl"></i>
  </a>
</div>
</div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="post-page grid-wrapper">
  <div class="width-8-12 width-12-12-m doc-content">
  <script src="https://giscus.app/client.js"
        data-repo="quarkusio/quarkus"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxMzk5MTQ5MzI="
        data-category="Quarkus Blog/Website"
        data-category-id="DIC_kwDOCFbutM4CAFFV"
        data-mapping="og:title"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
  </script>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license. <i class='fab fa-creative-commons'></i><i class='fab fa-creative-commons-by'></i> <a href='https://creativecommons.org/licenses/by/3.0/' target='_blank'>CC by 3.0</a><br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>GitHub Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links">
          
          
            <li><a href="/" target="_blank">Home</a></li>
          
          
          
            <li><a href="/about" target="_blank">About</a></li>
          
          
          
            <li><a href="/blog" target="_blank">Blog</a></li>
          
          
          
            <li><a href="/insights" target="_blank">Podcast</a></li>
          
          
          
            <li><a href="/events" target="_blank">Events</a></li>
          
          
          
            <li><a href="/newsletter" target="_blank">Newsletter</a></li>
          
          
          
            <li><a href="/userstories" target="_blank">User Stories</a></li>
          
          
          
            <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" target="_blank">Roadmap</a></li>
          
          
          
            <li><a href="/security" target="_blank">Security&nbsp;policy</a></li>
          
          
          
            <li><a href="/usage" target="_blank">Usage</a></li>
          
          
          
            <li><a href="/brand" target="_blank">Brand</a></li>
          
          
          
            <li><a href="/desktopwallpapers" target="_blank">Wallpapers</a></li>
          
          
          
            <li><a href="https://www.redhat.com/en/about/privacy-policy" target="_blank">Privacy Policy</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Follow Us</span>
        <ul class="footer-links">
          
          
            <li><a href="https://x.com/quarkusio" target="_blank">X</a></li>
          
          
          
            <li><a href="https://bsky.app/profile/quarkus.io" target="_blank">Bluesky</a></li>
          
          
          
            <li><a rel="me" href="https://fosstodon.org/@quarkusio" target="_blank">Mastodon</a></li>
            
          
          
            <li><a href="https://www.threads.com/@quarkusio" target="_blank">Threads</a></li>
          
          
          
            <li><a href="https://www.facebook.com/quarkusio" target="_blank">Facebook</a></li>
          
          
          
            <li><a href="https://www.linkedin.com/company/quarkusio/" target="_blank">Linkedin</a></li>
          
          
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg" target="_blank">Youtube</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio" target="_blank">GitHub</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links">
          
          
            <li><a href="/support" target="_blank">Support</a></li>
          
          
          
            <li><a href="/guides" target="_blank">Guides</a></li>
          
          
          
            <li><a href="/faq" target="_blank">FAQ</a></li>
          
          
          
            <li><a href="/get-started" target="_blank">Get Started</a></li>
          
          
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus" target="_blank">Stack Overflow</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions" target="_blank">Discussions</a></li>
          
          
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev" target="_blank">Development mailing list</a></li>
          
          
          
            <li><a href="https://stats.uptimerobot.com/ze1PfweT2p" target="_blank">Quarkus Service Status</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Languages</span>
        <ul class="footer-links">
          
          
            <li><a href="https://quarkus.io/" target="_blank">English</a></li>
          
          
          
            <li><a href="https://pt.quarkus.io/" target="_blank">Português&nbsp;(Brasileiro)</a></li>
          
          
          
            <li><a href="https://es.quarkus.io/" target="_blank">Español</a></li>
          
          
          
            <li><a href="https://cn.quarkus.io/" target="_blank">简体中文</a></li>
          
          
          
            <li><a href="https://ja.quarkus.io/" target="_blank">日本語</a></li>
          
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a blah href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a blah href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a blah href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a blah href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a blah href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a blah href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a blah href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a blah href="https://code.quarkus.io/" target="_blank">And many more...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content cf-footer">
  <div class="flexcontainer">
    <div class="cf-logo">
      <a class="cf-logo" href="https://www.commonhaus.org/" target="_blank"><img src="https://raw.githubusercontent.com/commonhaus/artwork/main/foundation/brand/svg/CF_logo_horizontal_single_reverse.svg"/></a>
    </div>
    <div class="license">
      Copyright © Quarkus. All rights reserved. For details on our trademarks, please visit our <a href="https://www.commonhaus.org/policies/trademark-policy/">Trademark Policy</a> and <a href="https://www.commonhaus.org/trademarks/">Trademark List</a>. Trademarks of third parties are owned by their respective holders and their mention here does not suggest any endorsement or association.
    </div>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
  <script src="/assets/javascript/future-date.js" type="text/javascript"></script>
  <script src="/assets/javascript/randomize.js" type="text/javascript"></script>
  <script src="/assets/javascript/time.js" type="text/javascript"></script>
</body>

</html>
