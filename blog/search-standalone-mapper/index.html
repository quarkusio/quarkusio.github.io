<!DOCTYPE html>
<html lang="en">







<head>
  <title>Leveraging Hibernate Search capabilities in a Quarkus application without a database - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://route-default-test-mscherer-matamo.apps.ospo-osci.z3b1.p1.openshiftapps.com/ https://search.quarkus.io https://smetrics.redhat.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      js.bizographics.com
      https://www.redhat.com
      https://static.redhat.com
      https://app.requestly.io/
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://giscus.app
      https://route-default-test-mscherer-matamo.apps.ospo-osci.z3b1.p1.openshiftapps.com/
      https://app.mailjet.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net https://www.youtube.com https://embed.restream.io https://app.mailjet.com http://xy0p2.mjt.lu https://mj.quarkus.io https://giscus.app; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/blog/search-standalone-mapper/" />
  <meta property="og:title" content="Leveraging Hibernate Search capabilities in a Quarkus application without a database" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/blog/search-standalone-mapper/">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="en" href="https://quarkus.io/blog/search-standalone-mapper/" />
  
  <link rel="alternate" hreflang="pt-br" href="https://pt.quarkus.io/blog/search-standalone-mapper/" />
  
  <link rel="alternate" hreflang="es" href="https://es.quarkus.io/blog/search-standalone-mapper/" />
  
  <link rel="alternate" hreflang="zh" href="https://cn.quarkus.io/blog/search-standalone-mapper/" />
  
  <link rel="alternate" hreflang="ja" href="https://ja.quarkus.io/blog/search-standalone-mapper/" />
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />  
  <script src="/assets/javascript/tracking.js"></script>
  
  <script src="/assets/javascript/colormode.js" type="text/javascript"></script>

</head>

<body class="post">

  
  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
        <div class="logo-wrapper">
           <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/about/">Why<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">WHAT IS QUARKUS?</a></li>
          <li><a href="/container-first" class="">CONTAINER FIRST</a></li>
          <li><a href="/continuum" class="">VERSATILITY</a></li>
          <li><a href="/developer-joy" class="">DEVELOPER JOY</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">STANDARDS</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/learn/">Learn<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">GET STARTED</a></li>
          <li><a href="/guides" class="">DOCUMENTATION</a></li>
          <li><a href="/qtips" class="">"Q" TIP VIDEOS</a></li>          
          <li><a href="/books" class="">BOOKS</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="https://quarkus.io/extensions/">Extensions<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <!-- Note that quarkus.io is hardcoded here, because it is the only url which supports extensions -->
          <li><a href="https://quarkus.io/extensions/" class="">BROWSE EXTENSIONS</a></li>
          <li><a href="/faq/#what-is-a-quarkus-extension" class="">USE EXTENSIONS</a></li>
          <li><a href="/guides/writing-extensions" class="">CREATE EXTENSIONS</a></li>
          <li><a href="https://hub.quarkiverse.io" class="">SHARE EXTENSIONS</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/community/">Community<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">SUPPORT</a></li>
          <li><a href="/blog" class="active">BLOG</a></li>
          <li><a href="/discussion" class="">DISCUSSION</a></li>
          <li><a href="/working-groups" class="">WORKING GROUPS</a></li>
          <li><a href="/insights" class="">PODCAST</a></li>
          <li><a href="/events" class="">EVENTS</a></li>
          <li><a href="/newsletter" class="">NEWSLETTER</a></li>
          <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" class="">ROADMAP</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary white">START CODING</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/blog/search-standalone-mapper/" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://pt.quarkus.io/blog/search-standalone-mapper/">PORTUGUÊS (BR)</a></li>
          <li><a href="https://es.quarkus.io/blog/search-standalone-mapper/">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/blog/search-standalone-mapper/">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/blog/search-standalone-mapper/">日本語</a></li>
          </ul>
      </li>
      <li>
        <span href="#" class="modeswitcher" id='theme-toggle'><i class="fas fa-sun"></i><i class="fas fa-moon"></i><i class="fas fa-cog"></i></span>
      </li>
    </ul>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    <div class="full-width-breadcrumb-bg align-self">
  <div class="width-12-12">
      <p class="returnlink"><a href="/blog">Blog</a> <i class="fas fa-chevron-right"></i> Leveraging Hibernate Search capabilities in a Quarkus application without a database</p>
  </div>
</div>

<div class="post-page grid-wrapper">
  <div class="width-8-12 width-12-12-m doc-content">
    <div class="grid-wrapper">
      <div class="width-12-12">
        <div class="post-date">
          August 01, 2024 
          
            <span class="tags"><a href="/blog/tag/hibernate">#hibernate</a><a href="/blog/tag/search">#search</a><a href="/blog/tag/howto">#howto</a></span>
          
        </div>
        <h1 class="post-title">Leveraging Hibernate Search capabilities in a Quarkus application without a database</h1>
        <div class="grid-wrapper">
          <div class="width-8-12 width-12-12-m byline-wrapper">
            
            
              <img class="headshot" src="https://www.gravatar.com/avatar/2934f00ba9190bc06cf03fde5b50c61d">
            
            <p class="byline">By <a href="/author/markobekhta">Marko Bekhta</a></p>
          </div>
          <div class="width-12-12">
              <div class="paragraph">
<p>This is the second post in the series diving into the implementation details of the
<a href="https://github.com/quarkusio/search.quarkus.io">application</a> backing the guide search of
<a href="https://quarkus.io/guides/">quarkus.io</a>.</p>
</div>
<div class="paragraph">
<p>Hibernate Search is mainly known for its <a href="{quarkus-hibernate-search-docs-url}">integration with Hibernate ORM</a>,
where it can detect the entity changes made through ORM and reflect them in the search indexes. But there is more to
Hibernate Search than that.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/assets/images/posts/search-standalone-mapper/search-orm.png" alt="search orm">
</div>
<div class="title">Figure 1. Hibernate Search integration with Hibernate ORM</div>
</div>
<div class="paragraph">
<p>Not all applications that require search capabilities rely on databases to provide the source for the search indexes.
Some applications rely on a NOSQL store where Hibernate ORM is not applicable, or even flat file storage.
What can be done in these scenarios?</p>
</div>
<div class="paragraph">
<p>That&#8217;s where the <a href="https://quarkus.io/guides/hibernate-search-standalone-elasticsearch">Hibernate Search Standalone mapper</a> can come in handy.
It was <a href="https://quarkus.io/blog/quarkus-3-10-0-released/">recently</a> included as one of the Quarkus core extensions.
This mapper allows domain entities to be annotated with Hibernate Search annotations and then uses
the Search DSL&#8217;s power to perform search operations and more.</p>
</div>
<div class="paragraph">
<p>With the release 3.10 of Quarkus, we&#8217;ve migrated our Quarkus application that backs the guides'
search of <a href="https://quarkus.io/guides/">quarkus.io/guides/</a> to the Standalone mapper and would like to share with you
how to use this mapper to index the data coming from files and without knowing the total number of
records to index.
Please refer to the <a href="https://quarkus.io/guides/hibernate-search-standalone-elasticsearch">guide</a> for a more in depth review of how to configure and use the mapper.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/assets/images/posts/search-standalone-mapper/search-standalone.png" alt="search standalone">
</div>
<div class="title">Figure 2. Hibernate Search Standalone mapper</div>
</div>
<div class="paragraph">
<p>Let&#8217;s start by describing the task that this search application has to perform. The application&#8217;s main goal is to
provide search capabilities over the documentation guides.
It obtains the required information about these guides from reading multiple files.
We want to read the data just once, start indexing as soon as we can, and keep only as many records in memory as strictly necessary.
We would also want to monitor the progress and report any exceptions that may occur during the indexing process.
Hence, we would want to create a finite stream of data that we would feed
to a <a href="https://docs.jboss.org/hibernate/search/7.1/reference/en-US/html_single/#indexing-massindexer-basics">mass indexer</a>,
which will create the documents in the search index that we will later use to perform search operations.</p>
</div>
<div class="paragraph">
<p>Generally speaking, mass indexing can be as simple as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
SearchMapping searchMapping; <i class="conum" data-value="1"></i><b>(1)</b>
// ...

var future = searchMapping.scope(Object.class) <i class="conum" data-value="2"></i><b>(2)</b>
    .massIndexer() <i class="conum" data-value="3"></i><b>(3)</b>
    .start(); <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Inject <code>SearchMapping</code> somewhere in your app so that it can be used to access Hibernate Search capabilities.</p>
</li>
<li>
<p>Create a scope targeting the entities that we plan to reindex.
In this case, all indexed entities should be targeted; hence, the <code>Object.class</code> can be used to create the scope.</p>
</li>
<li>
<p>Create a mass indexer with the default configuration.</p>
</li>
<li>
<p>Start the indexing process. Starting the process returns a future; the indexing happens in the background.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For Hibernate Search to perform this operation, we must tell it how to load the indexed entities.
We will use an <code>EntityLoadingBinder</code> to do that. It is a simple interface providing access to the binding context
where we can define selection-loading strategies (for search) and mass-loading strategies (for indexing).
Since, in our case, we are only interested in the mass indexer, it would be enough only to define the mass loading strategy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class GuideLoadingBinder implements EntityLoadingBinder {

    @Override
    public void bind(EntityLoadingBindingContext context) { <i class="conum" data-value="1"></i><b>(1)</b>
        context.massLoadingStrategy(Guide.class, new MassLoadingStrategy&lt;Guide, Guide&gt;() { <i class="conum" data-value="2"></i><b>(2)</b>
            // ...
        });
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Implement the single <code>bind(..)</code> method of the <code>EntityLoadingBinder</code>.</p>
</li>
<li>
<p>Specify the mass loading strategy for the <code>Guide</code> search entity.
We&#8217;ll discuss the implementation of the strategy later in this post.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>And then, with the entity loading binder defined, we can simply reference it within the <code>@SearchEntity</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@SearchEntity(loadingBinder = @EntityLoadingBinderRef(type = GuideLoadingBinder.class)) <i class="conum" data-value="1"></i><b>(1)</b>
@Indexed( ... )
public class Guide {
    @DocumentId
    public URI url;

    // other fields annotated with various Hibernate Search annotations,
    // e.g. @KeywordField/@FullTextField.
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Reference the loading binder implementation by the type.
As with many other Hibernate Search components,
a CDI bean reference can be used here instead by providing the bean name,
for example, if the loading binder requires access to some CDI beans and is a CDI bean itself.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>That is all that is needed to tie things together.
The only open question is how to implement the mass loading strategy.
Let&#8217;s first review how the mass indexer works on a high level:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/assets/images/posts/search-standalone-mapper/mass-indexer.png" alt="mass indexer">
</div>
<div class="title">Figure 3. High level mass indexer flow</div>
</div>
<div class="paragraph">
<p>Implementing the mass loading strategy requires providing an identifier and entity loaders.
As already mentioned, in our case, we want a data stream that reads the information from files and does the reading part just once.
Hence, we want to avoid decoupling the id/entity reading steps.
While the identifier loader&#8217;s contract suggests that it should provide the batch of identifiers to the sink,
nothing prevents us from passing a batch of actual entity instance instead.
It is acceptable to do in this case since we are only interested in the mass loading;
we are not implementing a selection loading strategy that would be used when searching.
Now, if the identifier loader provides actual entity instances, the entity loader has nothing more to do
than just pass through the batch of received "identifiers", which are actual entities, to the entity sink.</p>
</div>
<div class="paragraph">
<p>With that in mind, the mass-loading strategy may be implemented as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">new MassLoadingStrategy&lt;Guide, Guide&gt;() {
    @Override
    public MassIdentifierLoader createIdentifierLoader(LoadingTypeGroup&lt;Guide&gt; includedTypes,
            MassIdentifierSink&lt;Guide&gt; sink, MassLoadingOptions options) {
            // ...  <i class="conum" data-value="1"></i><b>(1)</b>
        };
    }

    @Override
    public MassEntityLoader&lt;Guide&gt; createEntityLoader(LoadingTypeGroup&lt;Guide&gt; includedTypes,
            MassEntitySink&lt;Guide&gt; sink,
            MassLoadingOptions options) {
        return new MassEntityLoader&lt;Guide&gt;() { <i class="conum" data-value="2"></i><b>(2)</b>
            @Override
            public void close() {
                // noting to do
            }

            @Override
            public void load(List&lt;Guide&gt; guides) throws InterruptedException {
                sink.accept(guides); <i class="conum" data-value="3"></i><b>(3)</b>
            }
        };
    }
})</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>We&#8217;ll look at the implementation of the identifier loader in the following code snippet as
it is slightly trickier than the pass-through entity loader.
Hence, we would want to take a closer look at it.</p>
</li>
<li>
<p>An implementation of the pass-through entity loader.</p>
</li>
<li>
<p>As explained above, we treat the search entities as identifiers and simply pass the entities we receive to the sink.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If passing entities as identifiers feels like a hack, it&#8217;s because it is.
Hibernate Search will, at some point, provide alternative APIs to achieve this more elegantly: <a href="https://hibernate.atlassian.net/browse/HSEARCH-5209">HSEARCH-5209</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since the guide search entities are constructed from the information read from a file,
we have to somehow pass the stream of these guides to the identifier loader.
We could do this by using the <code>MassLoadingOptions options</code>.
These mass loading options provide access to the context objects passed to the mass indexer by the user.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
SearchMapping searchMapping; <i class="conum" data-value="1"></i><b>(1)</b>
// ...

var future = searchMapping.scope(Object.class) <i class="conum" data-value="2"></i><b>(2)</b>
    .context(GuideLoadingContext.class, guideLoadingContext) <i class="conum" data-value="3"></i><b>(3)</b>
    // ... <i class="conum" data-value="4"></i><b>(4)</b>
    .massIndexer() <i class="conum" data-value="5"></i><b>(5)</b>
    .start(); <i class="conum" data-value="6"></i><b>(6)</b></code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Inject <code>SearchMapping</code> somewhere in your application.</p>
</li>
<li>
<p>Create a scope, as usual.</p>
</li>
<li>
<p>Pass the context object to the mass indexer that knows how to read the files,
and is able to provide the batches of <code>Guide</code> search entities. See the following code snippet
for an example of how such context can be implemented.</p>
</li>
<li>
<p>Set any other mass indexer configuration options as needed.</p>
</li>
<li>
<p>Create a mass indexer.</p>
</li>
<li>
<p>Start the indexing process.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class GuideLoadingContext {

    private final Iterator&lt;Guide&gt; guides;

    GuideLoadingContext(Stream&lt;Guide&gt; guides) {
        this.guides = guides.iterator(); <i class="conum" data-value="1"></i><b>(1)</b>
    }

    public List&lt;Guide&gt; nextBatch(int batchSize) {
        List&lt;Guide&gt; list = new ArrayList&lt;&gt;();
        for (int i = 0; guides.hasNext() &amp;&amp; i &lt; batchSize; i++) {
            list.add(guides.next()); <i class="conum" data-value="2"></i><b>(2)</b>
        }
        return list;
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get an iterator from the finite data stream of guides.</p>
</li>
<li>
<p>Read the next batch of the guides from the iterator. We are using the batch size limit
that we will retrieve from the mass-loading options
and checking the iterator to see if there are any more entities to pull.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now, having the way of reading the entities in batches from the stream
and knowing how to pass it to the mass indexer, implementing the identifier loader
can be as easy as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
public MassIdentifierLoader createIdentifierLoader(LoadingTypeGroup&lt;Guide&gt; includedTypes,
        MassIdentifierSink&lt;Guide&gt; sink, MassLoadingOptions options) {
    var context = options.context(GuideLoadingContext.class); <i class="conum" data-value="1"></i><b>(1)</b>
    return new MassIdentifierLoader() {
        @Override
        public void close() {
            // nothing to do
        }

        @Override
        public long totalCount() {
            return 0; <i class="conum" data-value="2"></i><b>(2)</b>
        }

        @Override
        public void loadNext() throws InterruptedException {
            List&lt;Guide&gt; batch = context.nextBatch(options.batchSize()); <i class="conum" data-value="3"></i><b>(3)</b>
            if (batch.isEmpty()) {
                sink.complete();  <i class="conum" data-value="4"></i><b>(4)</b>
            } else {
                sink.accept(batch); <i class="conum" data-value="5"></i><b>(5)</b>
            }
        }
    };
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Retrieve the guide loading context that is expected to be passed to the mass indexer.
(e.g. <code>.context(GuideLoadingContext.class, guideLoadingContext)</code>)</p>
</li>
<li>
<p>We do not know how many guides there will be until we finish reading all the files
and completing the indexing, so we&#8217;ll just pass <code>0</code> here.</p>
<div class="paragraph">
<p>The information is not critical: it&#8217;s only used to monitor progress.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is one of the areas that we plan to improve;
see <a href="https://hibernate.atlassian.net/browse/HSEARCH-5180">one of the improvements we are currently working on</a>.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Request the next batch of guides. <code>options.batchSize()</code> will provide us with the value configured
for the current mass indexer.</p>
</li>
<li>
<p>If the batch is empty, it means that the stream iterator has no more guides to return.
Hence, we can notify the mass indexing sink that no more items will be provided by calling <code>.complete()</code>.</p>
</li>
<li>
<p>If there are any guides in the loaded batch, we&#8217;ll pass them to the sink to be processed.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To sum up, here is a summary of the steps to take to index an unknown number of search entities from a datasource
while reading each entity only once, and without relying on lookups by identifier:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start by creating a loader binder and let Hibernate Search know about it via the <code>@SearchEntity</code> annotation.</p>
</li>
<li>
<p>Implement a mass loading strategy (<code>MassLoadingStrategy</code>) that includes:</p>
<div class="ulist">
<ul>
<li>
<p>An identifier loader that does all the heavy lifting and actually constructs entire entities.</p>
</li>
<li>
<p>An entity loader that simply passes through the entities loaded by the identifier loader to the indexing sink.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Supply through the mass indexer context any helpful services, resources, helpers, etc., that are used to load the data.
And access them in the loaders through <code>options.context(..);</code></p>
</li>
<li>
<p>With everything in place, run the mass indexing as usual.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For a complete working example of this approach, check out the
<a href="https://github.com/quarkusio/search.quarkus.io">search.quarkus.io on GitHub</a>.</p>
</div>
<div class="paragraph">
<p>Please note that some of the features discussed in this post are still incubating
and may change in the future.
In particular, we&#8217;ve already identified and are working on possible <a href="https://hibernate.atlassian.net/browse/HSEARCH-5180">improvements</a>
for mass indexing of a finite data stream, where the total size of entities is unknown beforehand.
If you find the approach described in the post interesting
and have similar use cases, we encourage you to give it a try.
Feel free to reach out to us to discuss your ideas and suggestions for other improvements, if any.</p>
</div>
<div class="paragraph">
<p>Stay tuned for more details in the coming weeks as we publish more blog posts
exploring other interesting implementation aspects of this application.
Happy searching and mass indexing!</p>
</div>
              
          </div>
          <div class="width-12-12"><div class="share-page">
  <a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://quarkus.io/blog/search-standalone-mapper/&title=Leveraging Hibernate Search capabilities in a Quarkus application without a database" rel="nofollow" target="_blank" title="Share on LinkedIn">
    <i class="fa-brands fa-linkedin fa-xl"></i>
  </a>
  <a class="share-x" href="https://x.com/intent/tweet?text=Leveraging Hibernate Search capabilities in a Quarkus application without a database&url=https://quarkus.io/blog/search-standalone-mapper/&via=quarkusio&related=quarkusio" rel="nofollow" target="_blank" title="Share on X">
    <i class="fa-brands fa-square-x-twitter fa-xl"></i>
  </a>
  <a class="share-facebook" href="https://facebook.com/sharer.php?u=https://quarkus.io/blog/search-standalone-mapper/" rel="nofollow" target="_blank" title="Share on Facebook">
    <i class="fa-brands fa-square-facebook fa-xl"></i>
  </a>
  <a class="share-reddit" href="http://www.reddit.com/submit?url=https://quarkus.io/blog/search-standalone-mapper/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" >
    <i class="fa-brands fa-square-reddit fa-xl"></i>
  </a>
  <a class="share-email" href="mailto:?subject=Leveraging Hibernate Search capabilities in a Quarkus application without a database&amp;body=Leveraging Hibernate Search capabilities in a Quarkus application without a database https://quarkus.io/blog/search-standalone-mapper/" title="Share via Email" >
    <i class="fa-solid fa-envelope fa-xl"></i>
  </a>
</div>
</div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="post-page grid-wrapper">
  <div class="width-8-12 width-12-12-m doc-content">
  <script src="https://giscus.app/client.js"
        data-repo="quarkusio/quarkus"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxMzk5MTQ5MzI="
        data-category="Quarkus Blog/Website"
        data-category-id="DIC_kwDOCFbutM4CAFFV"
        data-mapping="og:title"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
  </script>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license.<br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>GitHub Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links">
          
          
            <li><a href="/" target="_blank">Home</a></li>
          
          
          
            <li><a href="/about" target="_blank">About</a></li>
          
          
          
            <li><a href="/blog" target="_blank">Blog</a></li>
          
          
          
            <li><a href="/insights" target="_blank">Podcast</a></li>
          
          
          
            <li><a href="/events" target="_blank">Events</a></li>
          
          
          
            <li><a href="/newsletter" target="_blank">Newsletter</a></li>
          
          
          
            <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" target="_blank">Roadmap</a></li>
          
          
          
            <li><a href="/security" target="_blank">Security&nbsp;policy</a></li>
          
          
          
            <li><a href="/usage" target="_blank">Usage</a></li>
          
          
          
            <li><a href="/brand" target="_blank">Brand</a></li>
          
          
          
            <li><a href="/desktopwallpapers" target="_blank">Wallpapers</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Follow Us</span>
        <ul class="footer-links">
          
          
            <li><a href="https://x.com/quarkusio" target="_blank">X</a></li>
          
          
          
            <li><a rel="me" href="https://fosstodon.org/@quarkusio" target="_blank">Mastodon</a></li>
            
          
          
            <li><a href="https://www.facebook.com/quarkusio" target="_blank">Facebook</a></li>
          
          
          
            <li><a href="https://www.linkedin.com/company/quarkusio/" target="_blank">Linkedin</a></li>
          
          
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg" target="_blank">Youtube</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio" target="_blank">GitHub</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links">
          
          
            <li><a href="/support" target="_blank">Support</a></li>
          
          
          
            <li><a href="/guides" target="_blank">Guides</a></li>
          
          
          
            <li><a href="/faq" target="_blank">FAQ</a></li>
          
          
          
            <li><a href="/get-started" target="_blank">Get Started</a></li>
          
          
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus" target="_blank">Stack Overflow</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions" target="_blank">Discussions</a></li>
          
          
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev" target="_blank">Development mailing list</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Languages</span>
        <ul class="footer-links">
          
          
            <li><a href="https://quarkus.io/" target="_blank">English</a></li>
          
          
          
            <li><a href="https://pt.quarkus.io/" target="_blank">Português&nbsp;(Brasileiro)</a></li>
          
          
          
            <li><a href="https://es.quarkus.io/" target="_blank">Español</a></li>
          
          
          
            <li><a href="https://cn.quarkus.io/" target="_blank">简体中文</a></li>
          
          
          
            <li><a href="https://ja.quarkus.io/" target="_blank">日本語</a></li>
          
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a blah href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a blah href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a blah href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a blah href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a blah href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a blah href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a blah href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a blah href="https://code.quarkus.io/" target="_blank">And many more...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
  <script src="/assets/javascript/future-date.js" type="text/javascript"></script>
</body>

</html>
