<!DOCTYPE html>
<html lang="en">







<head>
  <title>Agentic AI with Quarkus - part 2 - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://analytics.ossupstream.org/ https://search.quarkus.io https://smetrics.redhat.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      js.bizographics.com
      https://www.redhat.com
      https://static.redhat.com
      https://app.requestly.io/
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://giscus.app
      https://analytics.ossupstream.org/
      https://app.mailjet.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net https://www.youtube.com https://player.restream.io https://app.mailjet.com http://xy0p2.mjt.lu https://mj.quarkus.io https://giscus.app; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/blog/agentic-ai-with-quarkus-p2/" />
  <meta property="og:title" content="Agentic AI with Quarkus - part 2" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/blog/agentic-ai-with-quarkus-p2/">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="en" href="https://quarkus.io/blog/agentic-ai-with-quarkus-p2/" />
  
  <link rel="alternate" hreflang="pt-br" href="https://pt.quarkus.io/blog/agentic-ai-with-quarkus-p2/" />
  
  <link rel="alternate" hreflang="es" href="https://es.quarkus.io/blog/agentic-ai-with-quarkus-p2/" />
  
  <link rel="alternate" hreflang="zh" href="https://cn.quarkus.io/blog/agentic-ai-with-quarkus-p2/" />
  
  <link rel="alternate" hreflang="ja" href="https://ja.quarkus.io/blog/agentic-ai-with-quarkus-p2/" />
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />  
  <script src="/assets/javascript/tracking.js"></script>
  
  <script src="/assets/javascript/colormode.js" type="text/javascript"></script>

</head>

<body class="post">

  
  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
        <div class="logo-wrapper">
           <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/about/">Why<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">WHAT IS QUARKUS?</a></li>
          <li><a href="/developer-joy" class="">DEVELOPER JOY</a></li>
          <li><a href="/performance" class="">PERFORMANCE</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">STANDARDS</a></li>
          <li><a href="/versatility" class="">VERSATILITY</a></li>
          <li><a href="/container-first" class="">CONTAINER FIRST</a></li>          
        </ul>
      </li>
      <li class="dropdown">
        <span href="/learn/">Learn<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">GET STARTED</a></li>
          <li><a href="/guides" class="">DOCUMENTATION</a></li>
          <li><a href="/userstories/" class="">USER STORIES</a></li>  
          <li><a href="/qtips" class="">"Q" TIP VIDEOS</a></li>          
          <li><a href="/books" class="">BOOKS</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="https://quarkus.io/extensions/">Extensions<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <!-- Note that quarkus.io is hardcoded here, because it is the only url which supports extensions -->
          <li><a href="https://quarkus.io/extensions/" class="">BROWSE EXTENSIONS</a></li>
          <li><a href="/faq/#what-is-a-quarkus-extension" class="">USE EXTENSIONS</a></li>
          <li><a href="/guides/writing-extensions" class="">CREATE EXTENSIONS</a></li>
          <li><a href="https://hub.quarkiverse.io" class="">SHARE EXTENSIONS</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/community/">Community<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">SUPPORT</a></li>
          <li><a href="/blog" class="active">BLOG</a></li>
          <li><a href="/discussion" class="">DISCUSSION</a></li>
          <li><a href="/working-groups" class="">WORKING GROUPS</a></li>
          <li><a href="/insights" class="">PODCAST</a></li>
          <li><a href="/events" class="">EVENTS</a></li>
          <li><a href="/newsletter" class="">NEWSLETTER</a></li>
          <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" class="">ROADMAP</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary white">START CODING</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/blog/agentic-ai-with-quarkus-p2/" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://pt.quarkus.io/blog/agentic-ai-with-quarkus-p2/">PORTUGUÊS (BR)</a></li>
          <li><a href="https://es.quarkus.io/blog/agentic-ai-with-quarkus-p2/">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/blog/agentic-ai-with-quarkus-p2/">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/blog/agentic-ai-with-quarkus-p2/">日本語</a></li>
          </ul>
      </li>
      <li>
        <span href="#" class="modeswitcher" id='theme-toggle'><i class="fas fa-sun"></i><i class="fas fa-moon"></i><i class="fas fa-cog"></i></span>
      </li>
    </ul>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    <div class="full-width-breadcrumb-bg align-self">
  <div class="width-12-12">
      <p class="returnlink"><a href="/blog">Blog</a> <i class="fas fa-chevron-right"></i> Agentic AI with Quarkus - part 2</p>
  </div>
</div>

<div class="post-page grid-wrapper">
  <div class="width-8-12 width-12-12-m doc-content">
    <div class="grid-wrapper">
      <div class="width-12-12">
        <div class="post-date">
          February 20, 2025 
          
            <span class="tags"><a href="/blog/tag/ai">#ai</a><a href="/blog/tag/llm">#llm</a><a href="/blog/tag/agents">#agents</a></span>
          
        </div>
        <h1 class="post-title">Agentic AI with Quarkus - part 2</h1>
        <div class="grid-wrapper">
          <div class="width-8-12 width-12-12-m byline-wrapper">
            
            
              <img class="headshot" src="https://www.gravatar.com/avatar/48dfeef188c592772a5a0bcbdea7b7df">
            
            <p class="byline">By <a href="/author/mariofusco">Mario Fusco</a></p>
          </div>
          <div class="width-12-12">
              <div class="paragraph">
<p>The <a href="https://quarkus.io/blog/agentic-ai-with-quarkus/">first part</a> of this blog post series briefly introduced agentic AI and discussed workflow patterns.
This post will explore another kind of pattern: <em>agents</em>.
The main difference between the two is that workflow patterns are defined programmatically, while agents are more flexible and can handle a broader range of tasks.
With agents, the LLM orchestrates the sequence of steps instead of being externally orchestrated programmatically, thus reaching a higher level of autonomy and flexibility.</p>
</div>
<div class="sect1">
<h2 id="agents"><a class="anchor" href="#agents"></a>Agents</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Agents differ from the workflow patterns because the control flow is entirely delegated to LLMs instead of being implemented programmatically.
To successfully implement agents, the LLM must be able to reason and have access to a set of tools (<em>toolbox</em>).
The LLM orchestrates the sequence of steps and decides which tools to call with which parameters.
From an external point of view, invoking an agent can be seen as invoking a function that opportunistically invokes tools to complete determinate subtasks.</p>
</div>
<div class="paragraph">
<p>The agent&#8217;s toolbox can be composed of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>External services (like HTTP endpoints)</p>
</li>
<li>
<p>Other LLM / agents</p>
</li>
<li>
<p>Methods providing data from a data store</p>
</li>
<li>
<p>Methods provided by the application code itself</p>
</li>
</ul>
</div>
<div class="imageblock text-center text-center">
<div class="content">
<img src="/assets/images/posts/agentic/agent.png" alt="Agents can invoke tools" width="50%">
</div>
<div class="title">Figure 1. Agents can invoke tools</div>
</div>
<div class="paragraph">
<p>In Quarkus, agents are represented by interfaces annotated with <code>@RegisterAiService.</code>
They are called <em>AI services</em>.
In that aspect, they are not different from the <em>workflow patterns</em>.
The main difference is that the methods of an agent interface are annotated with <code>@ToolBox</code> to declare the tools that the LLM can use to complete the task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RegisterAiService(modelName = "my-model")  // &lt;-- The model used by this agent must be able to reason and decide which tools to call
@SystemMessage("...")
public interface RestaurantAgent {

    @UserMessage("...")
    @ToolBox({BookingService.class, WeatherService.class}) // &lt;-- The tools that the LLM can use
    String handleRequest(String request);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, the <code>@RegisterAiService</code> annotation can receive the set of tools in its <code>tools</code> parameter.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at some examples of agents to understand better how they work and what they can achieve.</p>
</div>
<div class="sect2">
<h3 id="the-weather-forecast-agent"><a class="anchor" href="#the-weather-forecast-agent"></a>The weather forecast agent</h3>
<div class="paragraph">
<p>This <a href="https://github.com/mariofusco/quarkus-agentic-ai/blob/main/src/main/java/org/agenticai/aiastool">first example</a> of agentic AI implements the following <a href="https://github.com/mariofusco/quarkus-agentic-ai/blob/main/src/main/java/org/agenticai/aiastool/WeatherForecastAgent.java">weather forecast agent</a>.
The agent receives a user prompt and must answer questions about the weather using at most three lines.
To achieve this goal, the agent has a toolbox containing:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>An AI service specialized in extracting the name of a city from the user&#8217;s prompt - which can be another <em>agent</em>;</p>
</li>
<li>
<p>A web service returning the geographic coordinates of a given city - this is a remote call;</p>
</li>
<li>
<p>A second web service providing the weather forecast for the given latitude and longitude - another remote call.</p>
</li>
</ol>
</div>
<div class="imageblock text-center text-center">
<div class="content">
<img src="/assets/images/posts/agentic/weather-agent.png" alt="Weather agent architecture" width="80%">
</div>
<div class="title">Figure 2. Weather agent architecture</div>
</div>
<div class="paragraph">
<p>We do not indicate when and how these tools are used; we just add them to the toolbox.
The LLM decides when to call them and with which parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RegisterAiService(modelName = "tool-use")
public interface WeatherForecastAgent {

    @SystemMessage("""
        You are a meteorologist, and you need to answer questions asked by the user about weather using at most 3 lines.

        The weather information is a JSON object and has the following fields:

        maxTemperature is the maximum temperature of the day in Celsius degrees
        minTemperature is the minimum temperature of the day in Celsius degrees
        precipitation is the amount of water in mm
        windSpeed is the speed of wind in kilometers per hour
        weather is the overall weather.
    """)
    @ToolBox({CityExtractorAgent.class, WeatherForecastService.class, GeoCodingService.class})
    String chat(String query);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s see how are defined the tools used by this agent:</p>
</div>
<div class="paragraph">
<p>1 . <a href="https://github.com/mariofusco/quarkus-agentic-ai/blob/main/src/main/java/org/agenticai/aiastool/CityExtractorAgent.java">Another AI Service</a> specialized in extracting the name of a city from the user&#8217;s prompt (thus also demonstrating how easily an <em>agent</em> can be configured to become a tool for another AI service/agent).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
@RegisterAiService(chatMemoryProviderSupplier = RegisterAiService.NoChatMemoryProviderSupplier.class)
public interface CityExtractorAgent {

    @UserMessage("""
        You are given one question and you have to extract city name from it
        Only reply the city name if it exists or reply 'unknown_city' if there is no city name in question

        Here is the question: {question}
        """)
    @Tool("Extracts the city from a question") // &lt;-- The tool description, the LLM can use it to decide when to call this tool
    String extractCity(String question); // &lt;-- The method signature, the LLM use it to know how to call this tool
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>2 . A <a href="https://github.com/mariofusco/quarkus-agentic-ai/blob/main/src/main/java/org/agenticai/aiastool/geo/GeoCodingService.java">web service</a> returning the geographic coordinates of a given city.
It&#8217;s a simple Quarkus REST client interface, meaning that Quarkus automatically generates the actual implementation.
It can be combined with fault tolerance, metrics, and other Quarkus features.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RegisterRestClient(configKey = "geocoding")
@Path("/v1")
public interface GeoCodingService {

    @GET
    @Path("/search")
    @ClientQueryParam(name = "count", value = "1") // Limit the number of results to 1 (HTTP query parameter)
    @Tool("Finds the latitude and longitude of a given city")
    GeoResults findCity(@RestQuery String name);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>3 . Another <a href="https://github.com/mariofusco/quarkus-agentic-ai/blob/main/src/main/java/org/agenticai/aiastool/weather/WeatherForecastService.java">web service</a> providing the weather forecast for the given latitude and longitude.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RegisterRestClient(configKey = "openmeteo")
@Path("/v1")
public interface WeatherForecastService {

    @GET
    @Path("/forecast")
    @ClientQueryParam(name = "forecast_days", value = "7")
    @ClientQueryParam(name = "daily", value = {
            "temperature_2m_max",
            "temperature_2m_min",
            "precipitation_sum",
            "wind_speed_10m_max",
            "weather_code"
    })
    @Tool("Forecasts the weather for the given latitude and longitude")
    WeatherForecast forecast(@RestQuery double latitude, @RestQuery double longitude);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s possible to invoke the <a href="https://github.com/mariofusco/quarkus-agentic-ai/blob/main/src/main/java/org/agenticai/aiastool/WeatherResource.java">HTTP endpoint</a> exposing this agent-based weather service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">curl http://localhost:8080/weather/city/Rome</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response will be something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>The weather in Rome today will have a maximum temperature of 14.3°C, minimum temperature of 2.0°C.
No precipitation expected, and the wind speed will be up to 5.6 km/h.
The overall weather condition is expected to be cloudy.</pre>
</div>
</div>
<div class="paragraph">
<p>In essence, this control flow is quite similar to the prompt chaining workflow (introduced in the <a href="https://quarkus.io/blog/agentic-ai-with-quarkus/#prompt-chaining">previous post</a>), where the user input is sequentially transformed in steps (in this case, going from the prompt to the name of the city contained in that prompt to the geographical coordinates of that city, to the weather forecasts at those coordinates).
The significant difference is that the LLM directly orchestrates the sequence of steps instead of being externally orchestrated programmatically.</p>
</div>
<div class="paragraph">
<p>The observability automatically provided by Quarkus (in the GitHub project, observability is disabled by default, but it can be turned on with the <code>-Dobservability</code> flag) allows one to visually trace the sequence of tasks accomplished by the agent in order to execute its task.</p>
</div>
<div class="imageblock text-center text-center">
<div class="content">
<img src="/assets/images/posts/agentic/weather-trace.png" alt="Tracing sequential execution of the prompt chaining pattern">
</div>
<div class="title">Figure 3. Tracing weather agent execution</div>
</div>
</div>
<div class="sect2">
<h3 id="a-more-general-purpose-ai-agent"><a class="anchor" href="#a-more-general-purpose-ai-agent"></a>A more general-purpose AI agent</h3>
<div class="paragraph">
<p>In the previous example, the agent has access to very specific tools.
It&#8217;s possible to provide more general tools that help the agent perform a wider range of tasks.
Typically, a web search tool can be handy for information retrieval tasks.
That&#8217;s the purpose of <a href="https://github.com/mariofusco/quarkus-agentic-ai/blob/main/src/main/java/org/agenticai/searchastool">this second example</a>.
It extends the agent&#8217;s capabilities by allowing the LLM to search online for information not part of its original training set.</p>
</div>
<div class="paragraph">
<p>In general, these scenarios require a bigger model, so this example has been configured to use <code>qwen2.5-14b</code> and a longer timeout to give it a chance to complete its task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.langchain4j.ollama.big-model.chat-model.model-id=qwen2.5:14b
quarkus.langchain4j.ollama.big-model.chat-model.temperature=0
quarkus.langchain4j.ollama.big-model.timeout=600s</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/mariofusco/quarkus-agentic-ai/blob/main/src/main/java/org/agenticai/searchastool/IntelligentAgent.java">intelligent agent</a> of this example can be configured to use this bigger model passing its name to the <code>@RegisterAiService</code> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RegisterAiService(modelName = "big-model")
public interface IntelligentAgent {

    @SystemMessage("""
        You are a chatbot, and you need to answer questions asked by the user.
        Perform a web search for information that you don't know and use the result to answer to the initial user's question.
    """)
    @ToolBox({WebSearchService.class}) // &lt;-- the web search tool
    String chat(String question);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/mariofusco/quarkus-agentic-ai/blob/main/src/main/java/org/agenticai/searchastool/WebSearchService.java">tool</a> can perform a web search on <em>DuckDuckGo</em> and returns the result in plain text:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class WebSearchService {

    @Tool("Perform a web search to retrieve information online")
    String webSearch(String q) throws IOException {
        String webUrl = "https://html.duckduckgo.com/html/?q=" + q;
        return Jsoup.connect(webUrl).get().text();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is possible to use more advanced search engines or APIs, like <a href="https://docs.quarkiverse.io/quarkus-langchain4j/dev/web-search.html">Tavily</a>.</p>
</div>
<div class="paragraph">
<p>The AI service uses this tool to retrieve online information for everything it ignores and arrange that data together to provide an answer to a generic user question.</p>
</div>
<div class="paragraph">
<p>For instance, consider the following question: <em>How many seconds would it take for a leopard at full speed to run through the Pont des Arts?</em>
Using this <a href="https://github.com/mariofusco/quarkus-agentic-ai/blob/main/src/main/java/org/agenticai/searchastool/AgenticChatbotResource.java">HTTP endpoint</a>, it would be executed using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">curl http://localhost:8080/ask/how%20many%20seconds%20would%20it%20take%20for%20a%20leopard%20at%20full%20speed%20to%20run%20through%20Pont%20des%20Arts</code></pre>
</div>
</div>
<div class="paragraph">
<p>To reply to this question, the agent invokes the web search tool twice: once to find the length of Pont des Arts and once to retrieve a leopard&#8217;s speed.</p>
</div>
<div class="imageblock text-center text-center">
<div class="content">
<img src="/assets/images/posts/agentic/ai-agent.png" alt="An agent using an external web search tool" width="80%">
</div>
<div class="title">Figure 4. An agent using an external web search tool</div>
</div>
<div class="paragraph">
<p>Then, the agent puts this information together and generates an output like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>The length of Pont des Arts is approximately 155 meters. A leopard can run at speeds up to about 58 kilometers per hour (36 miles per hour). To calculate how many seconds it would take for a leopard running at full speed to cross the bridge, we need to convert its speed into meters per second and then divide the length of the bridge by this speed.

1 kilometer = 1000 meters
58 kilometers/hour = 58 * 1000 / 3600 ≈ 16.11 meters/second

Now, we can calculate the time it would take for a leopard to run through Pont des Arts:

Time (seconds) = Distance (meters) / Speed (m/s)
= 155 / 16.11
≈ 9.62 seconds

So, it would take approximately 9.62 seconds for a leopard running at full speed to run through Pont des Arts.</pre>
</div>
</div>
<div class="paragraph">
<p>This example illustrates how an agent can use <em>tools</em> to retrieve data.
While we use a search engine here, you can easily implement a tool that queries a database or another service to retrieve the needed information.
You can check <a href="https://github.com/quarkusio/quarkus-workshop-langchain4j/blob/main/step-08/src/main/java/dev/langchain4j/quarkus/workshop/BookingRepository.java">this example</a> to see how to implement a tool that queries a database using a Quarkus Panache repository.</p>
</div>
</div>
<div class="sect2">
<h3 id="agents-and-conversational-ai"><a class="anchor" href="#agents-and-conversational-ai"></a>Agents and Conversational AI</h3>
<div class="paragraph">
<p>The flexibility of AI agents can become even more relevant when used in services that are not intended to fulfill a single request but need to have a more extended conversation with the user to achieve their goal.
For instance, agents can function as chatbots, enabling them to handle multiple users in parallel, each with independent conversations.
It requires managing the state of each conversation, often referred to as memories (the set of messages already exchanged with the LLM).</p>
</div>
<div class="paragraph">
<p>A <a href="https://github.com/mariofusco/quarkus-agentic-ai/blob/main/src/main/java/org/agenticai/restaurant/RestaurantAgent.java">chatbot of a restaurant booking system</a>, designed to chat with customers and collect their data and requirements, represents an interesting practical application of this pattern.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RegisterAiService(modelName = "tool-use")
@SystemMessage("""
        You are an AI dealing with the booking for a restaurant.
        Do not invent the customer name or party size, but explicitly ask for them if not provided.
        If the user specifies a preference (indoor/outdoor), you should book the table with the preference. However, please check the weather forecast before booking the table.
        """)
@SessionScoped
public interface RestaurantAgent {

    @UserMessage("""
            You receive request from customer and need to book their table in the restaurant.
            Please be polite and try to handle the user request.

            Before booking the table, makes sure to have valid date for the reservation, and that the user explicitly provided his name and party size.
            If the booking is successful just notify the user.

            Today is: {current_date}.
            Request: {request}
            """)
    @ToolBox({BookingService.class, WeatherService.class})
    String handleRequest(String request);
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that the user message conveys not only the customer&#8217;s request but also includes the current date.
This allows the LLM to understand relative dates, such as "tomorrow" or "in three days," which are often used by humans.
Initially, we included the current date in the system message, but doing so often caused the LLM to forget it and hallucinate using a different date.
Moving it to the user message empirically proved to work much better, possibly because this way, it is passed not only once but in every message in the chat memory.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the agent completes that information-gathering process, the chatbot uses a <a href="https://github.com/mariofusco/quarkus-agentic-ai/blob/main/src/main/java/org/agenticai/restaurant/booking/BookingService.java">tool accessing the database</a> of existing reservations to both check if there is still a table available for the customer&#8217;s needs and to book that table if so.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class BookingService {

    private final int capacity;

    public BookingService(@ConfigProperty(name = "restaurant.capacity") int capacity) {
        this.capacity = capacity;
    }

    public boolean hasCapacity(LocalDate date, int partySize) {
        int sum = Booking.find("date", date).list().stream().map(b -&gt; (Booking) b)
                         .mapToInt(b -&gt; b.partySize)
                         .sum();
        return sum + partySize &lt;= capacity;
    }

    @Transactional
    @Tool("Books a table for a given name, date (passed as day of the month, month and year), party size and preference (indoor/outdoor). If the restaurant is full, an exception is thrown. If preference is not specified, `UNSET` is used.")
    public String book(String name, int day, int month, int year, int partySize, Booking.Preference preference) {
        var date = LocalDate.of(year, month, day);
        if (hasCapacity(date, partySize)) {
            Booking booking = new Booking();
            booking.date = date;
            booking.name = name;
            booking.partySize = partySize;
            if (preference == null) {
                preference = Booking.Preference.UNSET;
            }
            booking.preference = preference;
            booking.persist();
            String result = String.format("%s successfully booked a %s table for %d persons on %s", name, preference, partySize, date);
            Log.info(result);
            return result;
        }
        return "The restaurant is full for that day";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To assist the customer in deciding whether to eat outside, the agent can also reuse, as a second tool, the <a href="https://github.com/mariofusco/quarkus-agentic-ai/blob/main/src/main/java/org/agenticai/restaurant/weather/WeatherService.java">weather forecast service</a> implemented in one of the former examples, passing to it the geographic coordinates of the restaurant.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">restaurant.location.latitude=45
restaurant.location.longitude=5</code></pre>
</div>
</div>
<div class="paragraph">
<p>The final architectural design of the chatbot is the following:</p>
</div>
<div class="imageblock text-center text-center">
<div class="content">
<img src="/assets/images/posts/agentic/restaurant-agent.png" alt="The restaurant chatbot agent" width="80%">
</div>
<div class="title">Figure 5. The restaurant chatbot agent</div>
</div>
<div class="paragraph">
<p>Once the customer provides all necessary details, the chatbot confirms the booking and presents a reservation summary.
The final booking is then stored in the database.
It is possible to give this a try by accessing the URL:</p>
</div>
<div class="paragraph">
<p><a href="http://localhost:8080/restaurant.html" class="bare">http://localhost:8080/restaurant.html</a></p>
</div>
<div class="paragraph">
<p>A typical example of user interaction could be something like this:</p>
</div>
<div class="imageblock text-center text-center">
<div class="content">
<img src="/assets/images/posts/agentic/restaurant.png" alt="An example of interaction with the restaurant chatbot agent" width="80%">
</div>
<div class="title">Figure 6. An example of interaction with the restaurant chatbot agent</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusions-and-next-steps"><a class="anchor" href="#conclusions-and-next-steps"></a>Conclusions and next steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This blog post series illustrates how you can use agentic patterns to implement AI-infused applications with Quarkus and its LangChain4j extension.</p>
</div>
<div class="paragraph">
<p>We have covered <em>workflow patterns in a previous post</em> and <em>agents in this post</em>.
Both sets of patterns are based on the same underlying principles but differ in how the control flow is managed.
The workflow patterns are more suitable for tasks that can be easily defined programmatically, while agents are more flexible and can handle a broader range of tasks.</p>
</div>
<div class="paragraph">
<p>Nevertheless, the examples discussed in this series can be improved and further generalized with other techniques that will be introduced in future works, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Memory management across LLM calls</p>
</li>
<li>
<p>State management for long-running processes</p>
</li>
<li>
<p>Improved observability</p>
</li>
<li>
<p>Dynamic tools and tool discovery</p>
</li>
<li>
<p>The relation with the MCP protocol and how agentic architecture can be implemented with MCP clients and servers</p>
</li>
<li>
<p>How can the RAG pattern be revisited in light of the agentic architecture, both with workflow patterns and agents?</p>
</li>
</ul>
</div>
</div>
</div>
              
          </div>
          <div class="width-12-12"><div class="share-page">
  <a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://quarkus.io/blog/agentic-ai-with-quarkus-p2/&title=Agentic AI with Quarkus - part 2" rel="nofollow" target="_blank" title="Share on LinkedIn">
    <i class="fa-brands fa-linkedin fa-xl"></i>
  </a>
  <a class="share-x" href="https://x.com/intent/tweet?text=Agentic AI with Quarkus - part 2&url=https://quarkus.io/blog/agentic-ai-with-quarkus-p2/&via=quarkusio&related=quarkusio" rel="nofollow" target="_blank" title="Share on X">
    <i class="fa-brands fa-square-x-twitter fa-xl"></i>
  </a>
  <a class="share-facebook" href="https://facebook.com/sharer.php?u=https://quarkus.io/blog/agentic-ai-with-quarkus-p2/" rel="nofollow" target="_blank" title="Share on Facebook">
    <i class="fa-brands fa-square-facebook fa-xl"></i>
  </a>
  <a class="share-reddit" href="http://www.reddit.com/submit?url=https://quarkus.io/blog/agentic-ai-with-quarkus-p2/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" >
    <i class="fa-brands fa-square-reddit fa-xl"></i>
  </a>
  <a class="share-email" href="mailto:?subject=Agentic AI with Quarkus - part 2&amp;body=Agentic AI with Quarkus - part 2 https://quarkus.io/blog/agentic-ai-with-quarkus-p2/" title="Share via Email" >
    <i class="fa-solid fa-envelope fa-xl"></i>
  </a>
</div>
</div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="post-page grid-wrapper">
  <div class="width-8-12 width-12-12-m doc-content">
  <script src="https://giscus.app/client.js"
        data-repo="quarkusio/quarkus"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxMzk5MTQ5MzI="
        data-category="Quarkus Blog/Website"
        data-category-id="DIC_kwDOCFbutM4CAFFV"
        data-mapping="og:title"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
  </script>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license.<br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>GitHub Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links">
          
          
            <li><a href="/" target="_blank">Home</a></li>
          
          
          
            <li><a href="/about" target="_blank">About</a></li>
          
          
          
            <li><a href="/blog" target="_blank">Blog</a></li>
          
          
          
            <li><a href="/insights" target="_blank">Podcast</a></li>
          
          
          
            <li><a href="/events" target="_blank">Events</a></li>
          
          
          
            <li><a href="/newsletter" target="_blank">Newsletter</a></li>
          
          
          
            <li><a href="/userstories" target="_blank">User Stories</a></li>
          
          
          
            <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" target="_blank">Roadmap</a></li>
          
          
          
            <li><a href="/security" target="_blank">Security&nbsp;policy</a></li>
          
          
          
            <li><a href="/usage" target="_blank">Usage</a></li>
          
          
          
            <li><a href="/brand" target="_blank">Brand</a></li>
          
          
          
            <li><a href="/desktopwallpapers" target="_blank">Wallpapers</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Follow Us</span>
        <ul class="footer-links">
          
          
            <li><a href="https://x.com/quarkusio" target="_blank">X</a></li>
          
          
          
            <li><a href="https://bsky.app/profile/quarkus.io" target="_blank">Bluesky</a></li>
          
          
          
            <li><a rel="me" href="https://fosstodon.org/@quarkusio" target="_blank">Mastodon</a></li>
            
          
          
            <li><a href="https://www.facebook.com/quarkusio" target="_blank">Facebook</a></li>
          
          
          
            <li><a href="https://www.linkedin.com/company/quarkusio/" target="_blank">Linkedin</a></li>
          
          
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg" target="_blank">Youtube</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio" target="_blank">GitHub</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links">
          
          
            <li><a href="/support" target="_blank">Support</a></li>
          
          
          
            <li><a href="/guides" target="_blank">Guides</a></li>
          
          
          
            <li><a href="/faq" target="_blank">FAQ</a></li>
          
          
          
            <li><a href="/get-started" target="_blank">Get Started</a></li>
          
          
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus" target="_blank">Stack Overflow</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions" target="_blank">Discussions</a></li>
          
          
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev" target="_blank">Development mailing list</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Languages</span>
        <ul class="footer-links">
          
          
            <li><a href="https://quarkus.io/" target="_blank">English</a></li>
          
          
          
            <li><a href="https://pt.quarkus.io/" target="_blank">Português&nbsp;(Brasileiro)</a></li>
          
          
          
            <li><a href="https://es.quarkus.io/" target="_blank">Español</a></li>
          
          
          
            <li><a href="https://cn.quarkus.io/" target="_blank">简体中文</a></li>
          
          
          
            <li><a href="https://ja.quarkus.io/" target="_blank">日本語</a></li>
          
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a blah href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a blah href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a blah href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a blah href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a blah href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a blah href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a blah href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a blah href="https://code.quarkus.io/" target="_blank">And many more...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
  <script src="/assets/javascript/future-date.js" type="text/javascript"></script>
</body>

</html>
