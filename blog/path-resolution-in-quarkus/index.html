<!DOCTYPE html>
<html lang="en">







<head>
  <title>Path resolution in Quarkus - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://route-default-test-mscherer-matamo.apps.ospo-osci.z3b1.p1.openshiftapps.com/ https://search.quarkus.io https://smetrics.redhat.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      js.bizographics.com
      https://www.redhat.com
      https://static.redhat.com
      https://app.requestly.io/
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://giscus.app
      https://route-default-test-mscherer-matamo.apps.ospo-osci.z3b1.p1.openshiftapps.com/
      https://app.mailjet.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net https://www.youtube.com https://embed.restream.io https://app.mailjet.com http://xy0p2.mjt.lu https://mj.quarkus.io https://giscus.app; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/blog/path-resolution-in-quarkus/" />
  <meta property="og:title" content="Path resolution in Quarkus" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/blog/path-resolution-in-quarkus/">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="en" href="https://quarkus.io/blog/path-resolution-in-quarkus/" />
  
  <link rel="alternate" hreflang="pt-br" href="https://pt.quarkus.io/blog/path-resolution-in-quarkus/" />
  
  <link rel="alternate" hreflang="es" href="https://es.quarkus.io/blog/path-resolution-in-quarkus/" />
  
  <link rel="alternate" hreflang="zh" href="https://cn.quarkus.io/blog/path-resolution-in-quarkus/" />
  
  <link rel="alternate" hreflang="ja" href="https://ja.quarkus.io/blog/path-resolution-in-quarkus/" />
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />  
  <script src="/assets/javascript/tracking.js"></script>
  
  <script src="/assets/javascript/colormode.js" type="text/javascript"></script>

</head>

<body class="post">

  
  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
        <div class="logo-wrapper">
           <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/about/">Why<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">WHAT IS QUARKUS?</a></li>
          <li><a href="/container-first" class="">CONTAINER FIRST</a></li>
          <li><a href="/continuum" class="">VERSATILITY</a></li>
          <li><a href="/developer-joy" class="">DEVELOPER JOY</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">STANDARDS</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/learn/">Learn<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">GET STARTED</a></li>
          <li><a href="/guides" class="">DOCUMENTATION</a></li>
          <li><a href="/qtips" class="">"Q" TIP VIDEOS</a></li>          
          <li><a href="/books" class="">BOOKS</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="https://quarkus.io/extensions/">Extensions<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <!-- Note that quarkus.io is hardcoded here, because it is the only url which supports extensions -->
          <li><a href="https://quarkus.io/extensions/" class="">BROWSE EXTENSIONS</a></li>
          <li><a href="/faq/#what-is-a-quarkus-extension" class="">USE EXTENSIONS</a></li>
          <li><a href="/guides/writing-extensions" class="">CREATE EXTENSIONS</a></li>
          <li><a href="https://hub.quarkiverse.io" class="">SHARE EXTENSIONS</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/community/">Community<i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">SUPPORT</a></li>
          <li><a href="/blog" class="active">BLOG</a></li>
          <li><a href="/discussion" class="">DISCUSSION</a></li>
          <li><a href="/working-groups" class="">WORKING GROUPS</a></li>
          <li><a href="/insights" class="">PODCAST</a></li>
          <li><a href="/events" class="">EVENTS</a></li>
          <li><a href="/newsletter" class="">NEWSLETTER</a></li>
          <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" class="">ROADMAP</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary white">START CODING</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/blog/path-resolution-in-quarkus/" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://pt.quarkus.io/blog/path-resolution-in-quarkus/">PORTUGUÊS (BR)</a></li>
          <li><a href="https://es.quarkus.io/blog/path-resolution-in-quarkus/">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/blog/path-resolution-in-quarkus/">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/blog/path-resolution-in-quarkus/">日本語</a></li>
          </ul>
      </li>
      <li>
        <span href="#" class="modeswitcher" id='theme-toggle'><i class="fas fa-sun"></i><i class="fas fa-moon"></i><i class="fas fa-cog"></i></span>
      </li>
    </ul>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    <div class="full-width-breadcrumb-bg align-self">
  <div class="width-12-12">
      <p class="returnlink"><a href="/blog">Blog</a> <i class="fas fa-chevron-right"></i> Path resolution in Quarkus</p>
  </div>
</div>

<div class="post-page grid-wrapper">
  <div class="width-8-12 width-12-12-m doc-content">
    <div class="grid-wrapper">
      <div class="width-12-12">
        <div class="post-date">
          March 04, 2021 
          
            <span class="tags"><a href="/blog/tag/web">#web</a><a href="/blog/tag/metrics">#metrics</a></span>
          
        </div>
        <h1 class="post-title">Path resolution in Quarkus</h1>
        <div class="grid-wrapper">
          <div class="width-8-12 width-12-12-m byline-wrapper">
            
            
              <img class="headshot" src="https://www.gravatar.com/avatar/de8863aca81addec74f0452f611c7864">
            
            <p class="byline">By <a href="/author/ebullient">Erin Schnabel</a></p>
          </div>
          <div class="width-12-12">
              <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>We have had an unusually bumpy ride the last few weeks. Path resolution can be sneakily complicated, and in trying to make things better, we accidentally made them worse! We&#8217;ve fixed it all now, but you might notice some changes. Hopefully, this post will make clear what those changes are, what they mean, and what you can do to put everything back the way you want it.</p>
</div>
<div class="paragraph">
<p><strong>TL;DR:</strong> As of <code>1.11.5.Final</code> and <code>1.12.1.Final</code>, leading slashes matter in config. So if you use <code>/endpoint</code>, that endpoint will be served from the absolute root. If you want it relative to some containing bucket, omit that leading slash. For example, <code>quarkus.http.non-application-root-path</code> is now <code>q</code> by default, which nests it under <code>quarkus.http.root-path</code>, matching the original behavior. You can use an absolute path, e.g. <code>/q</code>, to serve non-application endpoints from the absolute root (as a sibling of the http root, if that is set). To remove the non-application endpoint behavior entirely, set <code>quarkus.http.non-application-root-path</code> to the same value as <code>quarkus.http.root-path</code>. The most foolproof way to do this is using a variable: <code>quarkus.http.non-application-root-path=${quarkus.http.root-path}</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-long-story"><a class="anchor" href="#the-long-story"></a>The long story</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once upon a time, Quarkus defined additional endpoints for things like health checks and metrics. They were served from the <code>quarkus.http.root-path</code> alongside any endpoints the application defined. This isn&#8217;t always obvious, as <code>quarkus.http.root-path</code> is <code>/</code> by default, making it effectively invisible.</p>
</div>
<div class="paragraph">
<p>As these proliferated, we started worrying about <a href="https://groups.google.com/g/quarkus-dev/c/FMnmlDIcGRY">polluting the application endpoint namespace</a>, and thinking about how we could group these non-application endpoints together to avoid colliding with application endpoints and make it easier to deal with security and access policies. Some users further asked if we could serve these non-application endpoints from <a href="https://github.com/quarkusio/quarkus/issues/13602">another port entirely</a> (we haven&#8217;t gotten there yet).</p>
</div>
<div class="paragraph">
<p>The first step was to group all of these extension-defined endpoints together. This was the genesis of the <a href="https://github.com/quarkusio/quarkus/pull/13601">non-application endpoint path</a>. The default location of this new path was <code>/q</code>, and it was nested under the HTTP root path, just as the other endpoints had been. The effect was to move <code>/health</code> to <code>/q/health</code>, as an example.</p>
</div>
<div class="paragraph">
<p>We knew that moving some of these endpoints, like metrics and health, would be problematic for already deployed applications and human muscle memory. To ease the transition, we added redirects for some of these endpoints, so that if you visited <code>/metrics</code> you would be redirected to <code>/q/metrics</code>.</p>
</div>
<div class="paragraph">
<p>Non-application endpoint support shipped in <code>1.11.0.Final</code>.</p>
</div>
<div class="paragraph">
<p>And then things started to <a href="https://github.com/quarkusio/quarkus/pull/14179">go</a> <a href="https://github.com/quarkusio/quarkus/issues/15030">sideways</a>. Some cloud hosting providers only accept <code>200</code> as a definition of health, for example, so the redirect (a <code>301</code>) didn&#8217;t have the intended effect. There was also some confusion about how to turn the non-application endpoint off to return to previous behavior, and further questions about how to move specific endpoints out of this non-application endpoint collection.</p>
</div>
<div class="paragraph">
<p>As an aside, how we got into this situation is not helped by differences in how libraries behave. Vert.x always wants segments beginning with leading slashes when creating routes, for example, while JAX-RS effectively ignores leading slashes in <code>@Path</code> annotations. Anyone used to Vert.x always adds leading slashes, and anyone using JAX-RS just does whatever and it magically works.</p>
</div>
<div class="paragraph">
<p>In Quarkus, an implementation detail was exposed by accident: non-application endpoints defined by extensions are based on Vert.x routes. Default path configuration values started with slashes to enable quick route creation and allow simple append behavior. There wasn&#8217;t anything in the early days of Quarkus to suggest this was a bad idea, and developers with experience in JAX-RS didn&#8217;t have any warnings one way or the other, because JAX-RS handles it.</p>
</div>
<div class="paragraph">
<p>Now, however, we were in the situation where paths weren&#8217;t being resolved as people expected, and the configuration changes required to resolve that situation either weren&#8217;t intuitive or lead to other problems. We ended up putting all of the possible configuration permutations into a spreadsheet so we could see side by side what happened when you combined different configuration values. The results were not awesome. However, the exercise allowed us to step back and look at the big picture to evaluate what needed to change to allow application and non-application endpoints to behave as you need them to.</p>
</div>
<div class="paragraph">
<p>While the set of configuration attributes used to configure paths in Quarkus remains unchanged, how configured values are interpreted is different:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Endpoint path configuration defaults are now relative values.</strong> <code>/q</code> is now <code>q</code>, <code>/metrics</code> is now <code>metrics</code>, etc. This means that, out of the box, these endpoints will resolve relative to the containing root, which is what JAX-RS does per spec, and is what we believe most users intuitively expect.</p>
</li>
<li>
<p><strong>Leading slashes in explicitly configured values matter.</strong> We know some of you want to move endpoints to specific places, and the most consistent way to express that intent is to allow you to specify the exact uri you want an endpoint to use. If you specify <code>/metrics</code>, that is where you will find the metrics endpoint.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These updates have been made available and the dust should all have settled with <code>1.11.5.Final</code> and <code>1.12.1.Final</code>.</p>
</div>
<div class="paragraph">
<p>Note that convenience redirects for non-application endpoints are still present, but they can be disabled by setting <code>quarkus.http.redirect-to-non-application-root-path</code> to <code>false</code>. That hasn&#8217;t changed at all.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="resolution-of-configured-paths"><a class="anchor" href="#resolution-of-configured-paths"></a>Resolution of configured paths</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s go through some examples of how paths resolve using our new rules. We&#8217;ll start with the following assumptions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We have a Hello World application that defines <code>@ApplicationPath("/hello")</code></p>
</li>
<li>
<p>The application specifies two endpoints using <code>@Path("world")</code> and <code>@Path("/aliens")</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The configuration attributes we care most about are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.http.root-path</code> - The HTTP root path. All web content is served relative to this root path.</p>
</li>
<li>
<p><code>quarkus.http.non-application-root-path</code> - The non-application endpoint root path.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We&#8217;ll also highlight some configurable non-application endpoints of interest:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.micrometer.export.prometheus.path</code> - The location of the micrometer metrics endpoint.</p>
</li>
<li>
<p><code>quarkus.smallrye-health.root-path</code> - The location of the all-encompassing health endpoint.</p>
</li>
<li>
<p><code>quarkus.smallrye-health.liveness-path</code> - The location of the liveness endpoint.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s look at what happens when we start pulling levers. In the examples below, pay attention to punctuation in config, as that will be the key to why things behave the way they do.</p>
</div>
<div class="sect2">
<h3 id="defaults"><a class="anchor" href="#defaults"></a>Defaults</h3>
<div class="paragraph">
<p>Here are the default configuration values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.http.root-path=/</code></p>
</li>
<li>
<p><code>quarkus.http.non-application-root-path=q</code></p>
</li>
<li>
<p><code>quarkus.micrometer.export.prometheus.path=metrics</code></p>
</li>
<li>
<p><code>quarkus.smallrye-health.root-path=health</code></p>
</li>
<li>
<p><code>quarkus.smallrye-health.liveness-path=liveness</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>That configuration (combined with the declared application endpoints) leads to the following valid URLs if our Quarkus application is running in dev mode:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8080/hello" class="bare">http://localhost:8080/hello</a></p>
</li>
<li>
<p><a href="http://localhost:8080/hello/world" class="bare">http://localhost:8080/hello/world</a></p>
</li>
<li>
<p><a href="http://localhost:8080/hello/aliens" class="bare">http://localhost:8080/hello/aliens</a></p>
</li>
<li>
<p><a href="http://localhost:8080/q/metrics" class="bare">http://localhost:8080/q/metrics</a></p>
</li>
<li>
<p><a href="http://localhost:8080/q/health" class="bare">http://localhost:8080/q/health</a></p>
</li>
<li>
<p><a href="http://localhost:8080/q/health/liveness" class="bare">http://localhost:8080/q/health/liveness</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the <code>quarkus.http.root-path</code> is hiding in this example, because its value is <code>/</code>.</p>
</div>
<div class="paragraph">
<p>There are convenience redirects in this case as <code>quarkus.http.non-application-root-path</code> is not the same as <code>quarkus.http.root-path</code>. In this configuration, <code>/metrics</code> will be redirected to <code>/q/metrics</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="change-the-http-root-path"><a class="anchor" href="#change-the-http-root-path"></a>Change the Http Root path</h3>
<div class="paragraph">
<p>Let&#8217;s change the HTTP root path to <code>/root</code> so the impact it has on resource resolution is visible:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.http.root-path=/root</code></p>
</li>
<li>
<p><code>quarkus.http.non-application-root-path=q</code></p>
</li>
<li>
<p><code>quarkus.micrometer.export.prometheus.path=metrics</code></p>
</li>
<li>
<p><code>quarkus.smallrye-health.root-path=health</code></p>
</li>
<li>
<p><code>quarkus.smallrye-health.liveness-path=liveness</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This results in the following dev mode URLs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8080/root/hello" class="bare">http://localhost:8080/root/hello</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/hello/world" class="bare">http://localhost:8080/root/hello/world</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/hello/aliens" class="bare">http://localhost:8080/root/hello/aliens</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/q/metrics" class="bare">http://localhost:8080/root/q/metrics</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/q/health" class="bare">http://localhost:8080/root/q/health</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/q/health/liveness" class="bare">http://localhost:8080/root/q/health/liveness</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are convenience redirects in this case, too, as <code>quarkus.http.non-application-root-path</code> is not the same as <code>quarkus.http.root-path</code>. In this configuration, <code>/root/metrics</code> will be redirected to <code>/root/q/metrics</code>. This is consistent with previous behavior, where non-application endpoints were implicitly relative to the HTTP root path.</p>
</div>
</div>
<div class="sect2">
<h3 id="move-the-non-application-root-path-q"><a class="anchor" href="#move-the-non-application-root-path-q"></a>Move the non-application root path (/q)</h3>
<div class="paragraph">
<p>Let&#8217;s try something we couldn&#8217;t do before. We&#8217;ll move the non-application endpoint outside of the HTTP root path by specifying an absolute path, <code>/q</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.http.root-path=/root</code></p>
</li>
<li>
<p><code>quarkus.http.non-application-root-path=/q</code></p>
</li>
<li>
<p><code>quarkus.micrometer.export.prometheus.path=metrics</code></p>
</li>
<li>
<p><code>quarkus.smallrye-health.root-path=health</code></p>
</li>
<li>
<p><code>quarkus.smallrye-health.liveness-path=liveness</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This results in the following dev mode URLs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8080/root/hello" class="bare">http://localhost:8080/root/hello</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/hello/world" class="bare">http://localhost:8080/root/hello/world</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/hello/aliens" class="bare">http://localhost:8080/root/hello/aliens</a></p>
</li>
<li>
<p><a href="http://localhost:8080/q/metrics" class="bare">http://localhost:8080/q/metrics</a></p>
</li>
<li>
<p><a href="http://localhost:8080/q/health" class="bare">http://localhost:8080/q/health</a></p>
</li>
<li>
<p><a href="http://localhost:8080/q/health/liveness" class="bare">http://localhost:8080/q/health/liveness</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are still convenience redirects in this case, as <code>quarkus.http.non-application-root-path</code> is not the same as <code>quarkus.http.root-path</code>. Redirected URLs are still relative to HTTP root, so <code>/root/metrics</code> will be redirected to <code>/q/metrics</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="move-individual-non-application-endpoints-metrics-and-liveness"><a class="anchor" href="#move-individual-non-application-endpoints-metrics-and-liveness"></a>Move individual non-application endpoints (/metrics and /liveness)</h3>
<div class="paragraph">
<p>This is is another configuration that was not previously possible. We can individually move configurable non-application endpoints to a specified absolute path, specifically <code>/metrics</code> and <code>/liveness</code> in this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.http.root-path=/root</code></p>
</li>
<li>
<p><code>quarkus.http.non-application-root-path=/q</code></p>
</li>
<li>
<p><code>quarkus.micrometer.export.prometheus.path=/metrics</code></p>
</li>
<li>
<p><code>quarkus.smallrye-health.root-path=health</code></p>
</li>
<li>
<p><code>quarkus.smallrye-health.liveness-path=/liveness</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This results in the following dev mode URLs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8080/root/hello" class="bare">http://localhost:8080/root/hello</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/hello/world" class="bare">http://localhost:8080/root/hello/world</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/hello/aliens" class="bare">http://localhost:8080/root/hello/aliens</a></p>
</li>
<li>
<p><a href="http://localhost:8080/metrics" class="bare">http://localhost:8080/metrics</a></p>
</li>
<li>
<p><a href="http://localhost:8080/q/health" class="bare">http://localhost:8080/q/health</a></p>
</li>
<li>
<p><a href="http://localhost:8080/liveness" class="bare">http://localhost:8080/liveness</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are still convenience redirects in this case, as <code>quarkus.http.non-application-root-path</code> is not the same as <code>quarkus.http.root-path</code>. However, these redirects only apply to non-application endpoints controlled by the non-application endpoint root. We&#8217;ve essentially removed the metrics and liveness endpoints from that root, so they won&#8217;t be redirected. In this configuration, if you request <code>/root/health</code>, it will be redirected to <code>/q/health</code>. A redirect will not be provided for <code>/root/health/liveness</code> or <code>/root/metrics</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="remove-the-non-application-endpoint-root"><a class="anchor" href="#remove-the-non-application-endpoint-root"></a>Remove the non-application endpoint root</h3>
<div class="paragraph">
<p>Some of you have asked how to turn this non-application endpoint root stuff off entirely. A clear expression of your intent is best. To disable the non-application endpoint, make it identical to the HTTP root path. In essence, you are telling the runtime to "serve all non-application endpoints from the HTTP root". This example uses a variable to ensure the values remain the same:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.http.root-path=/root</code></p>
</li>
<li>
<p><code>quarkus.http.non-application-root-path=${quarkus.http.root-path}</code></p>
</li>
<li>
<p><code>quarkus.micrometer.export.prometheus.path=metrics</code></p>
</li>
<li>
<p><code>quarkus.smallrye-health.root-path=health</code></p>
</li>
<li>
<p><code>quarkus.smallrye-health.liveness-path=liveness</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This results in the following dev mode URLs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8080/root/hello" class="bare">http://localhost:8080/root/hello</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/hello/world" class="bare">http://localhost:8080/root/hello/world</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/hello/aliens" class="bare">http://localhost:8080/root/hello/aliens</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/metrics" class="bare">http://localhost:8080/root/metrics</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/health" class="bare">http://localhost:8080/root/health</a></p>
</li>
<li>
<p><a href="http://localhost:8080/root/health/liveness" class="bare">http://localhost:8080/root/health/liveness</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are no convenience redirects in this scenario, as the non-application endpoint behavior has been disabled entirely.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="knock-on-effects"><a class="anchor" href="#knock-on-effects"></a>Knock-on effects</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For the most part, we hope this will be transparent. We discovered some very inconsistent path handling along the way, which lead us to believe that many (or even most) of these values are never customized.</p>
</div>
<div class="paragraph">
<p>You are most likely to see a behavior change if you have customized the HTTP root path. In that case, we hope the new rules and examples above will help you understand how to tweak your configuration to get everything to behave the way you want it to.</p>
</div>
<div class="paragraph">
<p>Extension writers will see the biggest change. The <a href="https://quarkus.io/guides/writing-extensions#extension-defined-endpoints">Writing extensions guide</a> has been updated to describe changes to the build items used to create non-application endpoints. The general rule, however, is to avoid constructing your own endpoint paths, and rely on <code>NonApplicationRootPathBuildItem</code> and <code>HttpRootPathBuildItem</code> to construct them for you.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="parting-thoughts"><a class="anchor" href="#parting-thoughts"></a>Parting thoughts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While we know it is impossible to make everyone happy, we hope we have at least managed to acheive a pattern for configuration that leads to more predictable and consistent results. And we apologize (again), for any behavior changes you may have observed as we sorted this out.</p>
</div>
</div>
</div>
              
          </div>
          <div class="width-12-12"><div class="share-page">
  <a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://quarkus.io/blog/path-resolution-in-quarkus/&title=Path resolution in Quarkus" rel="nofollow" target="_blank" title="Share on LinkedIn">
    <i class="fa-brands fa-linkedin fa-xl"></i>
  </a>
  <a class="share-x" href="https://x.com/intent/tweet?text=Path resolution in Quarkus&url=https://quarkus.io/blog/path-resolution-in-quarkus/&via=quarkusio&related=quarkusio" rel="nofollow" target="_blank" title="Share on X">
    <i class="fa-brands fa-square-x-twitter fa-xl"></i>
  </a>
  <a class="share-facebook" href="https://facebook.com/sharer.php?u=https://quarkus.io/blog/path-resolution-in-quarkus/" rel="nofollow" target="_blank" title="Share on Facebook">
    <i class="fa-brands fa-square-facebook fa-xl"></i>
  </a>
  <a class="share-reddit" href="http://www.reddit.com/submit?url=https://quarkus.io/blog/path-resolution-in-quarkus/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" >
    <i class="fa-brands fa-square-reddit fa-xl"></i>
  </a>
  <a class="share-email" href="mailto:?subject=Path resolution in Quarkus&amp;body=Path resolution in Quarkus https://quarkus.io/blog/path-resolution-in-quarkus/" title="Share via Email" >
    <i class="fa-solid fa-envelope fa-xl"></i>
  </a>
</div>
</div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="post-page grid-wrapper">
  <div class="width-8-12 width-12-12-m doc-content">
  <script src="https://giscus.app/client.js"
        data-repo="quarkusio/quarkus"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxMzk5MTQ5MzI="
        data-category="Quarkus Blog/Website"
        data-category-id="DIC_kwDOCFbutM4CAFFV"
        data-mapping="og:title"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
  </script>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license.<br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>GitHub Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links">
          
          
            <li><a href="/" target="_blank">Home</a></li>
          
          
          
            <li><a href="/about" target="_blank">About</a></li>
          
          
          
            <li><a href="/blog" target="_blank">Blog</a></li>
          
          
          
            <li><a href="/insights" target="_blank">Podcast</a></li>
          
          
          
            <li><a href="/events" target="_blank">Events</a></li>
          
          
          
            <li><a href="/newsletter" target="_blank">Newsletter</a></li>
          
          
          
            <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" target="_blank">Roadmap</a></li>
          
          
          
            <li><a href="/security" target="_blank">Security&nbsp;policy</a></li>
          
          
          
            <li><a href="/usage" target="_blank">Usage</a></li>
          
          
          
            <li><a href="/brand" target="_blank">Brand</a></li>
          
          
          
            <li><a href="/desktopwallpapers" target="_blank">Wallpapers</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Follow Us</span>
        <ul class="footer-links">
          
          
            <li><a href="https://x.com/quarkusio" target="_blank">X</a></li>
          
          
          
            <li><a rel="me" href="https://fosstodon.org/@quarkusio" target="_blank">Mastodon</a></li>
            
          
          
            <li><a href="https://www.facebook.com/quarkusio" target="_blank">Facebook</a></li>
          
          
          
            <li><a href="https://www.linkedin.com/company/quarkusio/" target="_blank">Linkedin</a></li>
          
          
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg" target="_blank">Youtube</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio" target="_blank">GitHub</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links">
          
          
            <li><a href="/support" target="_blank">Support</a></li>
          
          
          
            <li><a href="/guides" target="_blank">Guides</a></li>
          
          
          
            <li><a href="/faq" target="_blank">FAQ</a></li>
          
          
          
            <li><a href="/get-started" target="_blank">Get Started</a></li>
          
          
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus" target="_blank">Stack Overflow</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions" target="_blank">Discussions</a></li>
          
          
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev" target="_blank">Development mailing list</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Languages</span>
        <ul class="footer-links">
          
          
            <li><a href="https://quarkus.io/" target="_blank">English</a></li>
          
          
          
            <li><a href="https://pt.quarkus.io/" target="_blank">Português&nbsp;(Brasileiro)</a></li>
          
          
          
            <li><a href="https://es.quarkus.io/" target="_blank">Español</a></li>
          
          
          
            <li><a href="https://cn.quarkus.io/" target="_blank">简体中文</a></li>
          
          
          
            <li><a href="https://ja.quarkus.io/" target="_blank">日本語</a></li>
          
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a blah href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a blah href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a blah href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a blah href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a blah href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a blah href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a blah href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a blah href="https://code.quarkus.io/" target="_blank">And many more...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
  <script src="/assets/javascript/future-date.js" type="text/javascript"></script>
</body>

</html>
