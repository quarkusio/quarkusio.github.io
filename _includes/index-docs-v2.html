{% assign docversion = include.docversion %}
{% assign docversion_index = docversion | replace: '.', '-' %}

<div id="guides-app">
  <qs-form server="{{ site.search.host }}"
           quarkus-version="{{ docversion }}"
           language="{{ site.language }}"
           initial-timeout="{{ site.search.initial-timeout }}"
           more-timeout="{{ site.search.more-timeout }}"
           min-chars="{{ site.search.min-chars }}"
  >
    <section class="full-width-version-bg flexfilterbar">
      <div class="flexcontainer">
        <div class="flexlabel">
          <label>{{site.data.index-docs.texts.by_version}}</label>
        </div>
        <div class="pulldown version">
          <select id="guidesindex-version-dropdown">
            {% for version in site.data.versions.documentation %}
            <option value="{{ version }}" {% if docversion== version %}selected{% endif %}>{% if version ==
              'latest' %}{{ site.data.versions.quarkus.version | replace_regex: "\.[0-9+]\.Final", "" }} -
              {% endif %}{{ version | capitalize }}{% if version == 'main' %} - SNAPSHOT{% endif %}
            </option>
            {% endfor %}
          </select>
        </div>
        <div class="search">
          <input name="q" type="search" placeholder="{{site.data.index-docs.texts.filter_by_keyword}}" autocomplete="off"/>
        </div>
      </div>
    </section>
  </qs-form>

  <div><h1 class="title">{{ page.title }}</h1></div>

  <qs-target origins-with-relative-urls="quarkus">
    <div class="grid-wrapper guides" id="all-docs">

      <div class="grid__item width-3-12 hide-mobile guide-sidebar-wrapper">
        {% comment %} Sidebar with ALL domains expanded on landing page {% endcomment %}
        <nav class="guide-sidebar guide-sidebar--landing" aria-label="Guide navigation">
          {% for domain in site.data.domains.domains %}
          {% if domain.guides.size > 0 %}
          <details open>
            <summary>{{ domain.title }}</summary>
            <ul>
              {% for entry in domain.guides %}
              <li><a href="#{{ domain.id }}">{{ entry.nav-title | default: entry.title }}</a></li>
              {% endfor %}
            </ul>
          </details>
          {% endif %}
          {% endfor %}
        </nav>
      </div>

      <div class="grid__item width-9-12 width-12-12-m">
        {% for domain in site.data.domains.domains %}
        {% if domain.guides.size > 0 %}
        <section id="{{ domain.id }}" class="domain-section">
          <h2>{{ domain.title }}</h2>
          <p class="domain-job">{{ domain.job }}</p>
          <ul class="domain-guides">
          {% for entry in domain.guides %}
            <li>
              <a href="{% if docversion == 'latest' %}{{ site.baseurl }}{{ entry.url }}{% else %}{{ site.baseurl }}/version/{{ docversion }}{{ entry.url }}{% endif %}">{{ entry.title }}</a>
              {% if entry.type == 'tutorial' %}<span class="type-badge">[T]</span>
              {% elsif entry.type == 'howto' %}<span class="type-badge">[H]</span>
              {% elsif entry.type == 'reference' %}<span class="type-badge">[R]</span>
              {% elsif entry.type == 'concepts' %}<span class="type-badge">[C]</span>
              {% endif %}
            </li>
          {% endfor %}
          </ul>
        </section>
        {% endif %}
        {% endfor %}
      </div>

    </div>
  </qs-target>
</div>
